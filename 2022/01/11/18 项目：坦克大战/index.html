<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>&lt;Java&gt;18 项目（坦克大战） | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="18 项目：坦克大战还有很多细节、优化方法没实现，但困难的已经没有了。 先不打磨了，还是以学习 Java 为主。 二阶段毕业 关于 数量 的注释可能不对。那些注释是早些时候添加的。后来添加了新功能，这些注释没有及时更新 TankGame.java：程序的入口 MyPanel.java：窗口、图像的绘制。这是该项目的主干 Player.java、Enemy.java：己方、敌方的坦克类。Tank.j">
<meta property="og:type" content="article">
<meta property="og:title" content="&lt;Java&gt;18 项目（坦克大战）">
<meta property="og:url" content="http://example.com/2022/01/11/18%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="18 项目：坦克大战还有很多细节、优化方法没实现，但困难的已经没有了。 先不打磨了，还是以学习 Java 为主。 二阶段毕业 关于 数量 的注释可能不对。那些注释是早些时候添加的。后来添加了新功能，这些注释没有及时更新 TankGame.java：程序的入口 MyPanel.java：窗口、图像的绘制。这是该项目的主干 Player.java、Enemy.java：己方、敌方的坦克类。Tank.j">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Bubble.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Bubble_r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Bubble_red.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Bubble_red_r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/E_bullet.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/E_bullet_r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/G_Bullet.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/G_Bullet_r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/N_bullet.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/N_bullet_r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/p.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/pl.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/plr.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Pr.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Star.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Star_n.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_E1.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_E1r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_E2.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_E2r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_E3.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_E3r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Lv1.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Lv1r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Lv2.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Lv2r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Lv3.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Lv3r.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Sp.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Tank_Spr.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Landform/Iron.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Landform/Trees.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Landform/Wall.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Landform/Water.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Explosion/Explosion1.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Explosion/Explosion2.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Explosion/Explosion3.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Explosion/Explosion4.png">
<meta property="og:image" content="http://example.com/img/Java_InputImage/pic/Explosion/Explosion5.png">
<meta property="article:published_time" content="2022-01-10T17:17:02.000Z">
<meta property="article:modified_time" content="2022-05-23T23:51:02.102Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="程序">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/Java_InputImage/pic/Bubble.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-18 项目：坦克大战" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/01/11/18%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98/" class="article-date">
  <time class="dt-published" datetime="2022-01-10T17:17:02.000Z" itemprop="datePublished">2022-01-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      &lt;Java&gt;18 项目（坦克大战）
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="18-项目：坦克大战"><a href="#18-项目：坦克大战" class="headerlink" title="18 项目：坦克大战"></a>18 项目：坦克大战</h1><p>还有很多细节、优化方法没实现，但困难的已经没有了。</p>
<p>先不打磨了，还是以学习 Java 为主。</p>
<h3 id="二阶段毕业"><a href="#二阶段毕业" class="headerlink" title="二阶段毕业"></a>二阶段毕业</h3><blockquote>
<p>关于 数量 的注释可能不对。那些注释是早些时候添加的。后来添加了新功能，这些注释没有及时更新</p>
<p>TankGame.java：程序的入口</p>
<p>MyPanel.java：窗口、图像的绘制。这是该项目的主干</p>
<p>Player.java、Enemy.java：己方、敌方的坦克类。Tank.java 是他们的父类</p>
<p>Vehicle.java：记录了所有坦克预设的枚举类。该包下还有另一个记录了所有子弹类型的枚举类 Bullet</p>
<p>Map.java：记录了地图数据的枚举类，包含不同关卡。但我没设计关卡</p>
<p>InputImage.java：所有导入的图片。是我准备的素材</p>
<p>Timing.java：一个计时器。当时能力有限，用这个作为某个计时功能的代替方案</p>
</blockquote>
<ul>
<li><p><strong>TankGame.java（入口）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0.ష</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 小派蒙会开坦克吗？</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⠴⠒⠛⠲⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀</span></span><br><span class="line"><span class="comment"> * ⠀⠀⠀⠀   ⠀⢻⡄⣠⠶⣆⠀⣸⣀⣀⠀⠀</span></span><br><span class="line"><span class="comment"> * ⠀⠀⠀ ⠀⠀⢀⡠⠬⠛⢓⣏⠉⣾⣉⣀⠉⢹⡀⠀⠀⠀⠀⠀⠀⠀</span></span><br><span class="line"><span class="comment"> * ⠀⠀ ⠀⢀⡖⠋⣠⠴⠛⠙⢹⠞⢳⢀⣨⡵⠚⠀⠀⠀</span></span><br><span class="line"><span class="comment"> * ⠀⠀⠀⣰⠋⡠⠎⠁⣀⠤⠒⠚⠛⠙⠒⠳⠤⣄⡀⠀</span></span><br><span class="line"><span class="comment"> * ⠀⠀⠀⠘⠐⢼⠖⠋⠀⠀⢀⠀⠀⠀⠀⠀⠀⠘⣌⡒⠲⢹⠀⠀⠀⠀</span></span><br><span class="line"><span class="comment"> * ⠀⠀ ⠀⡸⠁⠀⠀⠀⠀⡆⠀⠀⠐⠀⠢⣄⠀⡽⡙⡲⠑⠒⠒⡒⠁</span></span><br><span class="line"><span class="comment"> * ⢀⡠⠴⠚⠀⠀⠀⠀⠀⣕⠝⣄⡀⢀⠀⠀⡇⠵⢍⠚⢾⡀⢠⠖⠁⠀       ___________________</span></span><br><span class="line"><span class="comment"> * ⠈⠦⣄⣀⠀⡔⠀⠀⢁⡞⠀⠉⠲⣄⡀⢲⢼⠀⢀⠳⡄⠁⠀⢣⠀⠀     /  坦克？是新游戏喔。   \</span></span><br><span class="line"><span class="comment"> * ⠀⠀⣠⠃⢐⠄⠀⠀⠴⠅⠠⡊⡢⠀⠉⠉⠁⠀⢆⠕⠹⡀⠀⠈⡆⠀  &lt;   开玩笑，我超勇的好不好   \</span></span><br><span class="line"><span class="comment"> * ⠀⠠⡇⠀⡸⠀⠀⠀⠨⡅⠀⠒⠈⠀⢄⠠⠠⠔⠀⠀⠀⢻⠀⠀⢣⠀     \     我超会玩的啦 ~     /</span></span><br><span class="line"><span class="comment"> * ⠀⢸⠅⠀⡕⠀⠀⠀⠀⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡤⡏⠀⠀⢸⠀       \____________________/</span></span><br><span class="line"><span class="comment"> * ⠀⠈⡇⠀⣣⠀⠀⠈⠀⠸⡦⠴⠲⢚⢚⠙⠝⠙⠍⠝⣱⠏⢠⠀⢸⠅</span></span><br><span class="line"><span class="comment"> * ⠀⠀⠙⣆⠘⣄⠀⠠⣄⠀⠹⣌⠌⠀⠂⠐⢈⠄⡁⢌⠳⣺⠏⢀⡞⠀</span></span><br><span class="line"><span class="comment"> * ⠀⠀⠀⠀⠙⠺⠛⣲⠜⠟⡓⡚⣏⣔⡀⡌⣀⢂⣔⠴⠋⢏⠒⠁⠀⠀</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 什么新游戏，比游戏还刺激！还可以教你 学 Ja va 哦 ~</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TankGame</span> <span class="keyword">extends</span> <span class="title class_">JFrame</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> MyPanel mp;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Thread thread;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">File</span> <span class="variable">savePath</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;d:\\Program\\Melody\\TankGame\\saveData.sav&quot;</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> abandoned;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">width</span> <span class="operator">=</span> <span class="number">1200</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">800</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">enemyNum</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">char</span> <span class="variable">inpChar</span> <span class="operator">=</span> <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        mp = <span class="keyword">new</span> <span class="title class_">MyPanel</span>(width, height, enemyNum);</span><br><span class="line">        <span class="keyword">if</span> (savePath.isFile()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;开始新游戏？（Y新游戏/N读档）&quot;</span>);</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                inpChar = scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (inpChar == <span class="string">&#x27;Y&#x27;</span> || inpChar == <span class="string">&#x27;y&#x27;</span>) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (inpChar == <span class="string">&#x27;N&#x27;</span> || inpChar == <span class="string">&#x27;n&#x27;</span>) &#123;</span><br><span class="line">                        mp.pause = <span class="literal">true</span>;</span><br><span class="line">                        mp.toLoad = <span class="literal">true</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;错误！请重新输入（Y新游戏/N读档）&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">TankGame</span> <span class="variable">game</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TankGame</span>(Math.abs(width), Math.abs(height), Math.abs(enemyNum));</span><br><span class="line">        thread = <span class="keyword">new</span> <span class="title class_">Thread</span>(game.mp);</span><br><span class="line">        thread.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TankGame</span><span class="params">(<span class="type">int</span> width, <span class="type">int</span> height, <span class="type">int</span> enemyNum)</span> &#123;</span><br><span class="line">        width = Math.max(width, <span class="number">800</span>);</span><br><span class="line">        height = Math.max(height, <span class="number">600</span>);</span><br><span class="line">        <span class="built_in">this</span>.add(mp);</span><br><span class="line">        <span class="built_in">this</span>.setSize(width + <span class="number">20</span>, height + <span class="number">240</span>);</span><br><span class="line">        <span class="built_in">this</span>.addKeyListener(mp);</span><br><span class="line">        <span class="built_in">this</span>.setVisible(<span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">this</span>.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>MyPanel.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.KeyEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.KeyListener;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * ！！！！！！！！！！！！！！！该类需要重新整理！！！！！！！！！！！！！！！！</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyPanel</span> <span class="keyword">extends</span> <span class="title class_">JPanel</span> <span class="keyword">implements</span> <span class="title class_">KeyListener</span>, Runnable, Serializable &#123;</span><br><span class="line">    <span class="comment">//5 个静态变量依次是：允许的同屏最大敌人数量的上限、战斗区域宽度、战斗区域高度、玩家、是否通关</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ENEMY_MAX</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">width</span> <span class="operator">=</span> <span class="number">1200</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">height</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Player</span> <span class="variable">player</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Player</span>(<span class="number">640</span>, <span class="number">640</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">gameSuspend</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][][] mapData = <span class="keyword">new</span> <span class="title class_">int</span>[width][height][<span class="number">2</span>];                        <span class="comment">//*****此处需要修改*****</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//12 个成员变量，依次是：所有敌人坦克、所有被摧毁的敌人坦克、同屏最大敌人数量（用户设定）、敌人初始位置集（含坐标、占用情况）、</span></span><br><span class="line">    <span class="comment">//          敌人初始位置集（仅坐标）、关卡敌人总数、W键是否正被按下、A键是否正被按下、S键是否正被按下、D键是否正被按下、开火键是否正被按下、</span></span><br><span class="line">    <span class="comment">//          导入图片媒介、地图集、关卡数</span></span><br><span class="line">    <span class="keyword">private</span> Vector&lt;Tank&gt; enemy = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> Vector&lt;Tank&gt; deadEnemy = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> enemyMax;</span><br><span class="line">    <span class="keyword">private</span> LinkedHashMap&lt;<span class="type">int</span>[], Boolean&gt; enemyPositions = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[][] enemyPosition;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">isPressingW</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">isPressingA</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">isPressingS</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">isPressingD</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">isFiring</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">Image</span> <span class="variable">image</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> Map[] maps = Map.values();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">level</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> Tank boss;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">bossActive</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">pause</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">saved</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">loaded</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">toLoad</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">toSave</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">transient</span> <span class="type">boolean</span> <span class="variable">abandoned</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//构造器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyPanel</span><span class="params">(<span class="type">int</span> width, <span class="type">int</span> height, <span class="type">int</span> enemyNum)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.width = (<span class="type">int</span>) (width / <span class="number">40</span>) * <span class="number">40</span>;</span><br><span class="line">        <span class="built_in">this</span>.height = (<span class="type">int</span>) (height / <span class="number">40</span>) * <span class="number">40</span>;               <span class="comment">//设置长宽</span></span><br><span class="line">        enemyNum = Math.max(enemyNum, <span class="number">0</span>);</span><br><span class="line">        enemyMax = Math.min(enemyNum, ENEMY_MAX);           <span class="comment">//设置同屏最大敌人数量</span></span><br><span class="line">        enemyPosition = <span class="keyword">new</span> <span class="title class_">int</span>[enemyMax][<span class="number">2</span>];                <span class="comment">//已经确定了要生成的敌人位置数量，生成位置数组（空）</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; enemyMax; i++) &#123;                <span class="comment">//生成敌人初始位置。</span></span><br><span class="line">            <span class="type">int</span>[] tempPosition = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">2</span>];</span><br><span class="line">            tempPosition[<span class="number">0</span>] = i * <span class="number">150</span> + <span class="number">50</span>;</span><br><span class="line">            tempPosition[<span class="number">1</span>] = <span class="number">50</span>;</span><br><span class="line">            <span class="keyword">while</span> (tempPosition[<span class="number">0</span>] &gt; (width - <span class="number">100</span>)) &#123;</span><br><span class="line">                tempPosition[<span class="number">1</span>] += <span class="number">120</span>;</span><br><span class="line">                tempPosition[<span class="number">0</span>] -= (width - <span class="number">150</span>);</span><br><span class="line">                <span class="keyword">if</span> (tempPosition[<span class="number">1</span>] &gt; height - <span class="number">100</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            enemyPosition[i][<span class="number">0</span>] = tempPosition[<span class="number">0</span>];</span><br><span class="line">            enemyPosition[i][<span class="number">1</span>] = tempPosition[<span class="number">1</span>];</span><br><span class="line">        &#125;                                                    <span class="comment">//此时 敌人初始位置数组 生成完毕。</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] ints : enemyPosition) &#123;</span><br><span class="line">            enemyPositions.put(ints, <span class="literal">false</span>);                 <span class="comment">//装满 敌人初始位置集 默认全部是未占用</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        nextLevel();</span><br><span class="line">        player.start();             <span class="comment">//启动玩家线程</span></span><br><span class="line">        <span class="keyword">while</span> (!abandoned) &#123;</span><br><span class="line">            creatEnemy();</span><br><span class="line">            gameSuspend = <span class="literal">false</span>;<span class="comment">//创建敌人坦克。这个方法同时会启动敌人坦克线程</span></span><br><span class="line">            <span class="keyword">while</span> (!gameSuspend) &#123;</span><br><span class="line">                repaint();              <span class="comment">//刷新</span></span><br><span class="line">                checkLevelClear();</span><br><span class="line">                <span class="keyword">if</span>(toSave)&#123;</span><br><span class="line">                    saveData();</span><br><span class="line">                    toSave  = <span class="literal">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(toLoad)&#123;</span><br><span class="line">                    loadData();</span><br><span class="line">                    toLoad  = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            pauseBetweenLevels(<span class="number">1200</span> + (bossActive ? <span class="number">2000</span> : <span class="number">0</span>));</span><br><span class="line">            <span class="keyword">while</span> (!gameSuspend) &#123;</span><br><span class="line">                repaint();</span><br><span class="line">            &#125;</span><br><span class="line">            nextLevel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paint</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        drawUI(g);                      <span class="comment">//画出 UI</span></span><br><span class="line">        drawPlayer(g);                  <span class="comment">//画出 玩家坦克（包含子弹）</span></span><br><span class="line">        drawEnemy(g);                   <span class="comment">//画出 所有敌人坦克（包含子弹）</span></span><br><span class="line">        drawDeadTank(g);                <span class="comment">//画出 被破坏坦克的残留动画和残留子弹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出 UI</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawUI</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        g.setColor(Color.BLACK);</span><br><span class="line">        g.fillRect(<span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">        g.setColor(Color.GRAY);</span><br><span class="line">        g.fillRect(<span class="number">2</span>, <span class="number">2</span>, width - <span class="number">4</span>, height - <span class="number">4</span>);        <span class="comment">//以上 4 行，画出了战斗场地</span></span><br><span class="line">        g.setColor(Color.WHITE);</span><br><span class="line">        g.fillRect(<span class="number">0</span>, height, width, <span class="number">200</span>);</span><br><span class="line">        drawHp(g);                                                      <span class="comment">//画 HP 槽</span></span><br><span class="line">        drawFireCD(g);                                                  <span class="comment">//画 开火 槽</span></span><br><span class="line">        drawEnemyNum(g);                                                <span class="comment">//画 雷达 槽</span></span><br><span class="line">        drawStars(g);                                                   <span class="comment">//画 经验值 星星</span></span><br><span class="line">        <span class="keyword">if</span> (pause) &#123;</span><br><span class="line">            drawPause(g);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画 HP 槽</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawHp</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        <span class="comment">//下面画出 绿色 HP 槽。随着 HP 减少，槽会变空</span></span><br><span class="line">        g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;等线&quot;</span>, Font.ITALIC + Font.BOLD, <span class="number">50</span>));</span><br><span class="line">        g.setColor(Color.BLACK);</span><br><span class="line">        g.fillRect(<span class="number">50</span>, height + <span class="number">60</span>, (<span class="type">int</span>) (<span class="number">20</span> * player.vehicle.LIFE) + <span class="number">4</span>, <span class="number">30</span>);</span><br><span class="line">        g.setColor(player.lifeRemains / player.vehicle.LIFE &gt; <span class="number">0.2</span> ? Color.GREEN : Color.RED);</span><br><span class="line">        g.fill3DRect(<span class="number">52</span>, height + <span class="number">62</span>, (<span class="type">int</span>) (<span class="number">20</span> * Math.max(player.lifeRemains, <span class="number">0</span>)), <span class="number">26</span>, <span class="literal">true</span>);</span><br><span class="line">        g.fill3DRect(<span class="number">52</span>, height + <span class="number">80</span>, (<span class="type">int</span>) (<span class="number">20</span> * Math.max(player.lifeRemains, <span class="number">0</span>) - <span class="number">1</span>), <span class="number">6</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//下面画出一段说明文</span></span><br><span class="line">        g.setColor(Color.GRAY);</span><br><span class="line">        <span class="keyword">if</span> (player.vehicle == Vehicle.Basic) &#123;</span><br><span class="line">            g.drawString(<span class="string">&quot;防弹衣&quot;</span>, <span class="number">50</span>, height + <span class="number">140</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            g.drawString(player.vehicle == Vehicle.Tank_Special ? <span class="string">&quot;复合装甲&quot;</span> : <span class="string">&quot;装甲&quot;</span>, <span class="number">50</span>, height + <span class="number">140</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画 开火 槽</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawFireCD</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        <span class="comment">//以下画出 橙色 开火槽。随着装弹，槽会填满</span></span><br><span class="line">        g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;等线&quot;</span>, Font.ITALIC + Font.BOLD, <span class="number">50</span>));</span><br><span class="line">        g.setColor(Color.BLACK);</span><br><span class="line">        g.fillRect((<span class="type">int</span>) ((width / <span class="number">2</span>) + <span class="number">60</span>), height + <span class="number">60</span>, <span class="number">205</span>, <span class="number">30</span>);</span><br><span class="line">        g.setColor(player.vehicle == Vehicle.Tank_Special ? Color.cyan : Color.ORANGE);</span><br><span class="line">        g.fill3DRect((<span class="type">int</span>) ((width / <span class="number">2</span>) + <span class="number">62</span>), height + <span class="number">62</span>,</span><br><span class="line">                (<span class="type">int</span>) (player.getAtkSpeed() * (player.fireCD - Math.max(player.fireCount, <span class="number">0</span>)) + <span class="number">1</span>), <span class="number">26</span>, <span class="literal">true</span>);</span><br><span class="line">        g.fill3DRect((<span class="type">int</span>) ((width / <span class="number">2</span>) + <span class="number">62</span>), height + <span class="number">80</span>,</span><br><span class="line">                (<span class="type">int</span>) (player.getAtkSpeed() * (player.fireCD - Math.max(player.fireCount, <span class="number">0</span>))), <span class="number">6</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//以下画出一段说明文字</span></span><br><span class="line">        g.setColor(Color.GRAY);</span><br><span class="line">        <span class="keyword">if</span> (player.vehicle == Vehicle.Basic) &#123;</span><br><span class="line">            g.drawString(player.fireCount &lt;= <span class="number">10</span> ? <span class="string">&quot;哒哒哒哒哒……&quot;</span> : player.fireCount == player.fireCD ? <span class="string">&quot;加特林停了&quot;</span> : <span class="string">&quot;加特林转啊！&quot;</span>,</span><br><span class="line">                    width / <span class="number">2</span> + <span class="number">60</span>, height + <span class="number">140</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            g.drawString(player.fireCount &lt;= <span class="number">0</span> ? <span class="string">&quot;弹药装填完毕&quot;</span> : <span class="string">&quot;装填中…&quot;</span>, width / <span class="number">2</span> + <span class="number">60</span>, height + <span class="number">140</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出 敌人数量（这个方法是UI的一部分，统计数量，而不是画坦克）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawEnemyNum</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;等线&quot;</span>, Font.ITALIC + Font.BOLD, <span class="number">20</span>));</span><br><span class="line">        g.setColor(Color.BLACK);</span><br><span class="line">        g.drawString(<span class="string">&quot;雷达发现敌人数量：&quot;</span> + (maps[level].levelEnemyNum - deadEnemy.size()), (<span class="type">int</span>) (width * <span class="number">0.77</span>), height + <span class="number">22</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出 经验值。有几点就有几颗红星被点亮。</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawStars</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (player.vehicle.LEVEL_UP_REQUIRED) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">10</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">280</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">9</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">250</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">8</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">220</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">7</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">190</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">6</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">160</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">5</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">130</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">4</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">100</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">3</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">70</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">2</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">40</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                g.drawImage(player.enhance &gt;= <span class="number">1</span> ? InputImage.star : InputImage.nStar,</span><br><span class="line">                        <span class="number">10</span>, height + <span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="built_in">this</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                g.setColor(Color.GRAY);             <span class="comment">//不能升级的坦克，画一个小小的圆</span></span><br><span class="line">                g.fillOval(<span class="number">40</span>, height + <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawPause</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;等线&quot;</span>, Font.ITALIC + Font.BOLD, <span class="number">70</span>));</span><br><span class="line">        g.setColor(Color.DARK_GRAY);</span><br><span class="line">        g.drawString(<span class="string">&quot;游戏暂停中，按 P 键继续游戏&quot;</span>, (<span class="type">int</span>) ((width / <span class="number">2</span>) * <span class="number">0.2</span>), (height / <span class="number">2</span> - <span class="number">100</span>));</span><br><span class="line">        <span class="keyword">if</span> (saved)&#123;</span><br><span class="line">            g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;等线&quot;</span>, Font.ITALIC + Font.BOLD, <span class="number">50</span>));</span><br><span class="line">            g.setColor(Color.DARK_GRAY);</span><br><span class="line">            g.drawString(<span class="string">&quot;存档成功！&quot;</span>, (<span class="type">int</span>) ((width / <span class="number">2</span>) * <span class="number">0.8</span>), (height / <span class="number">2</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(loaded)&#123;</span><br><span class="line">            g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;等线&quot;</span>, Font.ITALIC + Font.BOLD, <span class="number">50</span>));</span><br><span class="line">            g.setColor(Color.DARK_GRAY);</span><br><span class="line">            g.drawString(<span class="string">&quot;读档成功！&quot;</span>, (<span class="type">int</span>) ((width / <span class="number">2</span>) * <span class="number">0.8</span>), (height / <span class="number">2</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (deadEnemy.size() &gt;= maps[level].levelEnemyNum &amp;&amp; (!bossActive || !boss.alive))&#123;</span><br><span class="line">            g.setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;黑体&quot;</span>, Font.ITALIC + Font.BOLD, <span class="number">70</span>));</span><br><span class="line">            g.setColor(Color.ORANGE);</span><br><span class="line">            g.drawString(<span class="string">&quot;下一波敌人接近中！&quot;</span>, (<span class="type">int</span>) ((width / <span class="number">2</span>) * <span class="number">0.5</span>), (<span class="type">int</span>)(height * <span class="number">0.8</span>));</span><br><span class="line">                                                                                        <span class="comment">//*****此处需要修改*****</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出 玩家坦克</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawPlayer</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        player.pause = <span class="built_in">this</span>.pause;</span><br><span class="line">        drawLivingTank(g, player);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出敌人坦克</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawEnemy</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        Iterator&lt;Tank&gt; iterator = enemy.iterator();</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            <span class="type">Tank</span> <span class="variable">temp</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">            <span class="keyword">if</span> (!temp.alive) &#123;                              <span class="comment">//这个分支，坦克已被摧毁</span></span><br><span class="line">                temp.releaseCollisionSize();                <span class="comment">//消除其碰撞体积</span></span><br><span class="line">                iterator.remove();</span><br><span class="line">                deadEnemy.add(temp);                        <span class="comment">//从 敌人集 把该坦克删除，加入 破坏坦克集</span></span><br><span class="line">                player.enhanced(temp.vehicle);              <span class="comment">//给玩家结算经验</span></span><br><span class="line">                enemyPositions.put(enemyPosition[n], <span class="literal">false</span>);<span class="comment">//该坦克占用的位置被解放</span></span><br><span class="line">            &#125;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        creatEnemy();                       <span class="comment">//尝试生成新的坦克</span></span><br><span class="line">        iterator = enemy.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            <span class="type">Tank</span> <span class="variable">t</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">            t.pause = <span class="built_in">this</span>.pause;                <span class="comment">//暂停设置</span></span><br><span class="line"><span class="comment">//            if (t.specialCount &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">//                t.specialCount--;                                     //*****此处需要修改*****</span></span><br><span class="line"><span class="comment">//            &#125; else &#123;</span></span><br><span class="line">            drawLivingTank(g, t);       <span class="comment">//画出所有（敌人的）坦克</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (bossActive) &#123;</span><br><span class="line">            boss.pause = <span class="built_in">this</span>.pause;</span><br><span class="line">            drawBoss(g);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawBoss</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (boss.alive) &#123;</span><br><span class="line">            drawTank(g, boss);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            drawExplosion(g, boss);</span><br><span class="line">        &#125;</span><br><span class="line">        drawBullet(g, boss);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出被摧毁的坦克的残留特效及其所有残留子弹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawDeadTank</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        Iterator&lt;Tank&gt; iterator = deadEnemy.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            <span class="type">Tank</span> <span class="variable">temp</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">            temp.pause = <span class="built_in">this</span>.pause;</span><br><span class="line">            <span class="keyword">if</span> (temp.specialCount &gt; <span class="number">0</span>) &#123;          <span class="comment">//敌人的特殊计数残留时，画出其爆炸效果</span></span><br><span class="line">                temp.specialCount--;                                        <span class="comment">//*****此处需要修改*****</span></span><br><span class="line">                drawExplosion(g, temp);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (temp.bullets.size() &gt; <span class="number">0</span>) &#123;          <span class="comment">//敌人的子弹有残留时，画出该子弹</span></span><br><span class="line">                drawBullet(g, temp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出存活的坦克及其所有子弹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawLivingTank</span><span class="params">(Graphics g, Tank tank)</span> &#123;</span><br><span class="line">        <span class="comment">//以下部分画出坦克</span></span><br><span class="line">        <span class="keyword">if</span> (tank.alive) &#123;</span><br><span class="line">            drawTank(g, tank);       <span class="comment">//存活的场合，画出坦克</span></span><br><span class="line">            drawBullet(g, tank);                <span class="comment">//画出子弹</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//画坦克。这个方法能画出朝向正确的坦克。</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawTank</span><span class="params">(Graphics g, Tank tank)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> dirState2(tank.dir);</span><br><span class="line">        <span class="keyword">switch</span> (tank.vehicle) &#123;</span><br><span class="line">            <span class="keyword">case</span> Tank_Lv1:</span><br><span class="line">                image = dirState(tank.dir) ? InputImage.tank1 : InputImage.tank1r;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Tank_Lv2:</span><br><span class="line">                image = dirState(tank.dir) ? InputImage.tank2 : InputImage.tank2r;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Tank_Lv3:</span><br><span class="line">                image = dirState(tank.dir) ? InputImage.tank3 : InputImage.tank3r;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Tank_E1:</span><br><span class="line">                image = dirState(tank.dir) ? InputImage.tankE1 : InputImage.tankE1r;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Tank_E2:</span><br><span class="line">                image = dirState(tank.dir) ? InputImage.tankE2 : InputImage.tankE2r;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Tank_E3:</span><br><span class="line">                image = dirState(tank.dir) ? InputImage.tankE3 : InputImage.tankE3r;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Tank_Special:</span><br><span class="line">                image = dirState(tank.dir) ? InputImage.tankSp : InputImage.tankSpr;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Basic:</span><br><span class="line">                <span class="keyword">if</span> (tank.fireCount &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">                    image = dirState(tank.dir) ? InputImage.basicL : InputImage.basicLR;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    image = dirState(tank.dir) ? InputImage.basic : InputImage.basicR;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        g.drawImage(image, b ? tank.x + <span class="number">80</span> : tank.x, b ? tank.y + <span class="number">80</span> : tank.y, b ? -<span class="number">80</span> : <span class="number">80</span>, b ? -<span class="number">80</span> : <span class="number">80</span>, <span class="built_in">this</span>);</span><br><span class="line">        <span class="keyword">if</span> (tank.invincible &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (tank.vehicle) &#123;             <span class="comment">//无敌持续中的场合，画出护盾</span></span><br><span class="line">                <span class="keyword">case</span> Tank_Special:</span><br><span class="line">                <span class="keyword">case</span> Basic:</span><br><span class="line">                    image = dirState(tank.dir) ? InputImage.bubble : InputImage.bubbleR;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    image = dirState(tank.dir) ? InputImage.bubbleE : InputImage.bubbleER;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            g.drawImage(image, tank.x - <span class="number">5</span>, tank.y - <span class="number">5</span>, <span class="number">90</span>, <span class="number">90</span>, <span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出子弹。这个方法也会判断子弹的状态（是否存活）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawBullet</span><span class="params">(Graphics g, Tank tank)</span> &#123;</span><br><span class="line">        Iterator&lt;Bullet&gt; iterator = tank.bullets.iterator();</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            <span class="type">Bullet</span> <span class="variable">temp</span> <span class="operator">=</span> iterator.next();</span><br><span class="line">            temp.pause = pause;</span><br><span class="line">            <span class="keyword">if</span> (!temp.active) &#123;                 <span class="comment">//子弹消亡的场合，移除子弹</span></span><br><span class="line">                iterator.remove();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;                            <span class="comment">//走到这里，说明子弹存活。</span></span><br><span class="line">                <span class="keyword">switch</span> (tank.party) &#123;           <span class="comment">//看看是哪个阵营发出的子弹，去判定别的阵营的坦克</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                        <span class="keyword">if</span> (bossActive &amp;&amp; checkHit(boss, temp, tank)) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">for</span> (Tank t : enemy) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (checkHit(t, temp, tank)) &#123;      <span class="comment">//遍历敌坦克，看看打中了谁。打中则停止判定</span></span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                        checkHit(player, temp, tank);           <span class="comment">//看看有没有击中玩家</span></span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                &#125;</span><br><span class="line">                drawBullet(g, tank.vehicle, temp.getDir(), temp.getX(), temp.getY());       <span class="comment">//画出子弹</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出子弹。这个方法通常由上个方法调用，能画出朝向正确的子弹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawBullet</span><span class="params">(Graphics g, Vehicle vehicle, <span class="type">char</span> dir, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> dirState2(dir);</span><br><span class="line">        <span class="keyword">switch</span> (vehicle.BULLET) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">                image = dirState(dir) ? InputImage.nBullet : InputImage.nBulletR;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;e&#x27;</span>:</span><br><span class="line">                image = dirState(dir) ? InputImage.eBullet : InputImage.eBulletR;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">                image = dirState(dir) ? InputImage.gBullet : InputImage.gBulletR;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        g.drawImage(image, b ? x + <span class="number">10</span> : x, b ? y + <span class="number">10</span> : y, b ? -<span class="number">10</span> : <span class="number">10</span>, b ? -<span class="number">10</span> : <span class="number">10</span>, <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//画出爆炸。爆炸分为几个阶段，而且不同坦克也有不同爆炸特效</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">drawExplosion</span><span class="params">(Graphics g, Tank tank)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (tank.specialCount &gt; <span class="number">350</span>) &#123;</span><br><span class="line">            drawTank(g, tank);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> (tank.vehicle) &#123;</span><br><span class="line">            <span class="keyword">case</span> Tank_E3:</span><br><span class="line">                <span class="keyword">if</span> (tank.specialCount &lt; <span class="number">600</span> &amp;&amp; tank.specialCount &gt;= <span class="number">100</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (tank.specialCount &gt;= <span class="number">500</span>) &#123;</span><br><span class="line">                        image = InputImage.explosion1;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tank.specialCount &gt;= <span class="number">400</span>) &#123;</span><br><span class="line">                        image = InputImage.explosion2;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tank.specialCount &gt;= <span class="number">300</span>) &#123;</span><br><span class="line">                        image = InputImage.explosion3;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tank.specialCount &gt;= <span class="number">200</span>) &#123;</span><br><span class="line">                        image = InputImage.explosion4;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        image = InputImage.explosion5;</span><br><span class="line">                    &#125;</span><br><span class="line">                    g.drawImage(image, tank.x, tank.y, <span class="number">80</span>, <span class="number">80</span>, <span class="built_in">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> Tank_E1:</span><br><span class="line">            <span class="keyword">case</span> Tank_E2:</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">if</span> (tank.specialCount &lt; <span class="number">450</span> &amp;&amp; tank.specialCount &gt;= <span class="number">50</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (tank.specialCount &gt;= <span class="number">250</span>) &#123;</span><br><span class="line">                        image = InputImage.explosion1;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tank.specialCount &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                        image = InputImage.explosion2;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        image = InputImage.explosion3;</span><br><span class="line">                    &#125;</span><br><span class="line">                    g.drawImage(image, tank.x, tank.y, <span class="number">80</span>, <span class="number">80</span>, <span class="built_in">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        tank.specialCount = Math.max(tank.specialCount, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//下面这两个方法可以帮助其他方法画出正确朝向的对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">dirState</span><span class="params">(<span class="type">char</span> dir)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dir == <span class="string">&#x27;u&#x27;</span> || dir == <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">dirState2</span><span class="params">(<span class="type">char</span> dir)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dir == <span class="string">&#x27;l&#x27;</span> || dir == <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//检查子弹是否击中目标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkHit</span><span class="params">(Tank tank, Bullet bullet, Tank from)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (hit(tank, bullet) &amp;&amp; !bullet.hasHit(tank)) &#123;        <span class="comment">//检查是否击中目标 及 目标是否已被击中过</span></span><br><span class="line">            bullet.setHit(tank);</span><br><span class="line">            <span class="keyword">if</span> (tank.invincible &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                bullet.pierce = <span class="number">0</span>;              <span class="comment">//撞到无敌的坦克时，子弹直接报销</span></span><br><span class="line">            &#125;</span><br><span class="line">            bullet.active = bullet.pierce &gt; <span class="number">0</span>;          <span class="comment">//子弹穿透降为 0 的场合，子弹消亡</span></span><br><span class="line">            <span class="keyword">if</span> (!tank.takeDamage(from, bullet.getDir())) &#123;                      <span class="comment">//坦克伤害计数完后，在这里把 HP 归 0 的坦克记为已销毁</span></span><br><span class="line">                tank.alive = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//看看子弹是否击中坦克。由上个方法调用</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">hit</span><span class="params">(Tank tank, Bullet bullet)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!tank.alive) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tank.vehicle == Vehicle.Basic) &#123;</span><br><span class="line">            <span class="keyword">return</span> pIn(tank.x + <span class="number">30</span>, <span class="number">20</span>, bullet.getX() + <span class="number">5</span>) &amp;&amp; pIn(tank.y + <span class="number">30</span>, <span class="number">20</span>, bullet.getY() + <span class="number">5</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">switch</span> (tank.getDir()) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> pIn(tank.x + <span class="number">20</span>, <span class="number">40</span>, bullet.getX() + <span class="number">5</span>) &amp;&amp; pIn(tank.y + <span class="number">3</span>, <span class="number">76</span>, bullet.getY() + <span class="number">5</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> pIn(tank.x + <span class="number">3</span>, <span class="number">76</span>, bullet.getX() + <span class="number">5</span>) &amp;&amp; pIn(tank.y + <span class="number">20</span>, <span class="number">40</span>, bullet.getY() + <span class="number">5</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//看看某个坐标（横坐标或纵坐标）是否在[p, p + w]范围内</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">pIn</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> w, <span class="type">int</span> toCheck)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toCheck &gt;= p &amp;&amp; toCheck &lt;= (p + w);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">keyTyped</span><span class="params">(KeyEvent e)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//监视器。以下方式保证了动画的流畅度</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">keyPressed</span><span class="params">(KeyEvent e)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (e.getKeyCode()) &#123;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_W:</span><br><span class="line">                isPressingW = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_A:</span><br><span class="line">                isPressingA = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_D:</span><br><span class="line">                isPressingD = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_S:</span><br><span class="line">                isPressingS = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_J:         <span class="comment">//J 是开火键</span></span><br><span class="line">                isFiring = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"><span class="comment">//            //===================以下为测试用=====================</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_Q:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                for (Tank tank : enemy) &#123;</span></span><br><span class="line"><span class="comment">//                    tank.alive = false;</span></span><br><span class="line"><span class="comment">//                    tank.releaseCollisionSize();</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_E:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                deadEnemy.clear();</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_1:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.setVehicle(Vehicle.Tank_Lv1);</span></span><br><span class="line"><span class="comment">//                player.releaseCollisionSize();</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_2:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.setVehicle(Vehicle.Tank_Lv2);</span></span><br><span class="line"><span class="comment">//                player.releaseCollisionSize();</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_3:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.setVehicle(Vehicle.Tank_Lv3);</span></span><br><span class="line"><span class="comment">//                player.releaseCollisionSize();</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_4:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.setVehicle(Vehicle.Tank_Special);</span></span><br><span class="line"><span class="comment">//                player.releaseCollisionSize();</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_5:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.setVehicle(Vehicle.Basic);</span></span><br><span class="line"><span class="comment">//                player.releaseCollisionSize();</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_Z:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.buffedDef = 100;</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_X:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.buffedDef = 0;</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_C:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.invincible = 1000000;</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case KeyEvent.VK_V:                                     //该 case 仅测试用。  务必删除！务必删除！</span></span><br><span class="line"><span class="comment">//                player.invincible = 0;</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line">            <span class="comment">//===================以上为测试用=====================</span></span><br><span class="line">        &#125;</span><br><span class="line">        isGoing();          <span class="comment">//看看玩家是否正在移动</span></span><br><span class="line">        isFiring();         <span class="comment">//看看玩家是否正在开火</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//同上</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">keyReleased</span><span class="params">(KeyEvent e)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (e.getKeyCode()) &#123;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_W:             <span class="comment">//向上</span></span><br><span class="line">                isPressingW = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_A:             <span class="comment">//向左</span></span><br><span class="line">                isPressingA = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_D:             <span class="comment">//向右</span></span><br><span class="line">                isPressingD = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_S:             <span class="comment">//向下</span></span><br><span class="line">                isPressingS = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_J:             <span class="comment">//开火</span></span><br><span class="line">                isFiring = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_P:             <span class="comment">//暂停</span></span><br><span class="line">                gamePause();</span><br><span class="line">                saved = <span class="literal">false</span>;</span><br><span class="line">                loaded = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_I:             <span class="comment">//读档（需要暂停）</span></span><br><span class="line">                toLoad = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_O:             <span class="comment">//存档（需要暂停）</span></span><br><span class="line">                toSave = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        isGoing();</span><br><span class="line">        isFiring();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//更新玩家的移动状态</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">isGoing</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!player.pause) &#123;</span><br><span class="line">            <span class="keyword">if</span> (isPressingW) &#123;</span><br><span class="line">                player.dir = <span class="string">&#x27;u&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isPressingS) &#123;</span><br><span class="line">                player.dir = <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isPressingA) &#123;</span><br><span class="line">                player.dir = <span class="string">&#x27;l&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isPressingD) &#123;</span><br><span class="line">                player.dir = <span class="string">&#x27;r&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        player.isMoving = isPressingA || isPressingS || isPressingD || isPressingW;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//更新玩家的开火状态</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">isFiring</span><span class="params">()</span> &#123;</span><br><span class="line">        player.isFiring = isFiring;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成敌人，直到允许的最大数量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">creatEnemy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (enemy.size() &lt; enemyMax &amp;&amp; enemy.size() &lt; maps[level].levelEnemyNum - deadEnemy.size()) &#123;</span><br><span class="line">            <span class="type">int</span>[] temp = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span>[] ints : enemyPosition) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!enemyPositions.get(ints)) &#123;            <span class="comment">//为坦克分配初始位置</span></span><br><span class="line">                    temp = ints;</span><br><span class="line">                    enemyPositions.put(ints, <span class="literal">true</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (temp == <span class="literal">null</span>) &#123;                 <span class="comment">//应该不会抛出异常。但，以防万一，加上这句</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Tank</span> <span class="variable">tempTank</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enemy</span>(temp[<span class="number">0</span>], temp[<span class="number">1</span>], maps[level]);</span><br><span class="line">            <span class="keyword">if</span> (deadEnemy.size() == <span class="number">0</span>) &#123;</span><br><span class="line">                tempTank.specialCount = <span class="number">0</span>;          <span class="comment">//坦克有延迟显示。这里取消了第一组坦克（初始敌人坦克）的延迟显示</span></span><br><span class="line">            &#125;</span><br><span class="line">            enemy.add(tempTank);         <span class="comment">//在 敌人集 中添加新的坦克</span></span><br><span class="line">            tempTank.start();            <span class="comment">//启动该新坦克线程</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这个方法有两个作用：</span></span><br><span class="line">    <span class="comment">//  1. 其他敌人全灭时，激活 BOSS</span></span><br><span class="line">    <span class="comment">//  2. 所有敌人全灭时，进入下一关</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkLevelClear</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deadEnemy.size() == maps[level].levelEnemyNum &amp;&amp; !bossActive &amp;&amp; boss != <span class="literal">null</span> &amp;&amp; boss.alive) &#123;</span><br><span class="line">            boss.start();</span><br><span class="line">            bossActive = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (deadEnemy.size() &gt;= maps[level].levelEnemyNum &amp;&amp; (boss == <span class="literal">null</span> || !boss.alive)) &#123;</span><br><span class="line">            gameSuspend = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//关卡间设置短暂停顿</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pauseBetweenLevels</span><span class="params">(<span class="type">int</span> time)</span> &#123;</span><br><span class="line">        gameSuspend = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Timing</span>(time)).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//每次调用会切换 暂停状态。</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">gamePause</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pause = !<span class="built_in">this</span>.pause;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//进入下一关时，加载下一关数据</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">nextLevel</span><span class="params">()</span> &#123;</span><br><span class="line">        player.releaseCollisionSize();</span><br><span class="line">        player.x = <span class="number">200</span>;</span><br><span class="line">        player.y = height - <span class="number">200</span>;</span><br><span class="line">        level++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maps[level].mapData.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; maps[level].mapData[i].length; j++) &#123;</span><br><span class="line">                inputMapData(i, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] ints : enemyPosition) &#123;</span><br><span class="line">            enemyPositions.put(ints, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Tank tank : deadEnemy) &#123;</span><br><span class="line">            tank.releaseCollisionSize();</span><br><span class="line">        &#125;</span><br><span class="line">        enemy.clear();</span><br><span class="line">        deadEnemy.clear();</span><br><span class="line">        player.lifeRemains = player.vehicle.LIFE;</span><br><span class="line">        player.invincible = <span class="number">0</span>;</span><br><span class="line">        gameSuspend = <span class="literal">false</span>;</span><br><span class="line">        boss = maps[level].boss;</span><br><span class="line">        <span class="keyword">if</span> (boss != <span class="literal">null</span>) &#123;</span><br><span class="line">            boss.x = Math.max(width / <span class="number">2</span> - <span class="number">40</span>, <span class="number">0</span>);</span><br><span class="line">            boss.y = <span class="number">70</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        bossActive = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从 Map 类中 加载既定的地图数据</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inputMapData</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; <span class="number">40</span>; k++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>; l &lt; <span class="number">40</span>; l++) &#123;</span><br><span class="line">                mapData[(x * <span class="number">40</span>) + k][(y * <span class="number">40</span>) + l][<span class="number">1</span>] = maps[level].mapData[x][y][<span class="number">1</span>];</span><br><span class="line">                mapData[(x * <span class="number">40</span>) + k][(y * <span class="number">40</span>) + l][<span class="number">0</span>] = maps[level].mapData[x][y][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;                                                                           <span class="comment">//*****此处需要修改*****</span></span><br><span class="line">        <span class="comment">//这里需要对 地图逻辑、坦克行进逻辑 都进行修改。</span></span><br><span class="line">        <span class="comment">// 现行方法是：由 mapData[][] 记录每个像素的数据。每个像素点的占用情况实时更新。</span></span><br><span class="line">        <span class="comment">// 改成：由 mapData[][] 记录所有 40 * 40 方格的数据。</span></span><br><span class="line">        <span class="comment">//      相信这个办法应该能解决现行方法偶发的空气墙问题，扩展性也会更好。存档大小也能缩小，因而也有机会优化存档逻辑。</span></span><br><span class="line">        <span class="comment">//      目前的代码基本兼容这个新方法。Map 类的数据本来就是 40 * 40 方格模式。地图大小、各类模型尺寸也都是 40 的整数倍</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//读档</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">loadData</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (pause) &#123;</span><br><span class="line">            <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!TankGame.savePath.exists()) &#123;</span><br><span class="line">                    TankGame.savePath.createNewFile();</span><br><span class="line">                &#125;</span><br><span class="line">                ois = <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(TankGame.savePath));</span><br><span class="line">                <span class="keyword">if</span>((MyPanel)ois.readObject() != <span class="literal">null</span>)&#123;</span><br><span class="line">                    player = (Player) ois.readObject();</span><br><span class="line"><span class="comment">//                    mapData = (int[][][]) ois.readObject();</span></span><br><span class="line">                    enemy = (Vector&lt;Tank&gt;) ois.readObject();</span><br><span class="line">                    deadEnemy = (Vector&lt;Tank&gt;) ois.readObject();</span><br><span class="line">                    enemyPositions = (LinkedHashMap&lt;<span class="type">int</span>[], Boolean&gt;) ois.readObject();</span><br><span class="line">                    enemyPosition = (<span class="type">int</span>[][]) ois.readObject();</span><br><span class="line">                    maps = (Map[]) ois.readObject();</span><br><span class="line">                    boss = (Tank) ois.readObject();</span><br><span class="line">                    level = ois.readInt();</span><br><span class="line">                    bossActive = ois.readBoolean();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ois.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                    ex.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            pause = <span class="literal">true</span>;</span><br><span class="line">            loaded = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; maps[level].mapData.length; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; maps[level].mapData[i].length; j++) &#123;</span><br><span class="line">                    inputMapData(i, j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (Tank tank : enemy) &#123;</span><br><span class="line">                tank.start();</span><br><span class="line">                <span class="keyword">for</span> (Bullet bullet : tank.bullets) &#123;</span><br><span class="line">                    bullet.start();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (Tank tank : deadEnemy) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Bullet bullet : tank.bullets) &#123;</span><br><span class="line">                    bullet.start();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(bossActive &amp;&amp; boss.alive)&#123;</span><br><span class="line">                boss.start();</span><br><span class="line">            &#125;</span><br><span class="line">            player.start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//存档</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">saveData</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (pause) &#123;</span><br><span class="line">            <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!TankGame.savePath.exists()) &#123;</span><br><span class="line">                    TankGame.savePath.createNewFile();</span><br><span class="line">                &#125;</span><br><span class="line">                oos = <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(TankGame.savePath));</span><br><span class="line">                oos.writeObject(TankGame.mp);</span><br><span class="line">                oos.writeObject(player);</span><br><span class="line"><span class="comment">//                oos.writeObject(mapData);         //占用太大</span></span><br><span class="line">                oos.writeObject(enemy);</span><br><span class="line">                oos.writeObject(deadEnemy);</span><br><span class="line">                oos.writeObject(enemyPositions);</span><br><span class="line">                oos.writeObject(enemyPosition);</span><br><span class="line">                oos.writeObject(maps);</span><br><span class="line">                oos.writeObject(boss);</span><br><span class="line">                oos.writeInt(level);</span><br><span class="line">                oos.writeBoolean(bossActive);</span><br><span class="line">                saved = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    oos.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                    ex.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Tank.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//坦克类。这是一个抽象类，Player 和 Enemy 类会继承此类</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tank</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;             <span class="comment">//为什么是 继承Thread 而不是 实现Runnable？因为我写这些代码的时候还没学到那里……</span></span><br><span class="line">    <span class="comment">/*从上到下依次是：横坐标、纵坐标、坦克类型、方向、当前生命值、速度增幅、攻速增幅、攻击范围增幅、攻击力增幅、防御力增幅、</span></span><br><span class="line"><span class="comment">                    开火间隔、开火间隔计时、子弹集、是否存活、无敌状态持续时间、阵营、死亡计时</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> x;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> y;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">Vehicle</span> <span class="variable">vehicle</span> <span class="operator">=</span> Vehicle.Basic;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">char</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="string">&#x27;u&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">double</span> lifeRemains;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="variable">buffedSpeed</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="variable">buffedAtkSpeed</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="variable">buffedAtkRange</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="variable">buffedAtk</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="variable">buffedDef</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span> <span class="variable">fireCD</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="variable">fireCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> Vector&lt;Bullet&gt; bullets = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();   <span class="comment">//所有活动中的子弹会被存放在里面</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="variable">alive</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="variable">invincible</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> party;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">pause</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="variable">specialCount</span> <span class="operator">=</span> <span class="number">800</span>;             <span class="comment">//坦克死亡后，该计时才开始计数。这个计数是为了播放爆炸动画。计数完毕后该对象会被消除。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Tank</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">        setVehicle(Vehicle.Basic);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置坦克种类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVehicle</span><span class="params">(Vehicle vehicle)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vehicle = vehicle;</span><br><span class="line">        <span class="built_in">this</span>.lifeRemains = vehicle.LIFE;</span><br><span class="line">        <span class="built_in">this</span>.fireCD = <span class="number">200</span> / getAtkSpeed();      <span class="comment">//开火间隔由这个公式算出</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">char</span> <span class="title function_">getDir</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dir;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//受到伤害。这个方法由子类实现</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">takeDamage</span><span class="params">(Tank tank, <span class="type">char</span> dir)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//移动。</span></span><br><span class="line"><span class="comment">//    abstract void move(char move);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">int</span>[] tryMove()&#123;</span><br><span class="line">        <span class="type">int</span>[] temp = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">2</span>];</span><br><span class="line">        temp[<span class="number">0</span>] = x;</span><br><span class="line">        temp[<span class="number">1</span>] = y;</span><br><span class="line">        <span class="keyword">switch</span> (dir) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">                temp[<span class="number">1</span>]--;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                temp[<span class="number">1</span>]++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">                temp[<span class="number">0</span>]--;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">                temp[<span class="number">0</span>]++;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">outOfArea</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span> || x &gt; MyPanel.width - <span class="number">80</span> || y &gt; MyPanel.height - <span class="number">80</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">runIntoSth</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">checking</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">switch</span> (dir) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">                checking = MyPanel.mapData[x + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">40</span>][y + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                checking = MyPanel.mapData[x + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">40</span>][y + <span class="number">40</span> + (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">                checking = MyPanel.mapData[x + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">40</span>][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">                checking = MyPanel.mapData[x + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">40</span>][<span class="number">1</span>] == <span class="number">0</span> &amp;&amp;</span><br><span class="line">                        MyPanel.mapData[x + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>)][y + <span class="number">39</span> + (vehicle.SIZE / <span class="number">2</span>)][<span class="number">1</span>] == <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> !checking;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setCollisionSize</span><span class="params">(<span class="type">int</span> tempX, <span class="type">int</span> tempY, <span class="type">int</span> type, <span class="type">int</span> hp)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; vehicle.SIZE; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; vehicle.SIZE; j++) &#123;</span><br><span class="line">                MyPanel.mapData[tempX + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + i][tempY + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + j][<span class="number">1</span>] = type;</span><br><span class="line">                MyPanel.mapData[tempX + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + i][tempY + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + j][<span class="number">0</span>] = hp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">releaseCollisionSize</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; vehicle.SIZE; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; vehicle.SIZE; j++) &#123;</span><br><span class="line">                MyPanel.mapData[x + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + i][y + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + j][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">                MyPanel.mapData[x + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + i][y + <span class="number">40</span> - (vehicle.SIZE / <span class="number">2</span>) + j][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开火</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fire</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (fireCount &gt; <span class="number">0</span>) &#123;        <span class="comment">//fireCount &gt; 0 说明开火CD 还没好，直接 return</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (vehicle == Vehicle.Basic) &#123;     <span class="comment">//Basic 体积和一般坦克不同，故而发射子弹的位置也不同</span></span><br><span class="line">            fireCount = <span class="number">10</span>;                 <span class="comment">//其武器也不同，所以 开火CD 的逻辑也不同。这里使其每发子弹的间隔很短</span></span><br><span class="line">            <span class="keyword">switch</span> (dir) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">                    fire(x + <span class="number">39</span>, y + <span class="number">17</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                    fire(x + <span class="number">31</span>, y + <span class="number">53</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">                    fire(x + <span class="number">17</span>, y + <span class="number">31</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">                    fire(x + <span class="number">53</span>, y + <span class="number">39</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            fireCount = fireCD;</span><br><span class="line">            <span class="keyword">switch</span> (dir) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">                    fire(x + <span class="number">35</span>, y - <span class="number">10</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                    fire(x + <span class="number">35</span>, y + <span class="number">80</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">                    fire(x - <span class="number">10</span>, y + <span class="number">35</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">                    fire(x + <span class="number">80</span>, y + <span class="number">35</span>, dir, getAtkRange());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fire</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">char</span> dir, <span class="type">int</span> range)</span> &#123;</span><br><span class="line">        <span class="type">Bullet</span> <span class="variable">tempBullet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bullet</span>(vehicle.BULLET, x, y, dir, range, <span class="built_in">this</span>);</span><br><span class="line">        bullets.add(tempBullet);  <span class="comment">//创建一个新的 子弹 实例，并让其运行</span></span><br><span class="line">        tempBullet.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">isFront</span><span class="params">(<span class="type">char</span> dir)</span> &#123;               <span class="comment">//判断是否被从正面击中。如若是，坦克的防御力生效</span></span><br><span class="line">        <span class="keyword">switch</span> (dir) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.dir == <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.dir == <span class="string">&#x27;u&#x27;</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.dir == <span class="string">&#x27;l&#x27;</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.dir == <span class="string">&#x27;r&#x27;</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pause</span><span class="params">(<span class="type">boolean</span> pause)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.pause = pause;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAtk</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vehicle.ATK + buffedAtk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDef</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vehicle.DEF + buffedDef;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAtkSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vehicle.ATK_SPEED + buffedAtkSpeed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vehicle.SPEED + buffedSpeed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAtkRange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vehicle.ATK_RANGE + buffedAtkRange;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Player.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Player</span> <span class="keyword">extends</span> <span class="title class_">Tank</span> &#123;</span><br><span class="line">    <span class="comment">//三个属性依次是：经验值、是否正在移动、是否正在开火</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="variable">enhance</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//这两个变量由 MyPanel 的 监视器决定。按下移动/开火键时，变为 true。松开时，变为 false</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">isMoving</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">isFiring</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Player</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(x, y);</span><br><span class="line">        party = <span class="number">0</span>;              <span class="comment">//阵营为 0</span></span><br><span class="line">        setVehicle(Vehicle.Basic);          <span class="comment">//设置初始坦克。               可以随意修改</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (alive) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span> / getSpeed());         <span class="comment">//速度越快、行动越快</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!pause) &#123;</span><br><span class="line">                <span class="keyword">if</span> (invincible &gt; <span class="number">0</span>) &#123;       <span class="comment">//无敌冷却减少</span></span><br><span class="line">                    invincible--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (isMoving) &#123;             <span class="comment">//正在移动的场合，使其移动</span></span><br><span class="line">                    move();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (isFiring) &#123;             <span class="comment">//正在开火的场合，使其开火</span></span><br><span class="line">                    fire();</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vehicle == Vehicle.Basic) &#123;          <span class="comment">//Basic 是特别的。按住开火键的场合，开火CD才减少，不然会增加。</span></span><br><span class="line">                    <span class="comment">// 这样做是为了模拟 加特林 的手感</span></span><br><span class="line">                    fireCount += fireCount &gt;= fireCD ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    fireCount--;            <span class="comment">//开火CD 自然减少</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] temp = tryMove();</span><br><span class="line">        <span class="keyword">if</span> (!outOfArea(temp[<span class="number">0</span>], temp[<span class="number">1</span>]) &amp;&amp; !runIntoSth(temp[<span class="number">0</span>], temp[<span class="number">1</span>])) &#123;</span><br><span class="line">            releaseCollisionSize();</span><br><span class="line">            setCollisionSize(temp[<span class="number">0</span>], temp[<span class="number">1</span>], -<span class="number">2</span>, -<span class="number">1</span>);</span><br><span class="line">            x = temp[<span class="number">0</span>];</span><br><span class="line">            y = temp[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fire</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (fireCount &gt; <span class="number">0</span>) &#123;            <span class="comment">//如果 开火CD 没到，让其自然减少，然后 return</span></span><br><span class="line">            fireCount--;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">super</span>.fire();               <span class="comment">//真正的开火</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//获得经验值。每次消灭敌人坦克会调用该方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">enhanced</span><span class="params">(Vehicle vehicle)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.vehicle == Vehicle.Basic &amp;&amp; Math.random() &gt; <span class="number">0.9</span>) &#123;         <span class="comment">//特殊设定：Basic 的场合，消灭敌人有概率夺取坦克</span></span><br><span class="line">            <span class="keyword">switch</span> (vehicle) &#123;</span><br><span class="line">                <span class="keyword">case</span> Tank_E1:</span><br><span class="line">                    setVehicle(Vehicle.Tank_Lv1);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_E2:</span><br><span class="line">                    setVehicle(Vehicle.Tank_Lv2);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_E3:</span><br><span class="line">                    setVehicle(Vehicle.Tank_Lv3);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_Special:</span><br><span class="line">                    setVehicle(Vehicle.Tank_Special);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> (vehicle) &#123;</span><br><span class="line">                <span class="keyword">case</span> Tank_E1:</span><br><span class="line">                    enhance += <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_E2:</span><br><span class="line">                    enhance += <span class="number">2</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_E3:</span><br><span class="line">                    enhance += <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_Special:</span><br><span class="line">                    enhance += <span class="number">10</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            enhanced();         <span class="comment">//看看能不能升级</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//查看是否升级</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">enhanced</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (vehicle.LEVEL_UP_REQUIRED &gt; <span class="number">0</span> &amp;&amp; enhance &gt;= vehicle.LEVEL_UP_REQUIRED) &#123;</span><br><span class="line">            enhance -= vehicle.LEVEL_UP_REQUIRED;</span><br><span class="line">            releaseCollisionSize();</span><br><span class="line">            <span class="keyword">switch</span> (vehicle) &#123;</span><br><span class="line">                <span class="keyword">case</span> Basic:</span><br><span class="line">                    setVehicle(Vehicle.Tank_Lv1);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_Lv1:</span><br><span class="line">                    setVehicle(Vehicle.Tank_Lv2);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Tank_Lv2:</span><br><span class="line">                    setVehicle(Vehicle.Tank_Lv3);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">            &#125;</span><br><span class="line">            setCollisionSize(x, y, -<span class="number">2</span>, -<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置坦克。每次设置会重置经验值</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setVehicle</span><span class="params">(Vehicle vehicle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.setVehicle(vehicle);</span><br><span class="line">        <span class="built_in">this</span>.enhance = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (vehicle == Vehicle.Basic) &#123;</span><br><span class="line">            fireCount = fireCD;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//受到伤害。传入的是造成伤害的坦克，和击中的子弹方向</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">takeDamage</span><span class="params">(Tank tank, <span class="type">char</span> dir)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">damage</span> <span class="operator">=</span> tank.getAtk() * vehicle.DEF_BY_PERCENT - (isFront(dir) ? <span class="built_in">this</span>.getDef() : <span class="number">0</span>);    <span class="comment">//侧后方中弹，防御力不生效</span></span><br><span class="line">        <span class="keyword">if</span> (invincible &gt; <span class="number">0</span>) &#123;               <span class="comment">//无敌的场合，不受伤害</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((lifeRemains -= Math.max(damage, <span class="number">0.1</span>)) &lt;= <span class="number">0</span>) &#123;           <span class="comment">//这里扣除了生命值。最少扣除 0.1。</span></span><br><span class="line">            invincible += <span class="number">200</span>;              <span class="comment">//坦克被打爆，给一段无敌时间</span></span><br><span class="line">            releaseCollisionSize();</span><br><span class="line">            <span class="keyword">switch</span> (vehicle) &#123;              <span class="comment">//坦克降级。Basic 的场合，游戏结束</span></span><br><span class="line">                <span class="keyword">case</span> Tank_Lv3:</span><br><span class="line">                <span class="keyword">case</span> Tank_Lv2:</span><br><span class="line">                <span class="keyword">case</span> Tank_Lv1:</span><br><span class="line">                <span class="keyword">case</span> Tank_Special:</span><br><span class="line">                    setVehicle(Vehicle.Basic);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> Basic:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line">            setCollisionSize(x, y, -<span class="number">2</span>, -<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        invincible += <span class="number">100</span>;      <span class="comment">//只要受到了伤害，产生短暂无敌时间</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Enemy.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//敌人的坦克</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Enemy</span> <span class="keyword">extends</span> <span class="title class_">Tank</span> &#123;</span><br><span class="line">    <span class="comment">//step：坦克的前进次数。归 0 时会转向</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">step</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">double</span> FIRE_PROBABILITY;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Enemy</span><span class="params">(Vehicle vehicle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        setVehicle(vehicle);</span><br><span class="line">        party = <span class="number">1</span>;</span><br><span class="line">        dir = <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">        invincible = <span class="number">300</span>;</span><br><span class="line">        FIRE_PROBABILITY = <span class="number">0.95</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Enemy</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, Map map)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(x, y);</span><br><span class="line">        giveVehicle(map.probability_E1, map.probability_E2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Enemy</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(x, y);</span><br><span class="line">        party = <span class="number">1</span>;              <span class="comment">//敌方坦克阵营为 1</span></span><br><span class="line"><span class="comment">//        randomDir();</span></span><br><span class="line"><span class="comment">//        giveVehicle();</span></span><br><span class="line">        dir = <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">        invincible = <span class="number">130</span>;       <span class="comment">//敌方坦克出生时，赋予短时间的无敌</span></span><br><span class="line">        FIRE_PROBABILITY = <span class="number">0.985</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">700</span> + specialCount);          <span class="comment">//坦克出生时，使其短暂休眠。</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        specialCount = <span class="number">200</span> + (<span class="type">int</span>) (<span class="number">80</span> * lifeRemains);         <span class="comment">//坦克的 死亡计数，和坦克种类有关</span></span><br><span class="line">        <span class="keyword">while</span> (alive) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep((<span class="number">100</span> / getSpeed()));       <span class="comment">//坦克速度越快，其所有行动速度越快</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!pause) &#123;</span><br><span class="line">                <span class="keyword">if</span> (invincible &gt; <span class="number">0</span>) &#123;           <span class="comment">//无敌时间减少</span></span><br><span class="line">                    invincible--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (fireCount &gt; <span class="number">0</span>) &#123;            <span class="comment">//开火CD计数减少</span></span><br><span class="line">                    fireCount--;</span><br><span class="line">                &#125;</span><br><span class="line">                move();               <span class="comment">//移动</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        releaseCollisionSize();</span><br><span class="line">        <span class="keyword">while</span> (specialCount &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!pause) &#123;</span><br><span class="line">                specialCount--;                                    <span class="comment">//*****此处需要修改*****</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">giveVehicle</span><span class="params">(<span class="type">double</span> probabilityE1, <span class="type">double</span> probabilityE2)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">result</span> <span class="operator">=</span> Math.random();</span><br><span class="line">        <span class="keyword">if</span> (result &lt;= probabilityE1) &#123;</span><br><span class="line">            setVehicle(Vehicle.Tank_E1);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result &lt;= probabilityE2) &#123;</span><br><span class="line">            setVehicle(Vehicle.Tank_E2);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            setVehicle(Vehicle.Tank_E3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">()</span> &#123;            <span class="comment">//传入的字符没用。</span></span><br><span class="line">        <span class="keyword">if</span> (step &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            randomDir();                        <span class="comment">//步数归 0 时，赋予其随机方向</span></span><br><span class="line">            realMove();</span><br><span class="line">            step = (<span class="type">int</span>) (Math.random() * <span class="number">200</span> + <span class="number">60</span> - <span class="number">3</span> * getSpeed());       <span class="comment">//赋予其随机的步数</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (step &lt;= <span class="number">60</span> - <span class="number">2</span> * getSpeed()) &#123;       <span class="comment">//最后几步的时候，让坦克在原地稍作停留（不移动）</span></span><br><span class="line">            step--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            realMove();</span><br><span class="line">            step--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (Math.random() &gt; FIRE_PROBABILITY) &#123;            <span class="comment">//使敌方坦克有 1.5% 的概率开火。这个概率经过测试，比较合适           这里可以更改</span></span><br><span class="line">            fire();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">realMove</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] temp = tryMove();</span><br><span class="line">        <span class="keyword">if</span> (!outOfArea(temp[<span class="number">0</span>], temp[<span class="number">1</span>]) &amp;&amp; !runIntoSth(temp[<span class="number">0</span>], temp[<span class="number">1</span>])) &#123;</span><br><span class="line">            releaseCollisionSize();</span><br><span class="line">            setCollisionSize(temp[<span class="number">0</span>], temp[<span class="number">1</span>], -<span class="number">1</span>, -<span class="number">1</span>);</span><br><span class="line">            x = temp[<span class="number">0</span>];</span><br><span class="line">            y = temp[<span class="number">1</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            step -= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//赋予随机方向（概率均匀）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">randomDir</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> ((<span class="type">int</span>) (Math.random() * <span class="number">4</span>)) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                dir = <span class="string">&#x27;u&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                dir = <span class="string">&#x27;r&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                dir = <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                dir = <span class="string">&#x27;l&#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//受伤。传入的是造成伤害的坦克（以计算伤害），及子弹方向（用于判断是否是正面中弹）</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">takeDamage</span><span class="params">(Tank tank, <span class="type">char</span> dir)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">damage</span> <span class="operator">=</span> tank.getAtk() * vehicle.DEF_BY_PERCENT - (isFront(dir) ? getDef() : <span class="number">0</span>);     <span class="comment">//侧后方中弹的场合，防御力不生效</span></span><br><span class="line">        <span class="keyword">if</span> (invincible &gt; <span class="number">0</span>) &#123;               <span class="comment">//如果坦克无敌，不会受到伤害</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="built_in">this</span>.lifeRemains -= Math.max(damage, <span class="number">0.1</span>)) &gt; <span class="number">0</span>;        <span class="comment">//在这里进行了生命值的扣除，最少扣 0.1。返回是否生命值有剩</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Vehicle.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//该枚举类存放所有可能的坦克种类及其参数</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Vehicle</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;</span><br><span class="line">    <span class="comment">//Basic 是特别的。设定上，Basic 是离开载具，扛着加特林的驾驶员。其体积和一般坦克不同</span></span><br><span class="line">    Basic(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">3</span>, <span class="number">400</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="string">&#x27;g&#x27;</span>, <span class="number">10</span>),</span><br><span class="line">    Tank_Lv1(<span class="number">5</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1000</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="string">&#x27;n&#x27;</span>),</span><br><span class="line">    Tank_Lv2(<span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1000</span>, <span class="number">10</span>, <span class="number">0.9</span>, <span class="string">&#x27;n&#x27;</span>),</span><br><span class="line">    Tank_Lv3(<span class="number">10</span>, <span class="number">17</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1600</span>, -<span class="number">1</span>, <span class="number">0.8</span>, <span class="string">&#x27;n&#x27;</span>),</span><br><span class="line">    Tank_E1(<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1000</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;n&#x27;</span>),</span><br><span class="line">    Tank_E2(<span class="number">7</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">1000</span>, -<span class="number">1</span>, <span class="number">0.8</span>, <span class="string">&#x27;n&#x27;</span>),</span><br><span class="line">    Tank_E3(<span class="number">10</span>, <span class="number">18</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">1600</span>, -<span class="number">1</span>, <span class="number">0.6</span>, <span class="string">&#x27;n&#x27;</span>),</span><br><span class="line">    Tank_Special(<span class="number">25</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">100000</span>, -<span class="number">1</span>, <span class="number">0.4</span>, <span class="string">&#x27;e&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//从上到下依次是：攻击力、生命值、防御力、速度、攻击速度、攻击范围、升级经验、减伤、子弹种类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> ATK;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">double</span> LIFE;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> DEF;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> SPEED;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> ATK_SPEED;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> ATK_RANGE;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> LEVEL_UP_REQUIRED;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">double</span> DEF_BY_PERCENT;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">char</span> BULLET;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> SIZE;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Vehicle(<span class="type">int</span> atk, <span class="type">double</span> life, <span class="type">int</span> def, <span class="type">int</span> speed, <span class="type">int</span> atkSpeed, <span class="type">int</span> atkRange,</span><br><span class="line">            <span class="type">int</span> levelUpRequired, <span class="type">double</span> defByPercent, <span class="type">char</span> bullet, <span class="type">int</span> size) &#123;</span><br><span class="line">        <span class="built_in">this</span>.ATK = atk;</span><br><span class="line">        <span class="built_in">this</span>.LIFE = life;</span><br><span class="line">        <span class="built_in">this</span>.DEF = def;</span><br><span class="line">        <span class="built_in">this</span>.SPEED = speed;</span><br><span class="line">        <span class="built_in">this</span>.ATK_SPEED = atkSpeed;</span><br><span class="line">        <span class="built_in">this</span>.ATK_RANGE = atkRange;</span><br><span class="line">        <span class="built_in">this</span>.LEVEL_UP_REQUIRED = levelUpRequired;</span><br><span class="line">        <span class="built_in">this</span>.DEF_BY_PERCENT = defByPercent;</span><br><span class="line">        <span class="built_in">this</span>.BULLET = bullet;</span><br><span class="line">        <span class="built_in">this</span>.SIZE = size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vehicle(<span class="type">int</span> atk, <span class="type">double</span> life, <span class="type">int</span> def, <span class="type">int</span> speed, <span class="type">int</span> atkSpeed, <span class="type">int</span> atkRange,</span><br><span class="line">            <span class="type">int</span> levelUpRequired, <span class="type">double</span> defByPercent, <span class="type">char</span> bullet) &#123;</span><br><span class="line">        <span class="built_in">this</span>(atk, life, def, speed, atkSpeed, atkRange, levelUpRequired, defByPercent, bullet, <span class="number">80</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//子弹类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bullet</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">//从上到下依次是：横坐标、纵坐标、方向、子弹速度、子弹是否存在、最大飞行范围、穿透数量、已命中的坦克</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> x;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> y;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">char</span> dir;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> BULLET_SPEED;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">active</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> range;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> pierce;</span><br><span class="line">    <span class="keyword">private</span> Tank master;</span><br><span class="line">    <span class="keyword">private</span> Tank[] hit;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">pause</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Bullet</span><span class="params">(<span class="type">char</span> type, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">char</span> dir, <span class="type">int</span> range, Tank master)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;e&#x27;</span>:</span><br><span class="line">                <span class="built_in">this</span>.BULLET_SPEED = <span class="number">3</span>;</span><br><span class="line">                <span class="built_in">this</span>.pierce = <span class="number">3</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">                <span class="built_in">this</span>.BULLET_SPEED = <span class="number">2</span>;</span><br><span class="line">                <span class="built_in">this</span>.pierce = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="built_in">this</span>.BULLET_SPEED = <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">this</span>.pierce = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        hit = <span class="keyword">new</span> <span class="title class_">Tank</span>[pierce];</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">        <span class="built_in">this</span>.dir = dir;</span><br><span class="line">        <span class="built_in">this</span>.range = range;</span><br><span class="line">        <span class="built_in">this</span>.master = master;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">move</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (dir) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">                y -= BULLET_SPEED;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">                y += BULLET_SPEED;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">                x += BULLET_SPEED;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;l&#x27;</span>:</span><br><span class="line">                x -= BULLET_SPEED;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((range -= BULLET_SPEED) &lt;= <span class="number">0</span> || outOfArea(x, y)) &#123;     <span class="comment">//如果达到最大飞行范围，则销毁该子弹</span></span><br><span class="line">            active = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">outOfArea</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span> || x &gt; MyPanel.width - <span class="number">10</span> || y &gt; MyPanel.height - <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getX</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getY</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">char</span> <span class="title function_">getDir</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dir;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getBULLET_SPEED</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BULLET_SPEED;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHit</span><span class="params">(Tank tank)</span> &#123;             <span class="comment">//当有坦克被该子弹击中后，该方法会被调用。一般由 MyPanel 类中的 checkHit 方法调用</span></span><br><span class="line">        hit[hit.length - pierce--] = tank;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasHit</span><span class="params">(Tank tank)</span> &#123;          <span class="comment">//判断一辆坦克是否已被击中过。一般由 MyPanel 类中的 checkHit 方法调用</span></span><br><span class="line">        <span class="keyword">for</span> (Tank t : hit) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t == tank) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pause</span><span class="params">(<span class="type">boolean</span> pause)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pause = pause;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (active) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!pause) &#123;</span><br><span class="line">                move();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Map.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Map</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    Level1(<span class="number">10</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="literal">null</span>, <span class="number">0</span>, creatNewMap1()),</span><br><span class="line">    Level2(<span class="number">15</span>, <span class="number">0.5</span>, <span class="number">1</span>, Vehicle.Tank_E2, <span class="number">10</span>, creatNewMap2()),</span><br><span class="line">    Level3(<span class="number">20</span>, <span class="number">0.33</span>, <span class="number">0.66</span>, Vehicle.Tank_E3, <span class="number">15</span>, creatNewMap3()),</span><br><span class="line">    Level4(<span class="number">20</span>, <span class="number">0.2</span>, <span class="number">0.5</span>, Vehicle.Tank_Special, <span class="number">20</span>, creatNewMap4());</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> levelEnemyNum;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">double</span> probability_E1;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">double</span> probability_E2;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> Tank boss;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][][] mapData;</span><br><span class="line">    <span class="comment">//[0]：种类。-1 坦克；0 道路；1 墙；2 草丛；3 水池</span></span><br><span class="line">    <span class="comment">//[1]：HP。-1 不可破坏；0 可以通行；1 basic以外任意子弹击中1次可以破坏；2、3 同 1</span></span><br><span class="line"></span><br><span class="line">    Map(<span class="type">int</span> levelEnemyNum, <span class="type">double</span> probability_E1, <span class="type">double</span> probability_E2, Vehicle boss, <span class="type">int</span> bossBuff, <span class="type">int</span>[][][] map) &#123;</span><br><span class="line">        <span class="built_in">this</span>.levelEnemyNum = levelEnemyNum;</span><br><span class="line">        <span class="built_in">this</span>.probability_E1 = probability_E1;</span><br><span class="line">        <span class="built_in">this</span>.probability_E2 = probability_E2;</span><br><span class="line">        <span class="keyword">if</span> (boss == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.boss = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.boss = <span class="keyword">new</span> <span class="title class_">Enemy</span>(boss);</span><br><span class="line">            <span class="built_in">this</span>.boss.lifeRemains += bossBuff;</span><br><span class="line">        &#125;</span><br><span class="line">        mapData = map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][][] creatNewMap1() &#123;</span><br><span class="line">        <span class="type">int</span>[][][] newMap = creatNewMap();</span><br><span class="line">        <span class="keyword">return</span> newMap;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][][] creatNewMap2() &#123;</span><br><span class="line">        <span class="type">int</span>[][][] newMap = creatNewMap();</span><br><span class="line">        <span class="keyword">return</span> newMap;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][][] creatNewMap3() &#123;</span><br><span class="line">        <span class="type">int</span>[][][] newMap = creatNewMap();</span><br><span class="line">        <span class="keyword">return</span> newMap;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][][] creatNewMap4() &#123;</span><br><span class="line">        <span class="type">int</span>[][][] newMap = creatNewMap();</span><br><span class="line">        <span class="keyword">return</span> newMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][][] creatNewMap() &#123;</span><br><span class="line">        <span class="type">int</span>[][][] newMap = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">30</span>][<span class="number">20</span>][<span class="number">2</span>];</span><br><span class="line">        newMap = creatBasicMap(newMap);</span><br><span class="line">        <span class="keyword">return</span> newMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][][] creatBasicMap(<span class="type">int</span>[][][] map)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; map.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; map[i].length; j++) &#123;</span><br><span class="line">                map[i][j][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">                map[i][j][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addWall</span><span class="params">(<span class="type">int</span>[][][] map, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        map[x][y][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        map[x][y][<span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addArea</span><span class="params">(<span class="type">int</span>[][][] map, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> kind, <span class="type">int</span> hp)</span> &#123;</span><br><span class="line">        map[x][y][<span class="number">0</span>] = kind;</span><br><span class="line">        map[x][y][<span class="number">1</span>] = hp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">removeTankCollisionSize</span><span class="params">(Tank tank)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setTankCollisionSize</span><span class="params">(Tank tank)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>InputImage.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">该类中存放所有需要的图片。</span></span><br><span class="line"><span class="comment">包含：坦克图片（tank/basic：4 * 2 + 1 = 9 种）；</span></span><br><span class="line"><span class="comment">     子弹图片（bullet：2 * 2 = 4 种）；</span></span><br><span class="line"><span class="comment">     护盾图片（bubble：2 * 2 = 4种）；</span></span><br><span class="line"><span class="comment">     星星图片（star：2种）、爆炸图片（explosion：5种）;</span></span><br><span class="line"><span class="comment">     地形图片（4种）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InputImage</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tank1</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Lv1.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tank2</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Lv2.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tank3</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Lv3.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">basic</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/P.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">basicL</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Pl.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">basicR</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Pr.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">basicLR</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Plr.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankE1</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_E1.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankE2</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_E2.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankE3</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_E3.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tank1r</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Lv1r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tank2r</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Lv2r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tank3r</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Lv3r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankE1r</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_E1r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankE2r</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_E2r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankE3r</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_E3r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankSp</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Sp.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">tankSpr</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Tank_Spr.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">bubble</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Bubble_red.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">bubbleR</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Bubble_red_r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">bubbleE</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Bubble.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">bubbleER</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Bubble_r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">eBullet</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/E_bullet.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">eBulletR</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/E_bullet_r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">nBullet</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/N_bullet.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">nBulletR</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/N_bullet_r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">gBullet</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/G_bullet.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">gBulletR</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/G_bullet_r.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">star</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Star.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">nStar</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Star_n.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">explosion1</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Explosion/Explosion1.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">explosion2</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Explosion/Explosion2.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">explosion3</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Explosion/Explosion3.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">explosion4</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Explosion/Explosion4.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">explosion5</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Explosion/Explosion5.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">iron</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Landform/Iron.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">wall</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Landform/Wall.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">water</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Landform/Water.png&quot;</span>));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Image</span> <span class="variable">trees</span> <span class="operator">=</span> Toolkit.getDefaultToolkit().getImage(Panel.class.getResource(<span class="string">&quot;/pic/Landform/Trees.png&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Timing.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.tank_game;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Timing</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> time;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Timing</span><span class="params">(<span class="type">int</span> time)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.time = time;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(time);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        MyPanel.gameSuspend = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>导入的图片</p>
<p><img src="/img/Java_InputImage/pic/Bubble.png"></p>
<p><img src="/img/Java_InputImage/pic/Bubble_r.png" alt="Bubble_r"></p>
<p><img src="/img/Java_InputImage/pic/Bubble_red.png" alt="Bubble_red"></p>
<p><img src="/img/Java_InputImage/pic/Bubble_red_r.png" alt="Bubble_red_r"></p>
<p><img src="/img/Java_InputImage/pic/E_bullet.png" alt="E_bullet"></p>
<p><img src="/img/Java_InputImage/pic/E_bullet_r.png" alt="E_bullet_r"></p>
<p><img src="/img/Java_InputImage/pic/G_Bullet.png" alt="G_Bullet"></p>
<p><img src="/img/Java_InputImage/pic/G_Bullet_r.png" alt="G_Bullet_r"></p>
<p><img src="/img/Java_InputImage/pic/N_bullet.png" alt="N_bullet"></p>
<p><img src="/img/Java_InputImage/pic/N_bullet_r.png" alt="N_bullet_r"></p>
<p><img src="/img/Java_InputImage/pic/p.png" alt="p"></p>
<p><img src="/img/Java_InputImage/pic/pl.png" alt="pl"></p>
<p><img src="/img/Java_InputImage/pic/plr.png" alt="plr"></p>
<p><img src="/img/Java_InputImage/pic/Pr.png" alt="Pr"></p>
<p><img src="/img/Java_InputImage/pic/Star.png" alt="Star"></p>
<p><img src="/img/Java_InputImage/pic/Star_n.png" alt="Star_n"></p>
<p><img src="/img/Java_InputImage/pic/Tank_E1.png" alt="Tank_E1"></p>
<p><img src="/img/Java_InputImage/pic/Tank_E1r.png" alt="Tank_E1r"></p>
<p><img src="/img/Java_InputImage/pic/Tank_E2.png" alt="Tank_E2"></p>
<p><img src="/img/Java_InputImage/pic/Tank_E2r.png" alt="Tank_E2r"></p>
<p><img src="/img/Java_InputImage/pic/Tank_E3.png" alt="Tank_E3"></p>
<p><img src="/img/Java_InputImage/pic/Tank_E3r.png" alt="Tank_E3r"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Lv1.png" alt="Tank_Lv1"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Lv1r.png" alt="Tank_Lv1r"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Lv2.png" alt="Tank_Lv2"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Lv2r.png" alt="Tank_Lv2r"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Lv3.png" alt="Tank_Lv3"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Lv3r.png" alt="Tank_Lv3r"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Sp.png" alt="Tank_Sp"></p>
<p><img src="/img/Java_InputImage/pic/Tank_Spr.png" alt="Tank_Spr"></p>
<p><img src="/img/Java_InputImage/pic/Landform/Iron.png"></p>
<p><img src="/img/Java_InputImage/pic/Landform/Trees.png" alt="Trees"></p>
<p><img src="/img/Java_InputImage/pic/Landform/Wall.png" alt="Wall"></p>
<p><img src="/img/Java_InputImage/pic/Landform/Water.png" alt="Water"></p>
<p><img src="/img/Java_InputImage/pic/Explosion/Explosion1.png"></p>
<p><img src="/img/Java_InputImage/pic/Explosion/Explosion2.png" alt="Explosion2"></p>
<p><img src="/img/Java_InputImage/pic/Explosion/Explosion3.png" alt="Explosion3"></p>
<p><img src="/img/Java_InputImage/pic/Explosion/Explosion4.png" alt="Explosion4"></p>
<p><img src="/img/Java_InputImage/pic/Explosion/Explosion5.png" alt="Explosion5"></p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/01/11/18%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98/" data-id="claq1vt5i000ttwtf85ld033i" data-title="&lt;Java&gt;18 项目（坦克大战）" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%A8%8B%E5%BA%8F/" rel="tag">程序</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/01/12/19%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          &lt;Java&gt;19 网络编程
        
      </div>
    </a>
  
  
    <a href="/2022/01/06/17%20IO%E6%B5%81/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">&lt;Java&gt;17 IO流</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%AE%E5%BD%95/" rel="tag">目录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A8%8B%E5%BA%8F/" rel="tag">程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/%E7%9B%AE%E5%BD%95/" style="font-size: 10px;">目录</a> <a href="/tags/%E7%A8%8B%E5%BA%8F/" style="font-size: 15px;">程序</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 20px;">笔记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/10/16/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/">&lt;Java&gt;26 算法入门</a>
          </li>
        
          <li>
            <a href="/2022/06/02/14%20%E6%A0%91/">&lt;Java&gt;14 树</a>
          </li>
        
          <li>
            <a href="/2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">&lt;Java&gt;13 Java 数据结构</a>
          </li>
        
          <li>
            <a href="/2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/">&lt;Java&gt;15 图形界面设计</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>