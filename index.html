<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="css/style.css">

  
    
<link rel="stylesheet" href="fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="">Home</a>
        
          <a class="main-nav-link" href="archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-0 目录" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2021/11/20/0%20%E7%9B%AE%E5%BD%95/" class="article-date">
  <time class="dt-published" datetime="2021-11-19T16:00:00.000Z" itemprop="datePublished">2021-11-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2021/11/20/0%20%E7%9B%AE%E5%BD%95/">&lt;Java&gt;目录</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><hr>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fh411y7R8?share_source=copy_web">Java 入门教学（韩顺平）</a></p>
<h2 id="1-Java-概述"><a href="#1-Java-概述" class="headerlink" title="1 Java 概述"></a>1 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">Java 概述</a></h2><ul>
<li><h3 id="1-1-Java-历史"><a href="#1-1-Java-历史" class="headerlink" title="1.1 Java 历史"></a>1.1 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-1-Java-%E5%8E%86%E5%8F%B2">Java 历史</a></h3></li>
<li><h3 id="1-2-Java-重要特点"><a href="#1-2-Java-重要特点" class="headerlink" title="1.2 Java 重要特点"></a>1.2 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-2-Java-%E9%87%8D%E8%A6%81%E7%89%B9%E7%82%B9">Java 重要特点</a></h3></li>
<li><h3 id="1-3-Java-的开发工具"><a href="#1-3-Java-的开发工具" class="headerlink" title="1.3 Java 的开发工具"></a>1.3 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-3-Java-%E7%9A%84%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7">Java 的开发工具</a></h3></li>
<li><h3 id="1-4-Java-运行基础"><a href="#1-4-Java-运行基础" class="headerlink" title="1.4 Java 运行基础"></a>1.4 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-4-Java-%E8%BF%90%E8%A1%8C%E5%9F%BA%E7%A1%80">Java 运行基础</a></h3></li>
<li><h3 id="1-5-Java-执行流程分析"><a href="#1-5-Java-执行流程分析" class="headerlink" title="1.5 Java 执行流程分析"></a>1.5 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-5-Java-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90">Java 执行流程分析</a></h3><ul>
<li><h4 id="1-5-1-编译"><a href="#1-5-1-编译" class="headerlink" title="1.5.1 编译"></a>1.5.1 编译</h4></li>
<li><h4 id="1-5-2-运行"><a href="#1-5-2-运行" class="headerlink" title="1.5.2 运行"></a>1.5.2 运行</h4></li>
</ul>
</li>
<li><h3 id="1-6-Java-开发注意事项和细节说明"><a href="#1-6-Java-开发注意事项和细节说明" class="headerlink" title="1.6 Java 开发注意事项和细节说明"></a>1.6 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-6-Java-%E5%BC%80%E5%8F%91%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E7%BB%86%E8%8A%82%E8%AF%B4%E6%98%8E">Java 开发注意事项和细节说明</a></h3></li>
<li><h3 id="1-7-代码规范"><a href="#1-7-代码规范" class="headerlink" title="1.7 代码规范"></a>1.7 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-7-%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83">代码规范</a></h3></li>
<li><h3 id="1-8-Java-转义字符"><a href="#1-8-Java-转义字符" class="headerlink" title="1.8 Java 转义字符"></a>1.8 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-8-Java-%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6">Java 转义字符</a></h3></li>
<li><h3 id="1-9-注释"><a href="#1-9-注释" class="headerlink" title="1.9 注释"></a>1.9 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-9-%E6%B3%A8%E9%87%8A">注释</a></h3><ul>
<li><h4 id="1-9-1-注释类型"><a href="#1-9-1-注释类型" class="headerlink" title="1.9.1 注释类型"></a>1.9.1 注释类型</h4></li>
<li><h4 id="1-9-2-文档注释"><a href="#1-9-2-文档注释" class="headerlink" title="1.9.2 文档注释"></a>1.9.2 文档注释</h4></li>
</ul>
</li>
<li><h3 id="1-10-JShell"><a href="#1-10-JShell" class="headerlink" title="1.10 JShell"></a>1.10 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-10-JShell">JShell</a></h3></li>
<li><h3 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h3><h3 id="如何快速学习技术和知识点"><a href="#如何快速学习技术和知识点" class="headerlink" title="如何快速学习技术和知识点"></a><a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E5%AD%A6%E4%B9%A0%E6%8A%80%E6%9C%AF%E5%92%8C%E7%9F%A5%E8%AF%86%E7%82%B9">如何快速学习技术和知识点</a></h3><h3 id="DOS"><a href="#DOS" class="headerlink" title="DOS"></a><a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#DOS%EF%BC%88%E5%8F%AA%E8%A6%81%E4%BA%86%E8%A7%A3%EF%BC%89">DOS</a></h3></li>
</ul>
<hr>
<h2 id="2-变量"><a href="#2-变量" class="headerlink" title="2 变量"></a>2 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/">变量</a></h2><ul>
<li><h3 id="2-1-变量使用注意事项"><a href="#2-1-变量使用注意事项" class="headerlink" title="2.1 变量使用注意事项"></a>2.1 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-1-%E5%8F%98%E9%87%8F%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">变量使用注意事项</a></h3></li>
<li><h3 id="2-2-程序中-的使用"><a href="#2-2-程序中-的使用" class="headerlink" title="2.2 程序中 + 的使用"></a>2.2 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-2-%E7%A8%8B%E5%BA%8F%E4%B8%AD-%E7%9A%84%E4%BD%BF%E7%94%A8">程序中 <code>+</code> 的使用</a></h3></li>
<li><h3 id="2-3-Java-数据类型"><a href="#2-3-Java-数据类型" class="headerlink" title="2.3 Java 数据类型"></a>2.3 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-3-Java-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">Java 数据类型</a></h3></li>
<li><h3 id="2-4-整数类型"><a href="#2-4-整数类型" class="headerlink" title="2.4 整数类型"></a>2.4 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-4-%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B">整数类型</a></h3></li>
<li><h3 id="2-5-浮点类型"><a href="#2-5-浮点类型" class="headerlink" title="2.5 浮点类型"></a>2.5 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-5-%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B">浮点类型</a></h3><ul>
<li><h4 id="2-5-1-使用细节"><a href="#2-5-1-使用细节" class="headerlink" title="2.5.1 使用细节"></a>2.5.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="2-6-字符类型"><a href="#2-6-字符类型" class="headerlink" title="2.6 字符类型"></a>2.6 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-6-%E5%AD%97%E7%AC%A6%E7%B1%BB%E5%9E%8B">字符类型</a></h3><ul>
<li><h4 id="2-6-1-使用细节"><a href="#2-6-1-使用细节" class="headerlink" title="2.6.1 使用细节"></a>2.6.1 使用细节</h4></li>
<li><h4 id="2-6-2-字符本质与编码表"><a href="#2-6-2-字符本质与编码表" class="headerlink" title="2.6.2 字符本质与编码表"></a>2.6.2 字符本质与编码表</h4></li>
</ul>
</li>
<li><h3 id="2-7-布尔类型"><a href="#2-7-布尔类型" class="headerlink" title="2.7 布尔类型"></a>2.7 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-7-%E5%B8%83%E5%B0%94%E7%B1%BB%E5%9E%8B">布尔类型</a></h3></li>
<li><h3 id="2-8-基本数据类型转换"><a href="#2-8-基本数据类型转换" class="headerlink" title="2.8 基本数据类型转换"></a>2.8 <a href="2021/11/22/2%20%E5%8F%98%E9%87%8F/#2-8-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2">基本数据类型转换</a></h3><ul>
<li><h4 id="2-8-1-自动类型转换"><a href="#2-8-1-自动类型转换" class="headerlink" title="2.8.1 自动类型转换"></a>2.8.1 自动类型转换</h4></li>
<li><h4 id="2-8-2-强制类型转换"><a href="#2-8-2-强制类型转换" class="headerlink" title="2.8.2 强制类型转换"></a>2.8.2 强制类型转换</h4><ul>
<li><h5 id="2-8-2-1-使用细节"><a href="#2-8-2-1-使用细节" class="headerlink" title="2.8.2.1 使用细节"></a>2.8.2.1 使用细节</h5></li>
</ul>
</li>
<li><h4 id="2-8-3-基本数据类型和-String-的转换"><a href="#2-8-3-基本数据类型和-String-的转换" class="headerlink" title="2.8.3 基本数据类型和 String 的转换"></a>2.8.3 基本数据类型和 String 的转换</h4><ul>
<li><h5 id="2-8-3-1-使用细节"><a href="#2-8-3-1-使用细节" class="headerlink" title="2.8.3.1 使用细节"></a>2.8.3.1 使用细节</h5></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="3-运算符"><a href="#3-运算符" class="headerlink" title="3 运算符"></a>3 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/">运算符</a></h2><ul>
<li><h3 id="3-1-算术运算符"><a href="#3-1-算术运算符" class="headerlink" title="3.1 算术运算符"></a>3.1 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-1-%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97%E7%AC%A6">算术运算符</a></h3></li>
<li><h3 id="3-2-关系运算符（比较运算符）"><a href="#3-2-关系运算符（比较运算符）" class="headerlink" title="3.2 关系运算符（比较运算符）"></a>3.2 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-2-%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%88%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%89">关系运算符（比较运算符）</a></h3><ul>
<li><h4 id="3-2-1-使用细节"><a href="#3-2-1-使用细节" class="headerlink" title="3.2.1 使用细节"></a>3.2.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="3-3-逻辑运算符"><a href="#3-3-逻辑运算符" class="headerlink" title="3.3 逻辑运算符"></a>3.3 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-3-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6">逻辑运算符</a></h3></li>
<li><h3 id="3-4-赋值运算符"><a href="#3-4-赋值运算符" class="headerlink" title="3.4 赋值运算符"></a>3.4 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-4-%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6">赋值运算符</a></h3><ul>
<li><h4 id="3-4-1-使用细节"><a href="#3-4-1-使用细节" class="headerlink" title="3.4.1 使用细节"></a>3.4.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="3-5-三元运算符"><a href="#3-5-三元运算符" class="headerlink" title="3.5 三元运算符"></a>3.5 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-5-%E4%B8%89%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6">三元运算符</a></h3><ul>
<li><h4 id="3-5-1-使用细节"><a href="#3-5-1-使用细节" class="headerlink" title="3.5.1 使用细节"></a>3.5.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="3-6-运算符优先级"><a href="#3-6-运算符优先级" class="headerlink" title="3.6 运算符优先级"></a>3.6 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-6-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7">运算符优先级</a></h3></li>
<li><h3 id="3-7-标识符"><a href="#3-7-标识符" class="headerlink" title="3.7 标识符"></a>3.7 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-7-%E6%A0%87%E8%AF%86%E7%AC%A6">标识符</a></h3><ul>
<li><h4 id="3-7-1-命名规则"><a href="#3-7-1-命名规则" class="headerlink" title="3.7.1 命名规则"></a>3.7.1 命名规则</h4></li>
<li><h4 id="3-7-2-命名规范"><a href="#3-7-2-命名规范" class="headerlink" title="3.7.2 命名规范"></a>3.7.2 命名规范</h4></li>
</ul>
</li>
<li><h3 id="3-8-输入与输出"><a href="#3-8-输入与输出" class="headerlink" title="3.8 输入与输出"></a>3.8 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-8-%E8%BE%93%E5%85%A5%E4%B8%8E%E8%BE%93%E5%87%BA">输入与输出</a></h3><ul>
<li><h4 id="3-8-1-Scanner-类"><a href="#3-8-1-Scanner-类" class="headerlink" title="3.8.1 Scanner 类"></a>3.8.1 Scanner 类</h4></li>
<li><h4 id="3-8-2-格式化输出"><a href="#3-8-2-格式化输出" class="headerlink" title="3.8.2 格式化输出"></a>3.8.2 格式化输出</h4></li>
<li><h4 id="3-8-3-NumberFormat-类"><a href="#3-8-3-NumberFormat-类" class="headerlink" title="3.8.3 NumberFormat 类"></a>3.8.3 NumberFormat 类</h4></li>
<li><h4 id="3-8-4-DecimalFormat-类"><a href="#3-8-4-DecimalFormat-类" class="headerlink" title="3.8.4 DecimalFormat 类"></a>3.8.4 DecimalFormat 类</h4></li>
</ul>
</li>
<li><h3 id="3-9-进制"><a href="#3-9-进制" class="headerlink" title="3.9 进制"></a>3.9 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-9-%E8%BF%9B%E5%88%B6">进制</a></h3><ul>
<li><h4 id="3-9-1-进制的转换"><a href="#3-9-1-进制的转换" class="headerlink" title="3.9.1 进制的转换"></a>3.9.1 进制的转换</h4></li>
<li><h4 id="3-9-2-原码、反码、补码"><a href="#3-9-2-原码、反码、补码" class="headerlink" title="3.9.2 原码、反码、补码"></a>3.9.2 原码、反码、补码</h4></li>
</ul>
</li>
<li><h3 id="3-10-位运算符"><a href="#3-10-位运算符" class="headerlink" title="3.10 位运算符"></a>3.10 <a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#3-10-%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6">位运算符</a></h3></li>
<li><h3 id="附录-1"><a href="#附录-1" class="headerlink" title="附录"></a>附录</h3><h3 id="Java-API-文档"><a href="#Java-API-文档" class="headerlink" title="Java API 文档"></a><a href="2021/11/23/3%20%E8%BF%90%E7%AE%97%E7%AC%A6/#Java-API-%E6%96%87%E6%A1%A3">Java API 文档</a></h3></li>
</ul>
<hr>
<h2 id="4-程序控制结构"><a href="#4-程序控制结构" class="headerlink" title="4 程序控制结构"></a>4 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/">程序控制结构</a></h2><ul>
<li><h3 id="4-1-顺序控制"><a href="#4-1-顺序控制" class="headerlink" title="4.1 顺序控制"></a>4.1 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-1-%E9%A1%BA%E5%BA%8F%E6%8E%A7%E5%88%B6">顺序控制</a></h3></li>
<li><h3 id="4-2-if-else-分支控制"><a href="#4-2-if-else-分支控制" class="headerlink" title="4.2 if - else 分支控制"></a>4.2 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-2-%E5%88%86%E6%94%AF%E6%8E%A7%E5%88%B6-if-else">if - else 分支控制</a></h3><ul>
<li><h4 id="4-2-1-单分支控制"><a href="#4-2-1-单分支控制" class="headerlink" title="4.2.1 单分支控制"></a>4.2.1 单分支控制</h4></li>
<li><h4 id="4-2-2-双分支控制"><a href="#4-2-2-双分支控制" class="headerlink" title="4.2.2 双分支控制"></a>4.2.2 双分支控制</h4></li>
<li><h4 id="4-2-3-多分支控制"><a href="#4-2-3-多分支控制" class="headerlink" title="4.2.3 多分支控制"></a>4.2.3 多分支控制</h4></li>
<li><h4 id="4-2-4-嵌套分支"><a href="#4-2-4-嵌套分支" class="headerlink" title="4.2.4 嵌套分支"></a>4.2.4 嵌套分支</h4></li>
</ul>
</li>
<li><h3 id="4-3-switch-分支控制"><a href="#4-3-switch-分支控制" class="headerlink" title="4.3 switch 分支控制"></a>4.3 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-3-switch-%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84">switch 分支控制</a></h3><ul>
<li><h4 id="4-3-1-使用细节"><a href="#4-3-1-使用细节" class="headerlink" title="4.3.1 使用细节"></a>4.3.1 使用细节</h4></li>
<li><h4 id="4-3-2-与-if-else-分支结构的取舍"><a href="#4-3-2-与-if-else-分支结构的取舍" class="headerlink" title="4.3.2 与 if-else 分支结构的取舍"></a>4.3.2 与 <code>if-else</code> 分支结构的取舍</h4></li>
</ul>
</li>
<li><h3 id="4-4-for-循环控制"><a href="#4-4-for-循环控制" class="headerlink" title="4.4 for 循环控制"></a>4.4 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-4-for-%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6">for 循环控制</a></h3><ul>
<li><h4 id="4-4-1-使用细节"><a href="#4-4-1-使用细节" class="headerlink" title="4.4.1 使用细节"></a>4.4.1 使用细节</h4></li>
<li><h4 id="4-4-2-for-each（增强-for-循环）"><a href="#4-4-2-for-each（增强-for-循环）" class="headerlink" title="4.4.2 for each（增强 for 循环）"></a>4.4.2 for each（增强 for 循环）</h4></li>
</ul>
</li>
<li><h3 id="4-5-while-循环控制"><a href="#4-5-while-循环控制" class="headerlink" title="4.5 while 循环控制"></a>4.5 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-5-while-%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6">while 循环控制</a></h3><ul>
<li><h4 id="4-5-1-使用细节"><a href="#4-5-1-使用细节" class="headerlink" title="4.5.1 使用细节"></a>4.5.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="4-6-do-while-循环控制"><a href="#4-6-do-while-循环控制" class="headerlink" title="4.6 do..while 循环控制"></a>4.6 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-6-do-while-%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6">do..while 循环控制</a></h3><ul>
<li><h4 id="4-6-1-使用细节"><a href="#4-6-1-使用细节" class="headerlink" title="4.6.1 使用细节"></a>4.6.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="4-7-多重循环控制"><a href="#4-7-多重循环控制" class="headerlink" title="4.7 多重循环控制"></a>4.7 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-7-%E5%A4%9A%E9%87%8D%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6">多重循环控制</a></h3></li>
<li><h3 id="4-8-跳转控制语句"><a href="#4-8-跳转控制语句" class="headerlink" title="4.8 跳转控制语句"></a>4.8 <a href="2021/11/24/4%20%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84/#4-8-%E8%B7%B3%E8%BD%AC%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5">跳转控制语句</a></h3><ul>
<li><h4 id="4-8-1-标签"><a href="#4-8-1-标签" class="headerlink" title="4.8.1 标签"></a>4.8.1 标签</h4></li>
<li><h4 id="4-8-2-break"><a href="#4-8-2-break" class="headerlink" title="4.8.2 break"></a>4.8.2 break</h4></li>
<li><h4 id="4-8-3-continue"><a href="#4-8-3-continue" class="headerlink" title="4.8.3 continue"></a>4.8.3 continue</h4></li>
<li><h4 id="4-8-4-return"><a href="#4-8-4-return" class="headerlink" title="4.8.4 return"></a>4.8.4 return</h4></li>
</ul>
</li>
</ul>
<hr>
<h2 id="5-数组、排序和查找"><a href="#5-数组、排序和查找" class="headerlink" title="5 数组、排序和查找"></a>5 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/">数组、排序和查找</a></h2><ul>
<li><h3 id="5-1-一维数组"><a href="#5-1-一维数组" class="headerlink" title="5.1 一维数组"></a>5.1 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-1-%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84">一维数组</a></h3><ul>
<li><h4 id="5-1-1-数组赋值机制"><a href="#5-1-1-数组赋值机制" class="headerlink" title="5.1.1 数组赋值机制"></a>5.1.1 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-1-1-%E6%95%B0%E7%BB%84%E8%B5%8B%E5%80%BC%E6%9C%BA%E5%88%B6">数组赋值机制</a></h4></li>
<li><h4 id="5-1-2-数组的扩容"><a href="#5-1-2-数组的扩容" class="headerlink" title="5.1.2 数组的扩容"></a>5.1.2 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-1-2-%E6%95%B0%E7%BB%84%E7%9A%84%E6%89%A9%E5%AE%B9">数组的扩容</a></h4></li>
</ul>
</li>
<li><h3 id="5-2-二维数组"><a href="#5-2-二维数组" class="headerlink" title="5.2 二维数组"></a>5.2 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-2-%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84">二维数组</a></h3></li>
<li><h3 id="5-3-查找算法"><a href="#5-3-查找算法" class="headerlink" title="5.3 查找算法"></a>5.3 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-3-%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95">查找算法</a></h3><ul>
<li><h4 id="5-3-1-线性查找"><a href="#5-3-1-线性查找" class="headerlink" title="5.3.1 线性查找"></a>5.3.1 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-3-1-%E7%BA%BF%E6%80%A7%E6%9F%A5%E6%89%BE">线性查找</a></h4></li>
<li><h4 id="5-3-2-二分查找"><a href="#5-3-2-二分查找" class="headerlink" title="5.3.2 二分查找"></a>5.3.2 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-3-2-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE">二分查找</a></h4></li>
<li><h4 id="5-3-3-插值查找"><a href="#5-3-3-插值查找" class="headerlink" title="5.3.3 插值查找"></a>5.3.3 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-3-3-%E6%8F%92%E5%80%BC%E6%9F%A5%E6%89%BE">插值查找</a></h4></li>
<li><h4 id="5-3-4-斐波那契查找"><a href="#5-3-4-斐波那契查找" class="headerlink" title="5.3.4 斐波那契查找"></a>5.3.4 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-3-4-%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%9F%A5%E6%89%BE">斐波那契查找</a></h4></li>
</ul>
</li>
<li><h3 id="5-4-排序算法"><a href="#5-4-排序算法" class="headerlink" title="5.4 排序算法"></a>5.4 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95">排序算法</a></h3><ul>
<li><h4 id="5-4-1-冒泡排序"><a href="#5-4-1-冒泡排序" class="headerlink" title="5.4.1 冒泡排序"></a>5.4.1 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-1-%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F">冒泡排序</a></h4></li>
<li><h4 id="5-4-2-选择排序"><a href="#5-4-2-选择排序" class="headerlink" title="5.4.2 选择排序"></a>5.4.2 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-2-%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F">选择排序</a></h4></li>
<li><h4 id="5-4-3-插入排序"><a href="#5-4-3-插入排序" class="headerlink" title="5.4.3 插入排序"></a>5.4.3 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-3-%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F">插入排序</a></h4></li>
<li><h4 id="5-4-4-希尔排序"><a href="#5-4-4-希尔排序" class="headerlink" title="5.4.4 希尔排序"></a>5.4.4 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-4-%E5%B8%8C%E5%84%BF%E6%8E%92%E5%BA%8F">希尔排序</a></h4></li>
<li><h4 id="5-4-5-快速排序"><a href="#5-4-5-快速排序" class="headerlink" title="5.4.5 快速排序"></a>5.4.5 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-5-%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F">快速排序</a></h4></li>
<li><h4 id="5-4-6-归并排序"><a href="#5-4-6-归并排序" class="headerlink" title="5.4.6 归并排序"></a>5.4.6 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-6-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F">归并排序</a></h4></li>
<li><h4 id="5-4-7-基数排序"><a href="#5-4-7-基数排序" class="headerlink" title="5.4.7 基数排序"></a>5.4.7 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-7-%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F">基数排序</a></h4></li>
<li><h4 id="5-4-8-堆排序"><a href="#5-4-8-堆排序" class="headerlink" title="5.4.8 堆排序"></a>5.4.8 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-8-%E5%A0%86%E6%8E%92%E5%BA%8F">堆排序</a></h4></li>
</ul>
</li>
</ul>
<hr>
<h2 id="6-面向对象编程（基础）"><a href="#6-面向对象编程（基础）" class="headerlink" title="6 面向对象编程（基础）"></a>6 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/">面向对象编程（基础）</a></h2><ul>
<li><h3 id="6-1-类与对象（OOP）"><a href="#6-1-类与对象（OOP）" class="headerlink" title="6.1 类与对象（OOP）"></a>6.1 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-1-%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1%EF%BC%88OOP%EF%BC%89">类与对象（OOP）</a></h3><ul>
<li><h4 id="6-1-1-属性-x2F-成员变量"><a href="#6-1-1-属性-x2F-成员变量" class="headerlink" title="6.1.1 属性&#x2F;成员变量"></a>6.1.1 属性&#x2F;成员变量</h4></li>
<li><h4 id="6-1-2-创建对象"><a href="#6-1-2-创建对象" class="headerlink" title="6.1.2 创建对象"></a>6.1.2 创建对象</h4></li>
<li><h4 id="6-1-3-类与对象的内存访问机制"><a href="#6-1-3-类与对象的内存访问机制" class="headerlink" title="6.1.3 类与对象的内存访问机制"></a>6.1.3 类与对象的内存访问机制</h4></li>
</ul>
</li>
<li><h3 id="6-2-成员方法"><a href="#6-2-成员方法" class="headerlink" title="6.2 成员方法"></a>6.2 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-2-%E6%88%90%E5%91%98%E6%96%B9%E6%B3%95">成员方法</a></h3><ul>
<li><h4 id="6-2-1-方法的调用机制"><a href="#6-2-1-方法的调用机制" class="headerlink" title="6.2.1 方法的调用机制"></a>6.2.1 方法的调用机制</h4></li>
<li><h4 id="6-2-2-使用细节"><a href="#6-2-2-使用细节" class="headerlink" title="6.2.2 使用细节"></a>6.2.2 使用细节</h4></li>
<li><h4 id="6-2-3-成员方法传参机制"><a href="#6-2-3-成员方法传参机制" class="headerlink" title="6.2.3 成员方法传参机制"></a>6.2.3 成员方法传参机制</h4></li>
</ul>
</li>
<li><h3 id="6-3-方法递归调用"><a href="#6-3-方法递归调用" class="headerlink" title="6.3 方法递归调用"></a>6.3 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-3-%E6%96%B9%E6%B3%95%E9%80%92%E5%BD%92%E8%B0%83%E7%94%A8">方法递归调用</a></h3><ul>
<li><h4 id="6-3-1-使用细节"><a href="#6-3-1-使用细节" class="headerlink" title="6.3.1 使用细节"></a>6.3.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="6-4-方法重载"><a href="#6-4-方法重载" class="headerlink" title="6.4 方法重载"></a>6.4 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-4-%E6%96%B9%E6%B3%95%E9%87%8D%E8%BD%BD">方法重载</a></h3></li>
<li><h3 id="6-5-可变参数"><a href="#6-5-可变参数" class="headerlink" title="6.5 可变参数"></a>6.5 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-5-%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0">可变参数</a></h3><ul>
<li><h4 id="6-5-1-使用细节"><a href="#6-5-1-使用细节" class="headerlink" title="6.5.1 使用细节"></a>6.5.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="6-6-作用域"><a href="#6-6-作用域" class="headerlink" title="6.6 作用域"></a>6.6 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-6-%E4%BD%9C%E7%94%A8%E5%9F%9F%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89">作用域</a></h3><ul>
<li><h4 id="6-6-1-使用细节"><a href="#6-6-1-使用细节" class="headerlink" title="6.6.1 使用细节"></a>6.6.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="6-7-构造方法、构造器"><a href="#6-7-构造方法、构造器" class="headerlink" title="6.7 构造方法、构造器"></a>6.7 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-7-%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E3%80%81%E6%9E%84%E9%80%A0%E5%99%A8">构造方法、构造器</a></h3><ul>
<li><h4 id="6-7-1-使用细节"><a href="#6-7-1-使用细节" class="headerlink" title="6.7.1 使用细节"></a>6.7.1 使用细节</h4></li>
<li><h4 id="6-7-2-流程分析"><a href="#6-7-2-流程分析" class="headerlink" title="6.7.2 流程分析"></a>6.7.2 流程分析</h4></li>
</ul>
</li>
<li><h3 id="6-8-this-关键字"><a href="#6-8-this-关键字" class="headerlink" title="6.8 this 关键字"></a>6.8 <a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#6-8-this-%E5%85%B3%E9%94%AE%E5%AD%97">this 关键字</a></h3><ul>
<li><h4 id="6-8-1-使用方法"><a href="#6-8-1-使用方法" class="headerlink" title="6.8.1 使用方法"></a>6.8.1 使用方法</h4></li>
</ul>
</li>
<li><h3 id="附录-2"><a href="#附录-2" class="headerlink" title="附录"></a>附录</h3><h3 id="迷宫游戏代码"><a href="#迷宫游戏代码" class="headerlink" title="迷宫游戏代码"></a><a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#%E8%BF%B7%E5%AE%AB%E6%B8%B8%E6%88%8F%E4%BB%A3%E7%A0%81">迷宫游戏代码</a></h3><h3 id="八皇后代码"><a href="#八皇后代码" class="headerlink" title="八皇后代码"></a><a href="2021/11/29/6%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E5%9F%BA%E7%A1%80%EF%BC%89/#%E5%85%AB%E7%9A%87%E5%90%8E%E4%BB%A3%E7%A0%81">八皇后代码</a></h3></li>
</ul>
<hr>
<h2 id="7-面向对象编程（中级）"><a href="#7-面向对象编程（中级）" class="headerlink" title="7 面向对象编程（中级）"></a>7 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/">面向对象编程（中级）</a></h2><ul>
<li><h3 id="7-1-IDEA-的使用"><a href="#7-1-IDEA-的使用" class="headerlink" title="7.1 IDEA 的使用"></a>7.1 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-1-IDEA-%E7%9A%84%E4%BD%BF%E7%94%A8">IDEA 的使用</a></h3><ul>
<li><h4 id="7-1-1-常用快捷键"><a href="#7-1-1-常用快捷键" class="headerlink" title="7.1.1 常用快捷键"></a>7.1.1 常用快捷键</h4></li>
<li><h4 id="7-1-2-模板快捷键"><a href="#7-1-2-模板快捷键" class="headerlink" title="7.1.2 模板快捷键"></a>7.1.2 模板快捷键</h4></li>
</ul>
</li>
<li><h3 id="7-2-包"><a href="#7-2-包" class="headerlink" title="7.2 包"></a>7.2 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-2-%E5%8C%85">包</a></h3></li>
<li><h3 id="7-3-访问修饰符"><a href="#7-3-访问修饰符" class="headerlink" title="7.3 访问修饰符"></a>7.3 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-3-%E8%AE%BF%E9%97%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6">访问修饰符</a></h3><ul>
<li><h4 id="7-3-1-访问权限特点"><a href="#7-3-1-访问权限特点" class="headerlink" title="7.3.1 访问权限特点"></a>7.3.1 访问权限特点</h4></li>
<li><h4 id="7-3-2-使用说明"><a href="#7-3-2-使用说明" class="headerlink" title="7.3.2 使用说明"></a>7.3.2 使用说明</h4></li>
</ul>
</li>
<li><h3 id="7-4-封装"><a href="#7-4-封装" class="headerlink" title="7.4 封装"></a>7.4 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-4-%E5%B0%81%E8%A3%85%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89">封装</a></h3><ul>
<li><h4 id="7-4-1-静态导入"><a href="#7-4-1-静态导入" class="headerlink" title="7.4.1 静态导入"></a>7.4.1 静态导入</h4></li>
<li><h4 id="7-4-2-JAR-文件"><a href="#7-4-2-JAR-文件" class="headerlink" title="7.4.2 JAR 文件"></a>7.4.2 JAR 文件</h4></li>
</ul>
</li>
<li><h3 id="7-5-继承"><a href="#7-5-继承" class="headerlink" title="7.5 继承"></a>7.5 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-5-%E7%BB%A7%E6%89%BF%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89">继承</a></h3><ul>
<li><h4 id="7-5-1-使用细节"><a href="#7-5-1-使用细节" class="headerlink" title="7.5.1 使用细节"></a>7.5.1 使用细节</h4></li>
<li><h4 id="7-5-2-继承的本质"><a href="#7-5-2-继承的本质" class="headerlink" title="7.5.2 继承的本质"></a>7.5.2 继承的本质</h4></li>
<li><h4 id="7-5-3-super-关键字"><a href="#7-5-3-super-关键字" class="headerlink" title="7.5.3 super 关键字"></a>7.5.3 <code>super</code> 关键字</h4></li>
<li><h4 id="7-5-4-方法重写-x2F-覆盖"><a href="#7-5-4-方法重写-x2F-覆盖" class="headerlink" title="7.5.4 方法重写&#x2F;覆盖"></a>7.5.4 方法重写&#x2F;覆盖</h4></li>
</ul>
</li>
<li><h3 id="7-6-多态"><a href="#7-6-多态" class="headerlink" title="7.6 多态"></a>7.6 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-6-%E5%A4%9A%E6%80%81%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89">多态</a></h3><ul>
<li><h4 id="7-6-1-多态的体现"><a href="#7-6-1-多态的体现" class="headerlink" title="7.6.1 多态的体现"></a>7.6.1 多态的体现</h4></li>
<li><h4 id="7-6-2-使用细节"><a href="#7-6-2-使用细节" class="headerlink" title="7.6.2 使用细节"></a>7.6.2 使用细节</h4></li>
<li><h4 id="7-6-3-理解方法调用"><a href="#7-6-3-理解方法调用" class="headerlink" title="7.6.3 理解方法调用"></a>7.6.3 理解方法调用</h4></li>
</ul>
</li>
<li><h3 id="7-7-Object-类"><a href="#7-7-Object-类" class="headerlink" title="7.7 Object 类"></a>7.7 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-7-Object-%E7%B1%BB">Object 类</a></h3><ul>
<li><h4 id="7-7-1-equals-方法"><a href="#7-7-1-equals-方法" class="headerlink" title="7.7.1 equals 方法"></a>7.7.1 equals 方法</h4></li>
<li><h4 id="7-7-2-hashCode-方法"><a href="#7-7-2-hashCode-方法" class="headerlink" title="7.7.2 hashCode 方法"></a>7.7.2 hashCode 方法</h4></li>
<li><h4 id="7-7-3-toString-方法"><a href="#7-7-3-toString-方法" class="headerlink" title="7.7.3 toString 方法"></a>7.7.3 toString 方法</h4></li>
<li><h4 id="7-7-4-finalize-方法"><a href="#7-7-4-finalize-方法" class="headerlink" title="7.7.4 finalize 方法"></a>7.7.4 finalize 方法</h4></li>
</ul>
</li>
<li><h3 id="7-8-断点调试（Debug）"><a href="#7-8-断点调试（Debug）" class="headerlink" title="7.8 断点调试（Debug）"></a>7.8 <a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#7-8-%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%EF%BC%88Debug%EF%BC%89">断点调试（Debug）</a></h3></li>
<li><h3 id="附录-3"><a href="#附录-3" class="headerlink" title="附录"></a>附录</h3><h3 id="零钱通程序"><a href="#零钱通程序" class="headerlink" title="零钱通程序"></a><a href="2021/12/05/7%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E4%B8%AD%E7%BA%A7%EF%BC%89/#%E9%9B%B6%E9%92%B1%E9%80%9A%E7%A8%8B%E5%BA%8F">零钱通程序</a></h3></li>
</ul>
<hr>
<h2 id="8-项目：房屋出租系统"><a href="#8-项目：房屋出租系统" class="headerlink" title="8 项目：房屋出租系统"></a>8 <a href="2021/12/13/8%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E6%88%BF%E5%B1%8B%E5%87%BA%E7%A7%9F%E7%B3%BB%E7%BB%9F/">项目：房屋出租系统</a></h2><p>2021.12.13  20:12			第一阶段完成</p>
<hr>
<h2 id="9-面向对象编程（高级）"><a href="#9-面向对象编程（高级）" class="headerlink" title="9 面向对象编程（高级）"></a>9 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/">面向对象编程（高级）</a></h2><ul>
<li><h3 id="9-1-类变量和类方法"><a href="#9-1-类变量和类方法" class="headerlink" title="9.1 类变量和类方法"></a>9.1 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-1-%E7%B1%BB%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E6%96%B9%E6%B3%95">类变量和类方法</a></h3><ul>
<li><h4 id="9-1-1-类变量"><a href="#9-1-1-类变量" class="headerlink" title="9.1.1 类变量"></a>9.1.1 类变量</h4></li>
<li><h4 id="9-1-2-类方法"><a href="#9-1-2-类方法" class="headerlink" title="9.1.2 类方法"></a>9.1.2 类方法</h4></li>
</ul>
</li>
<li><h3 id="9-2-理解-main-方法语法"><a href="#9-2-理解-main-方法语法" class="headerlink" title="9.2 理解 main 方法语法"></a>9.2 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-2-%E7%90%86%E8%A7%A3-main-%E6%96%B9%E6%B3%95%E8%AF%AD%E6%B3%95">理解 <code>main</code> 方法语法</a></h3></li>
<li><h3 id="9-3-代码块"><a href="#9-3-代码块" class="headerlink" title="9.3 代码块"></a>9.3 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-3-%E4%BB%A3%E7%A0%81%E5%9D%97">代码块</a></h3><ul>
<li><h4 id="9-3-1-使用细节"><a href="#9-3-1-使用细节" class="headerlink" title="9.3.1 使用细节"></a>9.3.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="9-4-单例设计模式"><a href="#9-4-单例设计模式" class="headerlink" title="9.4 单例设计模式"></a>9.4 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-4-%E5%8D%95%E4%BE%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F">单例设计模式</a></h3><ul>
<li><h4 id="9-4-1-应用实例"><a href="#9-4-1-应用实例" class="headerlink" title="9.4.1 应用实例"></a>9.4.1 应用实例</h4><ul>
<li><h5 id="9-4-1-1-饿汉式"><a href="#9-4-1-1-饿汉式" class="headerlink" title="9.4.1.1 饿汉式"></a>9.4.1.1 饿汉式</h5></li>
<li><h5 id="9-4-1-2-懒汉式"><a href="#9-4-1-2-懒汉式" class="headerlink" title="9.4.1.2 懒汉式"></a>9.4.1.2 懒汉式</h5></li>
<li><h5 id="9-4-1-3-两种方法对比"><a href="#9-4-1-3-两种方法对比" class="headerlink" title="9.4.1.3 两种方法对比"></a>9.4.1.3 两种方法对比</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="9-5-final-关键字"><a href="#9-5-final-关键字" class="headerlink" title="9.5 final 关键字"></a>9.5 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-5-final-%E5%85%B3%E9%94%AE%E5%AD%97"><code>final</code> 关键字</a></h3><ul>
<li><h4 id="9-5-1-使用细节"><a href="#9-5-1-使用细节" class="headerlink" title="9.5.1 使用细节"></a>9.5.1 使用细节</h4></li>
</ul>
</li>
<li><h3 id="9-6-抽象类"><a href="#9-6-抽象类" class="headerlink" title="9.6 抽象类"></a>9.6 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-6-%E6%8A%BD%E8%B1%A1%E7%B1%BB">抽象类</a></h3><ul>
<li><h4 id="9-6-1-使用细节"><a href="#9-6-1-使用细节" class="headerlink" title="9.6.1 使用细节"></a>9.6.1 使用细节</h4></li>
<li><h4 id="9-6-2-模板设计模式"><a href="#9-6-2-模板设计模式" class="headerlink" title="9.6.2 模板设计模式"></a>9.6.2 模板设计模式</h4></li>
</ul>
</li>
<li><h3 id="9-7-接口"><a href="#9-7-接口" class="headerlink" title="9.7 接口"></a>9.7 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-7-%E6%8E%A5%E5%8F%A3">接口</a></h3><ul>
<li><h4 id="9-7-1-使用细节"><a href="#9-7-1-使用细节" class="headerlink" title="9.7.1 使用细节"></a>9.7.1 使用细节</h4></li>
<li><h4 id="9-7-2-实现接口-vs-继承类"><a href="#9-7-2-实现接口-vs-继承类" class="headerlink" title="9.7.2 实现接口 vs 继承类"></a>9.7.2 实现接口 vs 继承类</h4></li>
<li><h4 id="9-7-3-接口的多态特性"><a href="#9-7-3-接口的多态特性" class="headerlink" title="9.7.3 接口的多态特性"></a>9.7.3 接口的多态特性</h4></li>
</ul>
</li>
<li><h3 id="9-8-内部类"><a href="#9-8-内部类" class="headerlink" title="9.8 内部类"></a>9.8 <a href="2021/12/14/9%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%88%E9%AB%98%E7%BA%A7%EF%BC%89/#9-8-%E5%86%85%E9%83%A8%E7%B1%BB%EF%BC%88%E9%87%8D%E9%9A%BE%E7%82%B9%EF%BC%89">内部类</a></h3><ul>
<li><h4 id="9-8-1-四种内部类"><a href="#9-8-1-四种内部类" class="headerlink" title="9.8.1 四种内部类"></a>9.8.1 四种内部类</h4></li>
<li><h4 id="9-8-2-局部内部类"><a href="#9-8-2-局部内部类" class="headerlink" title="9.8.2 局部内部类"></a>9.8.2 局部内部类</h4><ul>
<li><h5 id="9-8-2-1-使用细节"><a href="#9-8-2-1-使用细节" class="headerlink" title="9.8.2.1 使用细节"></a>9.8.2.1 使用细节</h5></li>
</ul>
</li>
<li><h4 id="9-8-3-匿名内部类"><a href="#9-8-3-匿名内部类" class="headerlink" title="9.8.3 匿名内部类"></a>9.8.3 匿名内部类</h4><ul>
<li><h5 id="9-8-3-1-使用细节"><a href="#9-8-3-1-使用细节" class="headerlink" title="9.8.3.1 使用细节"></a>9.8.3.1 使用细节</h5></li>
<li><h5 id="9-8-3-2-使用场景"><a href="#9-8-3-2-使用场景" class="headerlink" title="9.8.3.2 使用场景"></a>9.8.3.2 使用场景</h5></li>
</ul>
</li>
<li><h4 id="9-8-4-成员内部类"><a href="#9-8-4-成员内部类" class="headerlink" title="9.8.4 成员内部类"></a>9.8.4 成员内部类</h4><ul>
<li><h5 id="9-8-4-1-使用细节"><a href="#9-8-4-1-使用细节" class="headerlink" title="9.8.4.1 使用细节"></a>9.8.4.1 使用细节</h5></li>
</ul>
</li>
<li><h4 id="9-8-5-静态内部类"><a href="#9-8-5-静态内部类" class="headerlink" title="9.8.5 静态内部类"></a>9.8.5 静态内部类</h4><ul>
<li><h5 id="9-8-5-1-使用细节"><a href="#9-8-5-1-使用细节" class="headerlink" title="9.8.5.1 使用细节"></a>9.8.5.1 使用细节</h5></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="10-枚举和注解"><a href="#10-枚举和注解" class="headerlink" title="10 枚举和注解"></a>10 <a href="2021/12/17/10%20%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%B3%A8%E8%A7%A3/">枚举和注解</a></h2><ul>
<li><h3 id="10-1-枚举"><a href="#10-1-枚举" class="headerlink" title="10.1 枚举"></a>10.1 <a href="2021/12/17/10%20%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%B3%A8%E8%A7%A3/#10-1-%E6%9E%9A%E4%B8%BE">枚举</a></h3><ul>
<li><h4 id="10-1-1-自定义枚举"><a href="#10-1-1-自定义枚举" class="headerlink" title="10.1.1 自定义枚举"></a>10.1.1 自定义枚举</h4></li>
<li><h4 id="10-1-2-enum-关键字"><a href="#10-1-2-enum-关键字" class="headerlink" title="10.1.2 enum 关键字"></a>10.1.2 enum 关键字</h4><ul>
<li><h5 id="10-1-2-1-使用细节"><a href="#10-1-2-1-使用细节" class="headerlink" title="10.1.2.1 使用细节"></a>10.1.2.1 使用细节</h5></li>
<li><h5 id="10-1-2-2-Enum-类中的常用方法"><a href="#10-1-2-2-Enum-类中的常用方法" class="headerlink" title="10.1.2.2 Enum 类中的常用方法"></a>10.1.2.2 Enum 类中的常用方法</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="10-2-注解"><a href="#10-2-注解" class="headerlink" title="10.2 注解"></a>10.2 <a href="2021/12/17/10%20%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%B3%A8%E8%A7%A3/#10-2-%E6%B3%A8%E8%A7%A3">注解</a></h3><ul>
<li><h4 id="10-2-1-Override"><a href="#10-2-1-Override" class="headerlink" title="10.2.1 @Override"></a>10.2.1 @Override</h4></li>
<li><h4 id="10-2-2-Deprecated"><a href="#10-2-2-Deprecated" class="headerlink" title="10.2.2 @Deprecated"></a>10.2.2 @Deprecated</h4></li>
<li><h4 id="10-2-3-SuppressWarnings"><a href="#10-2-3-SuppressWarnings" class="headerlink" title="10.2.3 @SuppressWarnings()"></a>10.2.3 @SuppressWarnings()</h4></li>
<li><h4 id="10-2-4-JDK-的元注解（了解即可）"><a href="#10-2-4-JDK-的元注解（了解即可）" class="headerlink" title="10.2.4 JDK 的元注解（了解即可）"></a>10.2.4 JDK 的元注解（了解即可）</h4></li>
</ul>
</li>
</ul>
<hr>
<h2 id="11-异常"><a href="#11-异常" class="headerlink" title="11 异常"></a>11 <a href="2021/12/18/11%20%E5%BC%82%E5%B8%B8/">异常</a></h2><ul>
<li><h3 id="11-1-异常体系图"><a href="#11-1-异常体系图" class="headerlink" title="11.1 异常体系图"></a>11.1 <a href="2021/12/18/11%20%E5%BC%82%E5%B8%B8/#11-1-%E5%BC%82%E5%B8%B8%E4%BD%93%E7%B3%BB%E5%9B%BE%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89">异常体系图</a></h3><ul>
<li><h4 id="11-1-1-常见的运行时异常"><a href="#11-1-1-常见的运行时异常" class="headerlink" title="11.1.1 常见的运行时异常"></a>11.1.1 常见的运行时异常</h4></li>
<li><h4 id="11-1-2-常见的编译异常"><a href="#11-1-2-常见的编译异常" class="headerlink" title="11.1.2 常见的编译异常"></a>11.1.2 常见的编译异常</h4></li>
</ul>
</li>
<li><h3 id="11-2-异常处理"><a href="#11-2-异常处理" class="headerlink" title="11.2 异常处理"></a>11.2 <a href="2021/12/18/11%20%E5%BC%82%E5%B8%B8/#11-2-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">异常处理</a></h3><ul>
<li><h4 id="11-2-1-try-catch-异常处理"><a href="#11-2-1-try-catch-异常处理" class="headerlink" title="11.2.1 try - catch 异常处理"></a>11.2.1 try - catch 异常处理</h4><ul>
<li><h5 id="11-2-1-1-使用细节"><a href="#11-2-1-1-使用细节" class="headerlink" title="11.2.1.1 使用细节"></a>11.2.1.1 使用细节</h5></li>
</ul>
</li>
<li><h4 id="11-2-2-throws-异常处理"><a href="#11-2-2-throws-异常处理" class="headerlink" title="11.2.2 throws 异常处理"></a>11.2.2 throws 异常处理</h4><ul>
<li><h5 id="11-2-2-1-使用细节"><a href="#11-2-2-1-使用细节" class="headerlink" title="11.2.2.1 使用细节"></a>11.2.2.1 使用细节</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="11-3-自定义异常"><a href="#11-3-自定义异常" class="headerlink" title="11.3 自定义异常"></a>11.3 <a href="2021/12/18/11%20%E5%BC%82%E5%B8%B8/#11-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8">自定义异常</a></h3><ul>
<li><h4 id="11-3-1-throw-和-throws"><a href="#11-3-1-throw-和-throws" class="headerlink" title="11.3.1 throw 和 throws"></a>11.3.1 throw 和 throws</h4></li>
</ul>
</li>
</ul>
<hr>
<h2 id="12-常用类"><a href="#12-常用类" class="headerlink" title="12 常用类"></a>12 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/">常用类</a></h2><ul>
<li><h3 id="12-1-包装类"><a href="#12-1-包装类" class="headerlink" title="12.1 包装类"></a>12.1 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-1-%E5%8C%85%E8%A3%85%E7%B1%BB">包装类</a></h3><ul>
<li><h4 id="12-1-1-装箱和拆箱"><a href="#12-1-1-装箱和拆箱" class="headerlink" title="12.1.1 装箱和拆箱"></a>12.1.1 装箱和拆箱</h4></li>
<li><h4 id="12-1-2-包装类和-String-的相互转换"><a href="#12-1-2-包装类和-String-的相互转换" class="headerlink" title="12.1.2 包装类和 String 的相互转换"></a>12.1.2 包装类和 String 的相互转换</h4></li>
<li><h4 id="12-1-3-包装类的常用方法"><a href="#12-1-3-包装类的常用方法" class="headerlink" title="12.1.3 包装类的常用方法"></a>12.1.3 包装类的常用方法</h4></li>
<li><h4 id="12-1-4-strictfp-关键字"><a href="#12-1-4-strictfp-关键字" class="headerlink" title="12.1.4 strictfp 关键字"></a>12.1.4 strictfp 关键字</h4></li>
</ul>
</li>
<li><h3 id="12-2-String-类"><a href="#12-2-String-类" class="headerlink" title="12.2 String 类"></a>12.2 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-2-String-%E7%B1%BB">String 类</a></h3><ul>
<li><h4 id="12-2-1-String-构造方法"><a href="#12-2-1-String-构造方法" class="headerlink" title="12.2.1 String 构造方法"></a>12.2.1 String 构造方法</h4></li>
<li><h4 id="12-2-2-字符串的特性"><a href="#12-2-2-字符串的特性" class="headerlink" title="12.2.2 字符串的特性"></a>12.2.2 字符串的特性</h4></li>
<li><h4 id="12-2-3-String-的常用方法"><a href="#12-2-3-String-的常用方法" class="headerlink" title="12.2.3 String 的常用方法"></a>12.2.3 String 的常用方法</h4></li>
</ul>
</li>
<li><h3 id="12-3-StringBuffer-类"><a href="#12-3-StringBuffer-类" class="headerlink" title="12.3 StringBuffer 类"></a>12.3 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-3-StringBuffer-%E7%B1%BB">StringBuffer 类</a></h3><ul>
<li><h4 id="12-3-1-StringBuffer-构造方法"><a href="#12-3-1-StringBuffer-构造方法" class="headerlink" title="12.3.1 StringBuffer 构造方法"></a>12.3.1 StringBuffer 构造方法</h4></li>
<li><h4 id="12-3-2-String-和-StringBuffer-的转换"><a href="#12-3-2-String-和-StringBuffer-的转换" class="headerlink" title="12.3.2 String 和 StringBuffer 的转换"></a>12.3.2 String 和 StringBuffer 的转换</h4></li>
<li><h4 id="12-3-3-StringBuffer-的常用方法"><a href="#12-3-3-StringBuffer-的常用方法" class="headerlink" title="12.3.3  StringBuffer 的常用方法"></a>12.3.3  StringBuffer 的常用方法</h4></li>
</ul>
</li>
<li><h3 id="12-4-StringBuilder-类"><a href="#12-4-StringBuilder-类" class="headerlink" title="12.4 StringBuilder 类"></a>12.4 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-4-StringBuilder-%E7%B1%BB">StringBuilder 类</a></h3><ul>
<li><h4 id="12-4-1-String、StringBuffer、StringBuilder-的对比"><a href="#12-4-1-String、StringBuffer、StringBuilder-的对比" class="headerlink" title="12.4.1 String、StringBuffer、StringBuilder 的对比"></a>12.4.1 String、StringBuffer、StringBuilder 的对比</h4></li>
</ul>
</li>
<li><h3 id="12-5-Math-类"><a href="#12-5-Math-类" class="headerlink" title="12.5 Math 类"></a>12.5 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-5-Math-%E7%B1%BB">Math 类</a></h3></li>
<li><h3 id="12-6-Arrays-类"><a href="#12-6-Arrays-类" class="headerlink" title="12.6 Arrays 类"></a>12.6 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-6-Arrays-%E7%B1%BB">Arrays 类</a></h3></li>
<li><h3 id="12-7-System-类"><a href="#12-7-System-类" class="headerlink" title="12.7 System 类"></a>12.7 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-7-System-%E7%B1%BB">System 类</a></h3></li>
<li><h3 id="12-8-BigInteger-和-BigDecimal-类"><a href="#12-8-BigInteger-和-BigDecimal-类" class="headerlink" title="12.8 BigInteger 和 BigDecimal 类"></a>12.8 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-8-BigInteger-%E5%92%8C-BigDecimal-%E7%B1%BB">BigInteger 和 BigDecimal 类</a></h3></li>
<li><h3 id="12-9-日期类"><a href="#12-9-日期类" class="headerlink" title="12.9 日期类"></a>12.9 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-9-%E6%97%A5%E6%9C%9F%E7%B1%BB">日期类</a></h3><ul>
<li><h4 id="12-9-1-第一代日期类"><a href="#12-9-1-第一代日期类" class="headerlink" title="12.9.1 第一代日期类"></a>12.9.1 第一代日期类</h4></li>
<li><h4 id="12-9-2-第二代日期类"><a href="#12-9-2-第二代日期类" class="headerlink" title="12.9.2 第二代日期类"></a>12.9.2 第二代日期类</h4></li>
<li><h4 id="12-9-3-第三代日期类"><a href="#12-9-3-第三代日期类" class="headerlink" title="12.9.3 第三代日期类"></a>12.9.3 第三代日期类</h4></li>
</ul>
</li>
<li><h3 id="12-10-泛型"><a href="#12-10-泛型" class="headerlink" title="12.10 泛型"></a>12.10 <a href="2021/12/19/12%20%E5%B8%B8%E7%94%A8%E7%B1%BB/#12-10-%E6%B3%9B%E5%9E%8B">泛型</a></h3></li>
</ul>
<hr>
<h2 id="13-Java-数据结构"><a href="#13-Java-数据结构" class="headerlink" title="13 Java 数据结构"></a>13 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">Java 数据结构</a></h2><ul>
<li><h3 id="13-1-集合的框架体系"><a href="#13-1-集合的框架体系" class="headerlink" title="13.1 集合的框架体系"></a>13.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-1-%E9%9B%86%E5%90%88%E7%9A%84%E6%A1%86%E6%9E%B6%E4%BD%93%E7%B3%BB">集合的框架体系</a></h3></li>
<li><h3 id="13-2-单列集合接口-Collection"><a href="#13-2-单列集合接口-Collection" class="headerlink" title="13.2 单列集合接口 Collection"></a>13.2 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-2-%E5%8D%95%E5%88%97%E9%9B%86%E5%90%88%E6%8E%A5%E5%8F%A3-Collection">单列集合接口 Collection</a></h3><ul>
<li><h4 id="13-2-1-迭代器-Iterator"><a href="#13-2-1-迭代器-Iterator" class="headerlink" title="13.2.1 迭代器 Iterator"></a>13.2.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-2-1-%E8%BF%AD%E4%BB%A3%E5%99%A8-Iterator">迭代器 Iterator</a></h4></li>
</ul>
</li>
<li><h3 id="13-3-有序集合接口-List"><a href="#13-3-有序集合接口-List" class="headerlink" title="13.3 有序集合接口 List"></a>13.3 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88%E6%8E%A5%E5%8F%A3-List">有序集合接口 List</a></h3><ul>
<li><h4 id="13-3-1-可变数组-ArrayList"><a href="#13-3-1-可变数组-ArrayList" class="headerlink" title="13.3.1 可变数组 ArrayList"></a>13.3.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-1-%E5%8F%AF%E5%8F%98%E6%95%B0%E7%BB%84-ArrayList">可变数组 ArrayList</a></h4></li>
<li><h4 id="13-3-2-可变数组-Vector"><a href="#13-3-2-可变数组-Vector" class="headerlink" title="13.3.2 可变数组 Vector"></a>13.3.2 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-2-%E5%8F%AF%E5%8F%98%E6%95%B0%E7%BB%84-Vector">可变数组 Vector</a></h4></li>
<li><h4 id="13-3-3-链表-LinkedList"><a href="#13-3-3-链表-LinkedList" class="headerlink" title="13.3.3 链表 LinkedList"></a>13.3.3 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-3-%E9%93%BE%E8%A1%A8-LinkedList">链表 LinkedList</a></h4></li>
<li><h4 id="13-3-4-稀疏数组"><a href="#13-3-4-稀疏数组" class="headerlink" title="13.3.4 稀疏数组"></a>13.3.4 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-4-%E7%A8%80%E7%96%8F%E6%95%B0%E7%BB%84">稀疏数组</a></h4></li>
<li><h4 id="13-3-5-栈-Stack"><a href="#13-3-5-栈-Stack" class="headerlink" title="13.3.5 栈 Stack"></a>13.3.5 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-5-%E6%A0%88-Stack">栈 Stack</a></h4><ul>
<li><h5 id="13-3-5-1-栈模拟计算器"><a href="#13-3-5-1-栈模拟计算器" class="headerlink" title="13.3.5.1 栈模拟计算器"></a>13.3.5.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-5-1-%E6%A0%88%E6%A8%A1%E6%8B%9F%E8%AE%A1%E7%AE%97%E5%99%A8">栈模拟计算器</a></h5></li>
</ul>
</li>
<li><h4 id="13-3-6-跳表-SkipList"><a href="#13-3-6-跳表-SkipList" class="headerlink" title="13.3.6 跳表 SkipList"></a>13.3.6 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-3-6-%E8%B7%B3%E8%A1%A8-SkipList">跳表 SkipList</a></h4></li>
</ul>
</li>
<li><h3 id="13-4-队列接口-Queue"><a href="#13-4-队列接口-Queue" class="headerlink" title="13.4 队列接口 Queue"></a>13.4 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-4-%E9%98%9F%E5%88%97%E6%8E%A5%E5%8F%A3-Queue">队列接口 Queue</a></h3><ul>
<li><h4 id="13-4-1-优先级队列-PriorityQueue"><a href="#13-4-1-优先级队列-PriorityQueue" class="headerlink" title="13.4.1 优先级队列 PriorityQueue"></a>13.4.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-4-1-%E4%BC%98%E5%85%88%E7%BA%A7%E9%98%9F%E5%88%97-PriorityQueue">优先级队列 PriorityQueue</a></h4></li>
<li><h4 id="13-4-2-阻塞队列接口-BlockingQueue"><a href="#13-4-2-阻塞队列接口-BlockingQueue" class="headerlink" title="13.4.2 阻塞队列接口 BlockingQueue"></a>13.4.2 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-4-2-%E9%98%BB%E5%A1%9E%E9%98%9F%E5%88%97%E6%8E%A5%E5%8F%A3-BlockingQueue">阻塞队列接口 BlockingQueue</a></h4></li>
</ul>
</li>
<li><h3 id="13-5-双列集合接口-Map"><a href="#13-5-双列集合接口-Map" class="headerlink" title="13.5 双列集合接口 Map"></a>13.5 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-5-%E5%8F%8C%E5%88%97%E9%9B%86%E5%90%88%E6%8E%A5%E5%8F%A3-Map">双列集合接口 Map</a></h3><ul>
<li><h4 id="13-5-1-散列表-HashMap"><a href="#13-5-1-散列表-HashMap" class="headerlink" title="13.5.1 散列表 HashMap"></a>13.5.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-5-1-%E6%95%A3%E5%88%97%E8%A1%A8-HashMap">散列表 HashMap</a></h4></li>
<li><h4 id="13-5-2-散列表-Hashtable"><a href="#13-5-2-散列表-Hashtable" class="headerlink" title="13.5.2 散列表 Hashtable"></a>13.5.2 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-5-2-%E6%95%A3%E5%88%97%E8%A1%A8-Hashtable">散列表 Hashtable</a></h4></li>
<li><h4 id="13-5-3-红黑树-TreeMap"><a href="#13-5-3-红黑树-TreeMap" class="headerlink" title="13.5.3 红黑树 TreeMap"></a>13.5.3 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-5-3-%E7%BA%A2%E9%BB%91%E6%A0%91-TreeMap">红黑树 TreeMap</a></h4><ul>
<li><h5 id="13-5-3-1-二叉树"><a href="#13-5-3-1-二叉树" class="headerlink" title="13.5.3.1 二叉树"></a>13.5.3.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-5-3-1-%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%9A">二叉树</a></h5></li>
</ul>
</li>
<li><h4 id="13-5-4-Properties"><a href="#13-5-4-Properties" class="headerlink" title="13.5.4 Properties"></a>13.5.4 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-5-4-Properties">Properties</a></h4></li>
</ul>
</li>
<li><h3 id="13-6-无序集合接口-Set"><a href="#13-6-无序集合接口-Set" class="headerlink" title="13.6 无序集合接口 Set"></a>13.6 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-6-%E6%97%A0%E5%BA%8F%E9%9B%86%E5%90%88%E6%8E%A5%E5%8F%A3-Set">无序集合接口 Set</a></h3><ul>
<li><h4 id="13-6-1-HashSet"><a href="#13-6-1-HashSet" class="headerlink" title="13.6.1 HashSet"></a>13.6.1 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-6-1-HashSet">HashSet</a></h4></li>
<li><h4 id="13-6-2-LinkedHashSet"><a href="#13-6-2-LinkedHashSet" class="headerlink" title="13.6.2 LinkedHashSet"></a>13.6.2 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-6-2-LinkedHashSet">LinkedHashSet</a></h4></li>
<li><h4 id="13-6-3-TreeSet"><a href="#13-6-3-TreeSet" class="headerlink" title="13.6.3 TreeSet"></a>13.6.3 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-6-3-TreeSet">TreeSet</a></h4></li>
</ul>
</li>
<li><h3 id="13-7-集合的选择"><a href="#13-7-集合的选择" class="headerlink" title="13.7 集合的选择"></a>13.7 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-7-%E9%9B%86%E5%90%88%E7%9A%84%E9%80%89%E6%8B%A9">集合的选择</a></h3></li>
<li><h3 id="13-8-工具类-Collections"><a href="#13-8-工具类-Collections" class="headerlink" title="13.8 工具类 Collections"></a>13.8 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-8-%E5%B7%A5%E5%85%B7%E7%B1%BB-Collections">工具类 Collections</a></h3></li>
<li><h3 id="13-9-JUnit"><a href="#13-9-JUnit" class="headerlink" title="13.9 JUnit"></a>13.9 <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/#13-9-JUnit">JUnit</a></h3></li>
</ul>
<hr>
<h2 id="14-树"><a href="#14-树" class="headerlink" title="14 树"></a>14 <a href="2022/06/02/14%20%E6%A0%91/">树</a></h2><ul>
<li><h3 id="14-1-二叉树"><a href="#14-1-二叉树" class="headerlink" title="14.1 二叉树"></a>14.1 <a href="2022/06/02/14%20%E6%A0%91/#14-1-%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%9A">二叉树</a></h3><ul>
<li><h4 id="14-1-1-顺序存储二叉树"><a href="#14-1-1-顺序存储二叉树" class="headerlink" title="14.1.1 顺序存储二叉树"></a>14.1.1 <a href="2022/06/02/14%20%E6%A0%91/#14-1-1-%E9%A1%BA%E5%BA%8F%E5%AD%98%E5%82%A8%E4%BA%8C%E5%8F%89%E6%A0%91">顺序存储二叉树</a></h4></li>
<li><h4 id="14-1-2-线索化二叉树"><a href="#14-1-2-线索化二叉树" class="headerlink" title="14.1.2 线索化二叉树"></a>14.1.2 <a href="2022/06/02/14%20%E6%A0%91/#14-1-2-%E7%BA%BF%E7%B4%A2%E5%8C%96%E4%BA%8C%E5%8F%89%E6%A0%91">线索化二叉树</a></h4></li>
<li><h4 id="14-1-3-赫夫曼树"><a href="#14-1-3-赫夫曼树" class="headerlink" title="14.1.3 赫夫曼树"></a>14.1.3 <a href="2022/06/02/14%20%E6%A0%91/#14-1-3-%E8%B5%AB%E5%A4%AB%E6%9B%BC%E6%A0%91">赫夫曼树</a></h4></li>
<li><h4 id="14-1-4-二叉排序树"><a href="#14-1-4-二叉排序树" class="headerlink" title="14.1.4 二叉排序树"></a>14.1.4 <a href="2022/06/02/14%20%E6%A0%91/#14-1-4-%E4%BA%8C%E5%8F%89%E6%8E%92%E5%BA%8F%E6%A0%91">二叉排序树</a></h4><ul>
<li><h5 id="14-1-4-1-平衡二叉树"><a href="#14-1-4-1-平衡二叉树" class="headerlink" title="14.1.4.1 平衡二叉树"></a>14.1.4.1 <a href="2022/06/02/14%20%E6%A0%91/#14-1-4-1-%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91">平衡二叉树</a></h5></li>
</ul>
</li>
<li><h4 id="14-1-5-线段树"><a href="#14-1-5-线段树" class="headerlink" title="14.1.5 线段树"></a>14.1.5 <a href="2022/06/02/14%20%E6%A0%91/#14-1-4-%E7%BA%BF%E6%AE%B5%E6%A0%91">线段树</a></h4></li>
</ul>
</li>
<li><h3 id="14-2-多路查找树"><a href="#14-2-多路查找树" class="headerlink" title="14.2 多路查找树"></a>14.2 <a href="">多路查找树</a></h3><ul>
<li><h4 id="14-2-1-2-3-树"><a href="#14-2-1-2-3-树" class="headerlink" title="14.2.1 2-3 树"></a>14.2.1 <a href="2022/06/02/14%20%E6%A0%91/#14-2-1-2-3-%E6%A0%91">2-3 树</a></h4></li>
<li><h4 id="14-2-2-B-树"><a href="#14-2-2-B-树" class="headerlink" title="14.2.2 B 树"></a>14.2.2 <a href="2022/06/02/14%20%E6%A0%91/#14-2-2-B-%E6%A0%91">B 树</a></h4></li>
</ul>
</li>
<li><h3 id="14-3-图"><a href="#14-3-图" class="headerlink" title="14.3 图"></a>14.3 <a href="2022/06/02/14%20%E6%A0%91/#14-3-%E5%9B%BE">图</a></h3><ul>
<li><h4 id="14-3-1-深度优先搜索-DFS"><a href="#14-3-1-深度优先搜索-DFS" class="headerlink" title="14.3.1 深度优先搜索 DFS"></a>14.3.1 <a href="2022/06/02/14%20%E6%A0%91/#14-3-1-%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2-DFS">深度优先搜索 DFS</a></h4></li>
<li><h4 id="14-3-2-广度优先搜索-BFS"><a href="#14-3-2-广度优先搜索-BFS" class="headerlink" title="14.3.2 广度优先搜索 BFS"></a>14.3.2 <a href="2022/06/02/14%20%E6%A0%91/#14-3-2-%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2-BFS">广度优先搜索 BFS</a></h4></li>
</ul>
</li>
<li><h3 id="附录-4"><a href="#附录-4" class="headerlink" title="附录"></a>附录</h3><ul>
<li><h4 id="F1-实现赫夫曼编码-x2F-解码"><a href="#F1-实现赫夫曼编码-x2F-解码" class="headerlink" title="F1 实现赫夫曼编码&#x2F;解码"></a>F1 实现赫夫曼编码&#x2F;解码</h4></li>
<li><h4 id="F2-实现平衡二叉树"><a href="#F2-实现平衡二叉树" class="headerlink" title="F2 实现平衡二叉树"></a>F2 实现平衡二叉树</h4></li>
</ul>
</li>
</ul>
<hr>
<h2 id="15-图形界面设计"><a href="#15-图形界面设计" class="headerlink" title="15 图形界面设计"></a>15 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/">图形界面设计</a></h2><ul>
<li><h3 id="15-1-容器"><a href="#15-1-容器" class="headerlink" title="15.1 容器"></a>15.1 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-1-%E5%AE%B9%E5%99%A8">容器</a></h3><ul>
<li><h4 id="15-1-1-顶层容器"><a href="#15-1-1-顶层容器" class="headerlink" title="15.1.1 顶层容器"></a>15.1.1 顶层容器</h4></li>
<li><h4 id="15-1-2-内容窗格"><a href="#15-1-2-内容窗格" class="headerlink" title="15.1.2 内容窗格"></a>15.1.2 内容窗格</h4></li>
<li><h4 id="15-1-3-面板"><a href="#15-1-3-面板" class="headerlink" title="15.1.3 面板"></a>15.1.3 面板</h4><ul>
<li><h5 id="15-1-3-1-JPanel"><a href="#15-1-3-1-JPanel" class="headerlink" title="15.1.3.1 JPanel"></a>15.1.3.1 JPanel</h5></li>
<li><h5 id="15-1-3-2-JScrollPanel"><a href="#15-1-3-2-JScrollPanel" class="headerlink" title="15.1.3.2 JScrollPanel"></a>15.1.3.2 JScrollPanel</h5></li>
<li><h5 id="15-1-3-3-Scrollbar"><a href="#15-1-3-3-Scrollbar" class="headerlink" title="15.1.3.3 Scrollbar"></a>15.1.3.3 Scrollbar</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="15-2-标签和按钮"><a href="#15-2-标签和按钮" class="headerlink" title="15.2 标签和按钮"></a>15.2 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-2-%E6%A0%87%E7%AD%BE%E5%92%8C%E6%8C%89%E9%92%AE">标签和按钮</a></h3><ul>
<li><h4 id="15-2-1-标签"><a href="#15-2-1-标签" class="headerlink" title="15.2.1 标签"></a>15.2.1 标签</h4></li>
<li><h4 id="15-2-2-按钮"><a href="#15-2-2-按钮" class="headerlink" title="15.2.2 按钮"></a>15.2.2 按钮</h4><ul>
<li><h5 id="15-2-2-1-JButton"><a href="#15-2-2-1-JButton" class="headerlink" title="15.2.2.1 JButton"></a>15.2.2.1 JButton</h5></li>
<li><h5 id="15-2-2-2-JToggleButton、JCheckButton、JRadioButton"><a href="#15-2-2-2-JToggleButton、JCheckButton、JRadioButton" class="headerlink" title="15.2.2.2 JToggleButton、JCheckButton、JRadioButton"></a>15.2.2.2 JToggleButton、JCheckButton、JRadioButton</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="15-3-布局管理器"><a href="#15-3-布局管理器" class="headerlink" title="15.3 布局管理器"></a>15.3 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-3-%E5%B8%83%E5%B1%80%E7%AE%A1%E7%90%86%E5%99%A8">布局管理器</a></h3><ul>
<li><h4 id="15-3-1-FlowLayout-流布局管理器"><a href="#15-3-1-FlowLayout-流布局管理器" class="headerlink" title="15.3.1 FlowLayout 流布局管理器"></a>15.3.1 FlowLayout 流布局管理器</h4></li>
<li><h4 id="15-3-2-BorderLayout-边界布局管理器"><a href="#15-3-2-BorderLayout-边界布局管理器" class="headerlink" title="15.3.2 BorderLayout 边界布局管理器"></a>15.3.2 BorderLayout 边界布局管理器</h4></li>
<li><h4 id="15-3-3-GridLayout-网格布局管理器"><a href="#15-3-3-GridLayout-网格布局管理器" class="headerlink" title="15.3.3 GridLayout 网格布局管理器"></a>15.3.3 GridLayout 网格布局管理器</h4></li>
<li><h4 id="15-3-4-CardLayout-卡片式布局管理器"><a href="#15-3-4-CardLayout-卡片式布局管理器" class="headerlink" title="15.3.4 CardLayout 卡片式布局管理器"></a>15.3.4 CardLayout 卡片式布局管理器</h4></li>
<li><h4 id="15-3-5-BoxLayout-方框布局管理器"><a href="#15-3-5-BoxLayout-方框布局管理器" class="headerlink" title="15.3.5 BoxLayout 方框布局管理器"></a>15.3.5 BoxLayout 方框布局管理器</h4></li>
<li><h4 id="15-3-6-空布局"><a href="#15-3-6-空布局" class="headerlink" title="15.3.6 空布局"></a>15.3.6 空布局</h4></li>
</ul>
</li>
<li><h3 id="15-4-事件处理"><a href="#15-4-事件处理" class="headerlink" title="15.4 事件处理"></a>15.4 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-4-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86">事件处理</a></h3><ul>
<li><h4 id="15-4-1-事件处理模型"><a href="#15-4-1-事件处理模型" class="headerlink" title="15.4.1 事件处理模型"></a>15.4.1 事件处理模型</h4></li>
<li><h4 id="15-4-2-事件的种类"><a href="#15-4-2-事件的种类" class="headerlink" title="15.4.2 事件的种类"></a>15.4.2 事件的种类</h4></li>
<li><h4 id="15-4-3-事件适配器"><a href="#15-4-3-事件适配器" class="headerlink" title="15.4.3 事件适配器"></a>15.4.3 事件适配器</h4></li>
</ul>
</li>
<li><h3 id="15-5-Java-绘图技术"><a href="#15-5-Java-绘图技术" class="headerlink" title="15.5 Java 绘图技术"></a>15.5 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-5-Java-%E7%BB%98%E5%9B%BE%E6%8A%80%E6%9C%AF">Java 绘图技术</a></h3><ul>
<li><h4 id="15-5-1-颜色"><a href="#15-5-1-颜色" class="headerlink" title="15.5.1 颜色"></a>15.5.1 颜色</h4></li>
<li><h4 id="15-5-2-字体"><a href="#15-5-2-字体" class="headerlink" title="15.5.2 字体"></a>15.5.2 字体</h4></li>
<li><h4 id="15-5-3-Graphics-类"><a href="#15-5-3-Graphics-类" class="headerlink" title="15.5.3 Graphics 类"></a>15.5.3 Graphics 类</h4><ul>
<li><h5 id="15-5-3-1-Polygon-类"><a href="#15-5-3-1-Polygon-类" class="headerlink" title="15.5.3.1 Polygon 类"></a>15.5.3.1 Polygon 类</h5></li>
</ul>
</li>
<li><h4 id="15-5-4-Graphics2D-类"><a href="#15-5-4-Graphics2D-类" class="headerlink" title="15.5.4 Graphics2D 类"></a>15.5.4 Graphics2D 类</h4><ul>
<li><h5 id="15-5-4-1-图形状态属性"><a href="#15-5-4-1-图形状态属性" class="headerlink" title="15.5.4.1 图形状态属性"></a>15.5.4.1 图形状态属性</h5></li>
<li><h5 id="15-5-4-2-Graphics2D-的绘图方法"><a href="#15-5-4-2-Graphics2D-的绘图方法" class="headerlink" title="15.5.4.2 Graphics2D 的绘图方法"></a>15.5.4.2 Graphics2D 的绘图方法</h5></li>
<li><h5 id="15-5-4-3-Graphics2D-中的几何图形类"><a href="#15-5-4-3-Graphics2D-中的几何图形类" class="headerlink" title="15.5.4.3 Graphics2D 中的几何图形类"></a>15.5.4.3 Graphics2D 中的几何图形类</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="15-6-组合框与列表"><a href="#15-6-组合框与列表" class="headerlink" title="15.6 组合框与列表"></a>15.6 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-6-%E7%BB%84%E5%90%88%E6%A1%86%E4%B8%8E%E5%88%97%E8%A1%A8">组合框与列表</a></h3><ul>
<li><h4 id="15-6-1-JComboBox-组合框"><a href="#15-6-1-JComboBox-组合框" class="headerlink" title="15.6.1 JComboBox 组合框"></a>15.6.1 JComboBox 组合框</h4></li>
<li><h4 id="15-6-2-JList-列表"><a href="#15-6-2-JList-列表" class="headerlink" title="15.6.2 JList 列表"></a>15.6.2 JList 列表</h4></li>
</ul>
</li>
<li><h3 id="15-7-文本组件"><a href="#15-7-文本组件" class="headerlink" title="15.7 文本组件"></a>15.7 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-7-%E6%96%87%E6%9C%AC%E7%BB%84%E4%BB%B6">文本组件</a></h3><ul>
<li><h4 id="15-7-1-JTextField-文本域"><a href="#15-7-1-JTextField-文本域" class="headerlink" title="15.7.1 JTextField 文本域"></a>15.7.1 JTextField 文本域</h4></li>
<li><h4 id="15-7-2-JTextArea-文本区"><a href="#15-7-2-JTextArea-文本区" class="headerlink" title="15.7.2 JTextArea 文本区"></a>15.7.2 JTextArea 文本区</h4></li>
</ul>
</li>
<li><h3 id="15-8-菜单组件"><a href="#15-8-菜单组件" class="headerlink" title="15.8 菜单组件"></a>15.8 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-8-%E8%8F%9C%E5%8D%95%E7%BB%84%E4%BB%B6">菜单组件</a></h3><ul>
<li><h4 id="15-8-1-菜单栏及菜单"><a href="#15-8-1-菜单栏及菜单" class="headerlink" title="15.8.1 菜单栏及菜单"></a>15.8.1 菜单栏及菜单</h4></li>
<li><h4 id="15-8-2-JMenuItem-菜单项"><a href="#15-8-2-JMenuItem-菜单项" class="headerlink" title="15.8.2 JMenuItem 菜单项"></a>15.8.2 JMenuItem 菜单项</h4></li>
<li><h4 id="15-8-3-复选菜单项和单选菜单项"><a href="#15-8-3-复选菜单项和单选菜单项" class="headerlink" title="15.8.3 复选菜单项和单选菜单项"></a>15.8.3 复选菜单项和单选菜单项</h4></li>
</ul>
</li>
<li><h3 id="15-9-对话框"><a href="#15-9-对话框" class="headerlink" title="15.9 对话框"></a>15.9 <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/#15-9-%E5%AF%B9%E8%AF%9D%E6%A1%86">对话框</a></h3><ul>
<li><h4 id="15-9-1-JDialog-自定义对话框"><a href="#15-9-1-JDialog-自定义对话框" class="headerlink" title="15.9.1 JDialog 自定义对话框"></a>15.9.1 JDialog 自定义对话框</h4></li>
<li><h4 id="15-9-2-JOptionalPane-标准对话框"><a href="#15-9-2-JOptionalPane-标准对话框" class="headerlink" title="15.9.2 JOptionalPane 标准对话框"></a>15.9.2 JOptionalPane 标准对话框</h4></li>
<li><h4 id="15-9-3-JFileChooser-文件对话框"><a href="#15-9-3-JFileChooser-文件对话框" class="headerlink" title="15.9.3 JFileChooser 文件对话框"></a>15.9.3 JFileChooser 文件对话框</h4></li>
</ul>
</li>
</ul>
<hr>
<h2 id="16-多线程"><a href="#16-多线程" class="headerlink" title="16 多线程"></a>16 <a href="2022/01/01/16%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></h2><ul>
<li><h3 id="16-1-线程的概念"><a href="#16-1-线程的概念" class="headerlink" title="16.1 线程的概念"></a>16.1 <a href="2022/01/01/16%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/#16-1-%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%A6%82%E5%BF%B5">线程的概念</a></h3><ul>
<li><h4 id="16-1-1-线程的结构"><a href="#16-1-1-线程的结构" class="headerlink" title="16.1.1 线程的结构"></a>16.1.1 线程的结构</h4></li>
<li><h4 id="16-1-2-线程的状态"><a href="#16-1-2-线程的状态" class="headerlink" title="16.1.2 线程的状态"></a>16.1.2 线程的状态</h4></li>
</ul>
</li>
<li><h3 id="16-2-线程的使用"><a href="#16-2-线程的使用" class="headerlink" title="16.2 线程的使用"></a>16.2 <a href="2022/01/01/16%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/#16-2-%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%BD%BF%E7%94%A8">线程的使用</a></h3><ul>
<li><h4 id="16-2-1-继承-Thread-类"><a href="#16-2-1-继承-Thread-类" class="headerlink" title="16.2.1 继承 Thread 类"></a>16.2.1 继承 Thread 类</h4></li>
<li><h4 id="16-2-2-实现-Runable-接口"><a href="#16-2-2-实现-Runable-接口" class="headerlink" title="16.2.2 实现 Runable 接口"></a>16.2.2 实现 Runable 接口</h4></li>
<li><h4 id="16-2-3-继承-Thread-和-实现-Runable-的区别"><a href="#16-2-3-继承-Thread-和-实现-Runable-的区别" class="headerlink" title="16.2.3 继承 Thread 和 实现 Runable 的区别"></a>16.2.3 继承 Thread 和 实现 Runable 的区别</h4></li>
<li><h4 id="16-2-4-线程中止"><a href="#16-2-4-线程中止" class="headerlink" title="16.2.4 线程中止"></a>16.2.4 线程中止</h4></li>
<li><h4 id="16-2-5-线程常用方法"><a href="#16-2-5-线程常用方法" class="headerlink" title="16.2.5 线程常用方法"></a>16.2.5 线程常用方法</h4></li>
<li><h4 id="16-2-6-用户线程和守护线程"><a href="#16-2-6-用户线程和守护线程" class="headerlink" title="16.2.6 用户线程和守护线程"></a>16.2.6 用户线程和守护线程</h4></li>
<li><h4 id="16-2-7-线程的生命周期"><a href="#16-2-7-线程的生命周期" class="headerlink" title="16.2.7 线程的生命周期"></a>16.2.7 线程的生命周期</h4></li>
</ul>
</li>
<li><h3 id="16-3-线程的互斥"><a href="#16-3-线程的互斥" class="headerlink" title="16.3 线程的互斥"></a>16.3 <a href="2022/01/01/16%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/#16-3-%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%BA%92%E6%96%A5">线程的互斥</a></h3><ul>
<li><h4 id="16-3-1-互斥锁"><a href="#16-3-1-互斥锁" class="headerlink" title="16.3.1 互斥锁"></a>16.3.1 互斥锁</h4></li>
<li><h4 id="16-3-2-线程死锁"><a href="#16-3-2-线程死锁" class="headerlink" title="16.3.2 线程死锁"></a>16.3.2 线程死锁</h4></li>
</ul>
</li>
<li><h3 id="16-4-线程的同步"><a href="#16-4-线程的同步" class="headerlink" title="16.4 线程的同步"></a>16.4 <a href="2022/01/01/16%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/#16-4-%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%90%8C%E6%AD%A5">线程的同步</a></h3></li>
</ul>
<hr>
<h2 id="17-IO-流"><a href="#17-IO-流" class="headerlink" title="17 IO 流"></a>17 <a href="2022/01/06/17%20IO%E6%B5%81/">IO 流</a></h2><ul>
<li><h3 id="17-1-文件"><a href="#17-1-文件" class="headerlink" title="17.1 文件"></a>17.1 <a href="2022/01/06/17%20IO%E6%B5%81/#17-1-%E6%96%87%E4%BB%B6">文件</a></h3><ul>
<li><h4 id="17-1-1-常用的文件操作"><a href="#17-1-1-常用的文件操作" class="headerlink" title="17.1.1 常用的文件操作"></a>17.1.1 常用的文件操作</h4></li>
</ul>
</li>
<li><h3 id="17-2-IO流"><a href="#17-2-IO流" class="headerlink" title="17.2 IO流"></a>17.2 <a href="2022/01/06/17%20IO%E6%B5%81/#17-2-IO%E6%B5%81">IO流</a></h3><ul>
<li><h4 id="17-2-1-IO流的分类"><a href="#17-2-1-IO流的分类" class="headerlink" title="17.2.1 IO流的分类"></a>17.2.1 IO流的分类</h4></li>
<li><h4 id="17-2-2-IO流-常用类"><a href="#17-2-2-IO流-常用类" class="headerlink" title="17.2.2 IO流 常用类"></a>17.2.2 IO流 常用类</h4><ul>
<li><h5 id="17-2-2-1-FileInputStream：文件字节输入流"><a href="#17-2-2-1-FileInputStream：文件字节输入流" class="headerlink" title="17.2.2.1 FileInputStream：文件字节输入流"></a>17.2.2.1 FileInputStream：文件字节输入流</h5></li>
<li><h5 id="17-2-2-2-FileOutputStream：文件字节输出流"><a href="#17-2-2-2-FileOutputStream：文件字节输出流" class="headerlink" title="17.2.2.2 FileOutputStream：文件字节输出流"></a>17.2.2.2 FileOutputStream：文件字节输出流</h5></li>
<li><h5 id="17-2-2-3-FileReader：文件字符输入流"><a href="#17-2-2-3-FileReader：文件字符输入流" class="headerlink" title="17.2.2.3 FileReader：文件字符输入流"></a>17.2.2.3 FileReader：文件字符输入流</h5></li>
<li><h5 id="17-2-2-3-FileWriter：文件字符输出流"><a href="#17-2-2-3-FileWriter：文件字符输出流" class="headerlink" title="17.2.2.3 FileWriter：文件字符输出流"></a>17.2.2.3 FileWriter：文件字符输出流</h5></li>
<li><h5 id="17-2-3-4-转换流-InputStreamReader-和-OutputStreamWriter"><a href="#17-2-3-4-转换流-InputStreamReader-和-OutputStreamWriter" class="headerlink" title="17.2.3.4 转换流 InputStreamReader 和 OutputStreamWriter"></a>17.2.3.4 转换流 InputStreamReader 和 OutputStreamWriter</h5></li>
</ul>
</li>
<li><h4 id="17-2-3-节点流和处理流"><a href="#17-2-3-节点流和处理流" class="headerlink" title="17.2.3 节点流和处理流"></a>17.2.3 节点流和处理流</h4><ul>
<li><h5 id="17-2-3-1-缓冲区流"><a href="#17-2-3-1-缓冲区流" class="headerlink" title="17.2.3.1 缓冲区流"></a>17.2.3.1 缓冲区流</h5></li>
<li><h5 id="17-2-3-2-数据数据流"><a href="#17-2-3-2-数据数据流" class="headerlink" title="17.2.3.2 数据数据流"></a>17.2.3.2 数据数据流</h5></li>
<li><h5 id="17-2-3-3-对象流"><a href="#17-2-3-3-对象流" class="headerlink" title="17.2.3.3 对象流"></a>17.2.3.3 对象流</h5></li>
<li><h5 id="17-2-3-4-标准输入-x2F-输出流"><a href="#17-2-3-4-标准输入-x2F-输出流" class="headerlink" title="17.2.3.4 标准输入 &#x2F; 输出流"></a>17.2.3.4 标准输入 &#x2F; 输出流</h5></li>
<li><h5 id="17-2-3-5-打印流-PaintStream-和-PaintWriter"><a href="#17-2-3-5-打印流-PaintStream-和-PaintWriter" class="headerlink" title="17.2.3.5 打印流 PaintStream 和 PaintWriter"></a>17.2.3.5 打印流 PaintStream 和 PaintWriter</h5></li>
<li><h5 id="17-2-3-6-Properties-类"><a href="#17-2-3-6-Properties-类" class="headerlink" title="17.2.3.6 Properties 类"></a>17.2.3.6 Properties 类</h5></li>
<li><h5 id="17-2-3-7-随机访问文件"><a href="#17-2-3-7-随机访问文件" class="headerlink" title="17.2.3.7 随机访问文件"></a>17.2.3.7 随机访问文件</h5></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="18-项目：坦克大战-完结"><a href="#18-项目：坦克大战-完结" class="headerlink" title="18 项目：坦克大战 [完结]"></a>18 <a href="2022/01/11/18%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98/">项目：坦克大战 [完结]</a></h2><p>2022.1.12  01:57			第二阶段完成</p>
<hr>
<h2 id="19-网络编程"><a href="#19-网络编程" class="headerlink" title="19 网络编程"></a>19 <a href="2022/01/12/19%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">网络编程</a></h2><ul>
<li><h3 id="19-1-网络的相关概念"><a href="#19-1-网络的相关概念" class="headerlink" title="19.1 网络的相关概念"></a>19.1 <a href="2022/01/12/19%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#19-1-%E7%BD%91%E7%BB%9C%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5">网络的相关概念</a></h3><ul>
<li><h4 id="19-1-1-TCP-和-UDP"><a href="#19-1-1-TCP-和-UDP" class="headerlink" title="19.1.1 TCP 和 UDP"></a>19.1.1 TCP 和 UDP</h4></li>
</ul>
</li>
<li><h3 id="19-2-InetAddress-类"><a href="#19-2-InetAddress-类" class="headerlink" title="19.2 InetAddress 类"></a>19.2 <a href="2022/01/12/19%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#19-2-InetAddress-%E7%B1%BB">InetAddress 类</a></h3></li>
<li><h3 id="19-3-Socket"><a href="#19-3-Socket" class="headerlink" title="19.3 Socket"></a>19.3 <a href="2022/01/12/19%20%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#19-3-Socket">Socket</a></h3><ul>
<li><h4 id="19-3-1-TCP-网络通信编程"><a href="#19-3-1-TCP-网络通信编程" class="headerlink" title="19.3.1 TCP 网络通信编程"></a>19.3.1 TCP 网络通信编程</h4><ul>
<li><h5 id="19-3-1-1-netstat-指令"><a href="#19-3-1-1-netstat-指令" class="headerlink" title="19.3.1.1 netstat 指令"></a>19.3.1.1 netstat 指令</h5></li>
<li><h5 id="19-3-1-2-TCP-连接秘密"><a href="#19-3-1-2-TCP-连接秘密" class="headerlink" title="19.3.1.2 TCP 连接秘密"></a>19.3.1.2 TCP 连接秘密</h5></li>
</ul>
</li>
<li><h4 id="19-3-2-UDP-网络通信编程"><a href="#19-3-2-UDP-网络通信编程" class="headerlink" title="19.3.2 UDP 网络通信编程"></a>19.3.2 UDP 网络通信编程</h4></li>
</ul>
</li>
</ul>
<hr>
<h2 id="20-项目：多用户通讯系统"><a href="#20-项目：多用户通讯系统" class="headerlink" title="20 项目：多用户通讯系统"></a>20 <a href="2022/01/16/20%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%A4%9A%E7%94%A8%E6%88%B7%E9%80%9A%E8%AE%AF%E7%B3%BB%E7%BB%9F/">项目：多用户通讯系统</a></h2><ul>
<li><h3 id="20-1-需求分析"><a href="#20-1-需求分析" class="headerlink" title="20.1 需求分析"></a>20.1 需求分析</h3></li>
</ul>
<hr>
<h2 id="21-反射"><a href="#21-反射" class="headerlink" title="21 反射"></a>21 <a href="2022/01/20/21%20%E5%8F%8D%E5%B0%84/">反射</a></h2><ul>
<li><h3 id="21-1-反射相关的常用类"><a href="#21-1-反射相关的常用类" class="headerlink" title="21.1 反射相关的常用类"></a>21.1 <a href="2022/01/20/21%20%E5%8F%8D%E5%B0%84/#21-1-%E5%8F%8D%E5%B0%84%E7%9B%B8%E5%85%B3%E7%9A%84%E5%B8%B8%E7%94%A8%E7%B1%BB">反射相关的常用类</a></h3></li>
<li><h3 id="21-2-Class-类"><a href="#21-2-Class-类" class="headerlink" title="21.2 Class 类"></a>21.2 <a href="2022/01/20/21%20%E5%8F%8D%E5%B0%84/#21-2-Class-%E7%B1%BB">Class 类</a></h3><ul>
<li><h4 id="21-2-1-Class-类的常用方法"><a href="#21-2-1-Class-类的常用方法" class="headerlink" title="21.2.1 Class 类的常用方法"></a>21.2.1 Class 类的常用方法</h4></li>
<li><h4 id="21-2-2-获取-Class-对象"><a href="#21-2-2-获取-Class-对象" class="headerlink" title="21.2.2 获取 Class 对象"></a>21.2.2 获取 Class 对象</h4></li>
<li><h4 id="21-2-3-哪些类有-Class-对象"><a href="#21-2-3-哪些类有-Class-对象" class="headerlink" title="21.2.3 哪些类有 Class 对象"></a>21.2.3 哪些类有 Class 对象</h4></li>
</ul>
</li>
<li><h3 id="21-3-类的加载"><a href="#21-3-类的加载" class="headerlink" title="21.3 类的加载"></a>21.3 <a href="2022/01/20/21%20%E5%8F%8D%E5%B0%84/#21-3-%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD">类的加载</a></h3><ul>
<li><h4 id="21-3-1-类加载的五个阶段"><a href="#21-3-1-类加载的五个阶段" class="headerlink" title="21.3.1 类加载的五个阶段"></a>21.3.1 类加载的五个阶段</h4></li>
</ul>
</li>
<li><h3 id="21-4-通过反射获取类的结构信息"><a href="#21-4-通过反射获取类的结构信息" class="headerlink" title="21.4 通过反射获取类的结构信息"></a>21.4 <a href="2022/01/20/21%20%E5%8F%8D%E5%B0%84/#21-4-%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E8%8E%B7%E5%8F%96%E7%B1%BB%E7%9A%84%E7%BB%93%E6%9E%84%E4%BF%A1%E6%81%AF">通过反射获取类的结构信息</a></h3></li>
<li><h3 id="21-5-通过反射创建对象"><a href="#21-5-通过反射创建对象" class="headerlink" title="21.5 通过反射创建对象"></a>21.5 <a href="2022/01/20/21%20%E5%8F%8D%E5%B0%84/#21-5-%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1">通过反射创建对象</a></h3></li>
<li><h3 id="21-6-通过反射访问成员"><a href="#21-6-通过反射访问成员" class="headerlink" title="21.6 通过反射访问成员"></a>21.6 <a href="2022/01/20/21%20%E5%8F%8D%E5%B0%84/#21-6-%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E8%AE%BF%E9%97%AE%E6%88%90%E5%91%98">通过反射访问成员</a></h3></li>
</ul>
<hr>
<h2 id="22-MySQL"><a href="#22-MySQL" class="headerlink" title="22 MySQL"></a>22 <a href="2022/01/22/22%20MySQL/">MySQL</a></h2><ul>
<li><h3 id="22-1-数据库"><a href="#22-1-数据库" class="headerlink" title="22.1 数据库"></a>22.1 <a href="2022/01/22/22%20MySQL/#22-1-%E6%95%B0%E6%8D%AE%E5%BA%93">数据库</a></h3><ul>
<li><h4 id="22-1-1-创建数据库"><a href="#22-1-1-创建数据库" class="headerlink" title="22.1.1 创建数据库"></a>22.1.1 创建数据库</h4></li>
<li><h4 id="22-1-2-查看-·-删除数据库"><a href="#22-1-2-查看-·-删除数据库" class="headerlink" title="22.1.2 查看 · 删除数据库"></a>22.1.2 查看 · 删除数据库</h4></li>
<li><h4 id="22-1-3-备份-·-恢复数据库"><a href="#22-1-3-备份-·-恢复数据库" class="headerlink" title="22.1.3 备份 · 恢复数据库"></a>22.1.3 备份 · 恢复数据库</h4></li>
</ul>
</li>
<li><h3 id="22-2-MySQL-常用数据类型（列类型）"><a href="#22-2-MySQL-常用数据类型（列类型）" class="headerlink" title="22.2 MySQL 常用数据类型（列类型）"></a>22.2 <a href="2022/01/22/22%20MySQL/#22-2-MySQL-%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%88%E5%88%97%E7%B1%BB%E5%9E%8B%EF%BC%89">MySQL 常用数据类型（列类型）</a></h3><ul>
<li><h4 id="22-2-1-数组类型"><a href="#22-2-1-数组类型" class="headerlink" title="22.2.1 数组类型"></a>22.2.1 数组类型</h4><ul>
<li><h5 id="22-2-1-1-整形"><a href="#22-2-1-1-整形" class="headerlink" title="22.2.1.1 整形"></a>22.2.1.1 整形</h5></li>
<li><h5 id="22-2-1-2-bit（位类型）"><a href="#22-2-1-2-bit（位类型）" class="headerlink" title="22.2.1.2 bit（位类型）"></a>22.2.1.2 bit（位类型）</h5></li>
<li><h5 id="22-2-1-3-小数类型"><a href="#22-2-1-3-小数类型" class="headerlink" title="22.2.1.3 小数类型"></a>22.2.1.3 小数类型</h5></li>
</ul>
</li>
<li><h4 id="22-2-2-文本类型"><a href="#22-2-2-文本类型" class="headerlink" title="22.2.2 文本类型"></a>22.2.2 文本类型</h4></li>
<li><h4 id="22-2-3-时间日期类型"><a href="#22-2-3-时间日期类型" class="headerlink" title="22.2.3 时间日期类型"></a>22.2.3 时间日期类型</h4></li>
</ul>
</li>
<li><h3 id="22-3-表"><a href="#22-3-表" class="headerlink" title="22.3 表"></a>22.3 <a href="2022/01/22/22%20MySQL/#22-3-%E8%A1%A8">表</a></h3><ul>
<li><h4 id="22-2-1-创建表"><a href="#22-2-1-创建表" class="headerlink" title="22.2.1 创建表"></a>22.2.1 创建表</h4></li>
<li><h4 id="22-2-2-删除-·-修改表"><a href="#22-2-2-删除-·-修改表" class="headerlink" title="22.2.2 删除 · 修改表"></a>22.2.2 删除 · 修改表</h4></li>
</ul>
</li>
<li><h3 id="22-4-数据库的增删改查"><a href="#22-4-数据库的增删改查" class="headerlink" title="22.4 数据库的增删改查"></a>22.4 <a href="2022/01/22/22%20MySQL/#22-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5">数据库的增删改查</a></h3><ul>
<li><h4 id="22-4-1-INSERT-语句"><a href="#22-4-1-INSERT-语句" class="headerlink" title="22.4.1 INSERT 语句"></a>22.4.1 INSERT 语句</h4></li>
<li><h4 id="22-4-2-UPDATE-语句"><a href="#22-4-2-UPDATE-语句" class="headerlink" title="22.4.2 UPDATE 语句"></a>22.4.2 UPDATE 语句</h4></li>
<li><h4 id="22-4-3-DELETE-语句"><a href="#22-4-3-DELETE-语句" class="headerlink" title="22.4.3 DELETE 语句"></a>22.4.3 DELETE 语句</h4></li>
<li><h4 id="22-4-4-SELECT-语句（单表）"><a href="#22-4-4-SELECT-语句（单表）" class="headerlink" title="22.4.4 SELECT 语句（单表）"></a>22.4.4 SELECT 语句（单表）</h4></li>
<li><h4 id="22-4-5-常用的运算符"><a href="#22-4-5-常用的运算符" class="headerlink" title="22.4.5 常用的运算符"></a>22.4.5 常用的运算符</h4></li>
</ul>
</li>
<li><h3 id="22-5-函数"><a href="#22-5-函数" class="headerlink" title="22.5 函数"></a>22.5 <a href="2022/01/22/22%20MySQL/#22-5-%E5%87%BD%E6%95%B0">函数</a></h3><ul>
<li><h4 id="22-5-1-统计函数"><a href="#22-5-1-统计函数" class="headerlink" title="22.5.1 统计函数"></a>22.5.1 统计函数</h4></li>
<li><h4 id="22-5-2-字符串函数"><a href="#22-5-2-字符串函数" class="headerlink" title="22.5.2 字符串函数"></a>22.5.2 字符串函数</h4></li>
<li><h4 id="22-5-3-数学函数"><a href="#22-5-3-数学函数" class="headerlink" title="22.5.3 数学函数"></a>22.5.3 数学函数</h4></li>
<li><h4 id="22-5-4-时间和日期函数"><a href="#22-5-4-时间和日期函数" class="headerlink" title="22.5.4 时间和日期函数"></a>22.5.4 时间和日期函数</h4></li>
<li><h4 id="22-5-5-加密和系统函数"><a href="#22-5-5-加密和系统函数" class="headerlink" title="22.5.5 加密和系统函数"></a>22.5.5 加密和系统函数</h4></li>
<li><h4 id="22-5-6-流程控制函数"><a href="#22-5-6-流程控制函数" class="headerlink" title="22.5.6 流程控制函数"></a>22.5.6 流程控制函数</h4></li>
</ul>
</li>
<li><h3 id="22-6-MySQL-多表查询"><a href="#22-6-MySQL-多表查询" class="headerlink" title="22.6 MySQL 多表查询"></a>22.6 <a href="2022/01/22/22%20MySQL/#22-6-MySQL-%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2">MySQL 多表查询</a></h3><ul>
<li><h4 id="22-6-1-自连接"><a href="#22-6-1-自连接" class="headerlink" title="22.6.1 自连接"></a>22.6.1 自连接</h4></li>
<li><h4 id="22-6-2-子查询"><a href="#22-6-2-子查询" class="headerlink" title="22.6.2 子查询"></a>22.6.2 子查询</h4></li>
</ul>
</li>
<li><h3 id="22-7-外连接"><a href="#22-7-外连接" class="headerlink" title="22.7 外连接"></a>22.7 <a href="2022/01/22/22%20MySQL/#22-7-%E5%A4%96%E8%BF%9E%E6%8E%A5">外连接</a></h3></li>
<li><h3 id="22-8-约束"><a href="#22-8-约束" class="headerlink" title="22.8 约束"></a>22.8 <a href="2022/01/22/22%20MySQL/#22-8-%E7%BA%A6%E6%9D%9F">约束</a></h3><ul>
<li><h4 id="22-8-1-primary-key（主键）"><a href="#22-8-1-primary-key（主键）" class="headerlink" title="22.8.1 primary key（主键）"></a>22.8.1 primary key（主键）</h4><ul>
<li><h5 id="22-8-1-1-使用细节"><a href="#22-8-1-1-使用细节" class="headerlink" title="22.8.1.1 使用细节"></a>22.8.1.1 使用细节</h5></li>
</ul>
</li>
<li><h4 id="22-8-2-not-null（非空）"><a href="#22-8-2-not-null（非空）" class="headerlink" title="22.8.2 not null（非空）"></a>22.8.2 not null（非空）</h4></li>
<li><h4 id="22-8-3-unique（唯一）"><a href="#22-8-3-unique（唯一）" class="headerlink" title="22.8.3 unique（唯一）"></a>22.8.3 unique（唯一）</h4></li>
<li><h4 id="22-8-4-foreign-key（外键）"><a href="#22-8-4-foreign-key（外键）" class="headerlink" title="22.8.4 foreign key（外键）"></a>22.8.4 foreign key（外键）</h4><ul>
<li><h5 id="22-8-4-1-使用细节"><a href="#22-8-4-1-使用细节" class="headerlink" title="22.8.4.1 使用细节"></a>22.8.4.1 使用细节</h5></li>
</ul>
</li>
<li><h4 id="22-8-5-check"><a href="#22-8-5-check" class="headerlink" title="22.8.5 check"></a>22.8.5 check</h4></li>
<li><h4 id="22-8-6-自增长"><a href="#22-8-6-自增长" class="headerlink" title="22.8.6 自增长"></a>22.8.6 自增长</h4><ul>
<li><h5 id="22-8-6-1-使用细节"><a href="#22-8-6-1-使用细节" class="headerlink" title="22.8.6.1 使用细节"></a>22.8.6.1 使用细节</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="22-9-索引"><a href="#22-9-索引" class="headerlink" title="22.9 索引"></a>22.9 <a href="2022/01/22/22%20MySQL/#22-9-%E7%B4%A2%E5%BC%95">索引</a></h3><ul>
<li><h4 id="22-9-1-索引的操作"><a href="#22-9-1-索引的操作" class="headerlink" title="22.9.1 索引的操作"></a>22.9.1 索引的操作</h4></li>
<li><h4 id="22-9-2-创建规则"><a href="#22-9-2-创建规则" class="headerlink" title="22.9.2 创建规则"></a>22.9.2 创建规则</h4></li>
</ul>
</li>
<li><h3 id="22-10-事务"><a href="#22-10-事务" class="headerlink" title="22.10 事务"></a>22.10 <a href="2022/01/22/22%20MySQL/#22-10-%E4%BA%8B%E5%8A%A1">事务</a></h3><ul>
<li><h4 id="22-10-1-事务的操作"><a href="#22-10-1-事务的操作" class="headerlink" title="22.10.1 事务的操作"></a>22.10.1 事务的操作</h4></li>
<li><h4 id="22-10-2-使用细节"><a href="#22-10-2-使用细节" class="headerlink" title="22.10.2 使用细节"></a>22.10.2 使用细节</h4></li>
<li><h4 id="22-10-3-隔离级别"><a href="#22-10-3-隔离级别" class="headerlink" title="22.10.3 隔离级别"></a>22.10.3 隔离级别</h4><ul>
<li><h5 id="22-10-3-1-隔离级别的操作"><a href="#22-10-3-1-隔离级别的操作" class="headerlink" title="22.10.3.1 隔离级别的操作"></a>22.10.3.1 隔离级别的操作</h5></li>
</ul>
</li>
<li><h4 id="22-10-4-事务的-ACID-特性"><a href="#22-10-4-事务的-ACID-特性" class="headerlink" title="22.10.4 事务的 ACID 特性"></a>22.10.4 事务的 ACID 特性</h4></li>
</ul>
</li>
<li><h3 id="22-11-MySQL-表类型和存储引擎"><a href="#22-11-MySQL-表类型和存储引擎" class="headerlink" title="22.11 MySQL 表类型和存储引擎"></a>22.11 <a href="2022/01/22/22%20MySQL/#22-11-MySQL-%E8%A1%A8%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E">MySQL 表类型和存储引擎</a></h3><ul>
<li><h4 id="22-11-1-如何选择存储引擎"><a href="#22-11-1-如何选择存储引擎" class="headerlink" title="22.11.1 如何选择存储引擎"></a>22.11.1 如何选择存储引擎</h4></li>
</ul>
</li>
<li><h3 id="22-12-视图"><a href="#22-12-视图" class="headerlink" title="22.12 视图"></a>22.12 <a href="2022/01/22/22%20MySQL/#22-12-%E8%A7%86%E5%9B%BE">视图</a></h3><ul>
<li><h4 id="22-12-1-基本使用"><a href="#22-12-1-基本使用" class="headerlink" title="22.12.1 基本使用"></a>22.12.1 基本使用</h4></li>
<li><h4 id="22-12-2-使用细节"><a href="#22-12-2-使用细节" class="headerlink" title="22.12.2 使用细节"></a>22.12.2 使用细节</h4></li>
<li><h4 id="22-12-3-视图最佳实践"><a href="#22-12-3-视图最佳实践" class="headerlink" title="22.12.3 视图最佳实践"></a>22.12.3 视图最佳实践</h4></li>
</ul>
</li>
<li><h3 id="22-13-MySQL-管理"><a href="#22-13-MySQL-管理" class="headerlink" title="22.13 MySQL 管理"></a>22.13 <a href="2022/01/22/22%20MySQL/#22-13-MySQL-%E7%AE%A1%E7%90%86">MySQL 管理</a></h3><ul>
<li><h4 id="22-13-1-用户管理"><a href="#22-13-1-用户管理" class="headerlink" title="22.13.1 用户管理"></a>22.13.1 用户管理</h4></li>
<li><h4 id="22-13-2-权限管理"><a href="#22-13-2-权限管理" class="headerlink" title="22.13.2 权限管理"></a>22.13.2 权限管理</h4></li>
</ul>
</li>
<li><h3 id="附录：数据库"><a href="#附录：数据库" class="headerlink" title="附录：数据库"></a>附录：数据库</h3></li>
</ul>
<hr>
<h2 id="23-JDBC-和数据库连接池"><a href="#23-JDBC-和数据库连接池" class="headerlink" title="23 JDBC 和数据库连接池"></a>23 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-JDBC-%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0">JDBC 和数据库连接池</a></h2><ul>
<li><h3 id="23-1-连接数据库的-5-种方式"><a href="#23-1-连接数据库的-5-种方式" class="headerlink" title="23.1 连接数据库的 5 种方式"></a>23.1 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-1-%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84-5-%E7%A7%8D%E6%96%B9%E5%BC%8F">连接数据库的 5 种方式</a></h3></li>
<li><h3 id="23-2-ReaultSet-结果集"><a href="#23-2-ReaultSet-结果集" class="headerlink" title="23.2 ReaultSet 结果集"></a>23.2 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-2-ReaultSet-%E7%BB%93%E6%9E%9C%E9%9B%86">ReaultSet 结果集</a></h3></li>
<li><h3 id="23-3-Statement"><a href="#23-3-Statement" class="headerlink" title="23.3 Statement"></a>23.3 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-3-Statement">Statement</a></h3><ul>
<li><h4 id="23-3-1-PreparedStatement-预处理"><a href="#23-3-1-PreparedStatement-预处理" class="headerlink" title="23.3.1 PreparedStatement 预处理"></a>23.3.1 PreparedStatement 预处理</h4></li>
</ul>
</li>
<li><h3 id="23-4-JDBCUtils"><a href="#23-4-JDBCUtils" class="headerlink" title="23.4 JDBCUtils"></a>23.4 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-4-JDBCUtils">JDBCUtils</a></h3></li>
<li><h3 id="23-5-事务"><a href="#23-5-事务" class="headerlink" title="23.5 事务"></a>23.5 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-5-%E4%BA%8B%E5%8A%A1">事务</a></h3></li>
<li><h3 id="23-6-批处理"><a href="#23-6-批处理" class="headerlink" title="23.6 批处理"></a>23.6 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-6-%E6%89%B9%E5%A4%84%E7%90%86">批处理</a></h3><ul>
<li><h4 id="23-6-1-说明"><a href="#23-6-1-说明" class="headerlink" title="23.6.1 说明"></a>23.6.1 说明</h4></li>
</ul>
</li>
<li><h3 id="23-7-数据库连接池"><a href="#23-7-数据库连接池" class="headerlink" title="23.7 数据库连接池"></a>23.7 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-7-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0">数据库连接池</a></h3><ul>
<li><h4 id="23-7-1-C3P0"><a href="#23-7-1-C3P0" class="headerlink" title="23.7.1 C3P0"></a>23.7.1 C3P0</h4></li>
<li><h4 id="23-7-2-Druid（德鲁伊）连接池"><a href="#23-7-2-Druid（德鲁伊）连接池" class="headerlink" title="23.7.2 Druid（德鲁伊）连接池"></a>23.7.2 Druid（德鲁伊）连接池</h4></li>
</ul>
</li>
<li><h3 id="23-8-Apache-DbUtils"><a href="#23-8-Apache-DbUtils" class="headerlink" title="23.8 Apache - DbUtils"></a>23.8 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-8-Apache-DbUtils">Apache - DbUtils</a></h3><ul>
<li><h4 id="23-8-1-Apache-DbUtils-常用方法"><a href="#23-8-1-Apache-DbUtils-常用方法" class="headerlink" title="23.8.1 Apache-DbUtils 常用方法"></a>23.8.1 Apache-DbUtils 常用方法</h4></li>
</ul>
</li>
<li><h3 id="23-9-BasicDAO"><a href="#23-9-BasicDAO" class="headerlink" title="23.9 BasicDAO"></a>23.9 <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-9-BasicDAO">BasicDAO</a></h3></li>
</ul>
<hr>
<h2 id="24-项目：满汉楼"><a href="#24-项目：满汉楼" class="headerlink" title="24 项目：满汉楼"></a>24 <a href="2022/02/26/24%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E6%BB%A1%E6%B1%89%E6%A5%BC/">项目：满汉楼</a></h2><hr>
<h2 id="25-正则表达式"><a href="#25-正则表达式" class="headerlink" title="25 正则表达式"></a>25 <a href="2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a></h2><ul>
<li><h3 id="25-1-语法"><a href="#25-1-语法" class="headerlink" title="25.1 语法"></a>25.1 <a href="2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#25-1-%E8%AF%AD%E6%B3%95">语法</a></h3><ul>
<li><h4 id="25-1-1-转义符号"><a href="#25-1-1-转义符号" class="headerlink" title="25.1.1 转义符号 \"></a>25.1.1 转义符号 <code>\</code></h4></li>
<li><h4 id="25-1-2-字符匹配符"><a href="#25-1-2-字符匹配符" class="headerlink" title="25.1.2 字符匹配符"></a>25.1.2 字符匹配符</h4></li>
<li><h4 id="25-1-3-选择匹配符"><a href="#25-1-3-选择匹配符" class="headerlink" title="25.1.3 选择匹配符 |"></a>25.1.3 选择匹配符 <code>|</code></h4></li>
<li><h4 id="25-1-4-限定符"><a href="#25-1-4-限定符" class="headerlink" title="25.1.4 限定符"></a>25.1.4 限定符</h4></li>
<li><h4 id="25-1-5-定位符"><a href="#25-1-5-定位符" class="headerlink" title="25.1.5 定位符"></a>25.1.5 定位符</h4></li>
<li><h4 id="25-1-6-分组"><a href="#25-1-6-分组" class="headerlink" title="25.1.6 分组"></a>25.1.6 分组</h4></li>
<li><h4 id="25-1-7-非捕获分组"><a href="#25-1-7-非捕获分组" class="headerlink" title="25.1.7 非捕获分组"></a>25.1.7 非捕获分组</h4></li>
</ul>
</li>
<li><h3 id="25-2-常用类"><a href="#25-2-常用类" class="headerlink" title="25.2 常用类"></a>25.2 <a href="2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#25-2-%E5%B8%B8%E7%94%A8%E7%B1%BB">常用类</a></h3></li>
<li><h3 id="25-3-分组、捕获、反向引用"><a href="#25-3-分组、捕获、反向引用" class="headerlink" title="25.3 分组、捕获、反向引用"></a>25.3 <a href="2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#25-3-%E5%88%86%E7%BB%84%E3%80%81%E6%8D%95%E8%8E%B7%E3%80%81%E5%8F%8D%E5%90%91%E5%BC%95%E7%94%A8">分组、捕获、反向引用</a></h3></li>
<li><h3 id="25-4-在-String-中使用正则表达式"><a href="#25-4-在-String-中使用正则表达式" class="headerlink" title="25.4 在 String 中使用正则表达式"></a>25.4 <a href="2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#25-4-%E5%9C%A8-String-%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">在 String 中使用正则表达式</a></h3></li>
</ul>
<hr>
<h2 id="26-算法入门"><a href="#26-算法入门" class="headerlink" title="26 算法入门"></a>26 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/">算法入门</a></h2><ul>
<li><h3 id="26-1-算法的执行时间"><a href="#26-1-算法的执行时间" class="headerlink" title="26.1 算法的执行时间"></a>26.1 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-1-%E7%AE%97%E6%B3%95%E7%9A%84%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4">算法的执行时间</a></h3><ul>
<li><h4 id="26-1-1-时间复杂度"><a href="#26-1-1-时间复杂度" class="headerlink" title="26.1.1 时间复杂度"></a>26.1.1 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-1-1-%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6">时间复杂度</a></h4></li>
</ul>
</li>
<li><h3 id="26-2-常用的算法"><a href="#26-2-常用的算法" class="headerlink" title="26.2 常用的算法"></a>26.2 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-%E5%B8%B8%E7%94%A8%E7%9A%84%E7%AE%97%E6%B3%95">常用的算法</a></h3><ul>
<li><h4 id="26-2-1-二分查找算法"><a href="#26-2-1-二分查找算法" class="headerlink" title="26.2.1 二分查找算法"></a>26.2.1 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-1-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95">二分查找算法</a></h4></li>
<li><h4 id="26-2-2-分治算法"><a href="#26-2-2-分治算法" class="headerlink" title="26.2.2 分治算法"></a>26.2.2 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-2-%E5%88%86%E6%B2%BB%E7%AE%97%E6%B3%95">分治算法</a></h4></li>
<li><h4 id="26-2-3-动态规划"><a href="#26-2-3-动态规划" class="headerlink" title="26.2.3 动态规划"></a>26.2.3 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-3-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92">动态规划</a></h4></li>
<li><h4 id="26-2-4-KMP-算法"><a href="#26-2-4-KMP-算法" class="headerlink" title="26.2.4 KMP 算法"></a>26.2.4 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-4-KMP-%E7%AE%97%E6%B3%95">KMP 算法</a></h4></li>
<li><h4 id="26-2-5-贪心算法"><a href="#26-2-5-贪心算法" class="headerlink" title="26.2.5 贪心算法"></a>26.2.5 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-5-%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95">贪心算法</a></h4></li>
<li><h4 id="26-2-6-普里姆算法"><a href="#26-2-6-普里姆算法" class="headerlink" title="26.2.6 普里姆算法"></a>26.2.6 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-6-%E6%99%AE%E9%87%8C%E5%A7%86%E7%AE%97%E6%B3%95">普里姆算法</a></h4></li>
<li><h4 id="26-2-7-克鲁斯卡尔算法"><a href="#26-2-7-克鲁斯卡尔算法" class="headerlink" title="26.2.7 克鲁斯卡尔算法"></a>26.2.7 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-7-%E5%85%8B%E9%B2%81%E6%96%AF%E5%8D%A1%E5%B0%94%E7%AE%97%E6%B3%95">克鲁斯卡尔算法</a></h4></li>
<li><h4 id="26-2-8-迪杰斯特拉算法"><a href="#26-2-8-迪杰斯特拉算法" class="headerlink" title="26.2.8 迪杰斯特拉算法"></a>26.2.8 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-8-%E8%BF%AA%E6%9D%B0%E6%96%AF%E7%89%B9%E6%8B%89%E7%AE%97%E6%B3%95">迪杰斯特拉算法</a></h4></li>
<li><h4 id="26-2-9-弗洛伊德算法"><a href="#26-2-9-弗洛伊德算法" class="headerlink" title="26.2.9 弗洛伊德算法"></a>26.2.9 <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#26-2-9-%E5%BC%97%E6%B4%9B%E4%BC%8A%E5%BE%B7%E7%AE%97%E6%B3%95">弗洛伊德算法</a></h4></li>
</ul>
</li>
<li><h3 id="附录：骑士周游问题"><a href="#附录：骑士周游问题" class="headerlink" title="附录：骑士周游问题"></a>附录：<a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#%E9%AA%91%E5%A3%AB%E5%91%A8%E6%B8%B8%E9%97%AE%E9%A2%98">骑士周游问题</a></h3></li>
</ul>
<hr>
<p>Java 入门部分 结束</p>
<p>—— Melody 2021.11.22 5:13 ~ 2022.3.7 19:34</p>
<h2 id="27-Java-8-新特性"><a href="#27-Java-8-新特性" class="headerlink" title="27 Java 8 新特性"></a>27 <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/">Java 8 新特性</a></h2><ul>
<li><h3 id="27-1-Lambda-表达式"><a href="#27-1-Lambda-表达式" class="headerlink" title="27.1 Lambda 表达式"></a>27.1 <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/#27-1-Lambda-%E8%A1%A8%E8%BE%BE%E5%BC%8F">Lambda 表达式</a></h3><ul>
<li><h4 id="27-1-1-Lambda-表达式的使用"><a href="#27-1-1-Lambda-表达式的使用" class="headerlink" title="27.1.1 Lambda 表达式的使用"></a>27.1.1 Lambda 表达式的使用</h4></li>
</ul>
</li>
<li><h3 id="27-2-函数式接口"><a href="#27-2-函数式接口" class="headerlink" title="27.2 函数式接口"></a>27.2 <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/#27-2-%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3">函数式接口</a></h3><ul>
<li><h4 id="27-2-1-Java-内置的函数式接口"><a href="#27-2-1-Java-内置的函数式接口" class="headerlink" title="27.2.1 Java 内置的函数式接口"></a>27.2.1 Java 内置的函数式接口</h4></li>
</ul>
</li>
<li><h3 id="27-3-方法引用和构造器引用"><a href="#27-3-方法引用和构造器引用" class="headerlink" title="27.3 方法引用和构造器引用"></a>27.3 <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/#27-3-%E6%96%B9%E6%B3%95%E5%BC%95%E7%94%A8%E5%92%8C%E6%9E%84%E9%80%A0%E5%99%A8%E5%BC%95%E7%94%A8">方法引用和构造器引用</a></h3><ul>
<li><h4 id="27-3-1-方法引用"><a href="#27-3-1-方法引用" class="headerlink" title="27.3.1 方法引用"></a>27.3.1 方法引用</h4></li>
<li><h4 id="27-3-2-构造器引用"><a href="#27-3-2-构造器引用" class="headerlink" title="27.3.2 构造器引用"></a>27.3.2 构造器引用</h4></li>
<li><h4 id="27-3-3-数组引用"><a href="#27-3-3-数组引用" class="headerlink" title="27.3.3 数组引用"></a>27.3.3 数组引用</h4></li>
</ul>
</li>
<li><h3 id="27-4-Stream-API"><a href="#27-4-Stream-API" class="headerlink" title="27.4 Stream API"></a>27.4 <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/#27-4-Stream-API">Stream API</a></h3><ul>
<li><h4 id="27-4-1-什么是-Stream"><a href="#27-4-1-什么是-Stream" class="headerlink" title="27.4.1 什么是 Stream"></a>27.4.1 什么是 Stream</h4></li>
<li><h4 id="27-4-2-Stream-操作步骤"><a href="#27-4-2-Stream-操作步骤" class="headerlink" title="27.4.2 Stream 操作步骤"></a>27.4.2 Stream 操作步骤</h4><ul>
<li><h5 id="27-4-2-1-创建-Stream"><a href="#27-4-2-1-创建-Stream" class="headerlink" title="27.4.2.1 创建 Stream"></a>27.4.2.1 创建 Stream</h5></li>
<li><h5 id="27-4-2-2-中间操作"><a href="#27-4-2-2-中间操作" class="headerlink" title="27.4.2.2 中间操作"></a>27.4.2.2 中间操作</h5></li>
<li><h5 id="27-4-2-3-终止操作"><a href="#27-4-2-3-终止操作" class="headerlink" title="27.4.2.3 终止操作"></a>27.4.2.3 终止操作</h5></li>
</ul>
</li>
</ul>
</li>
<li><h3 id="27-5-Optional-类"><a href="#27-5-Optional-类" class="headerlink" title="27.5 Optional 类"></a>27.5 <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/#27-5-Optional-%E7%B1%BB">Optional 类</a></h3></li>
</ul>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/11/20/0%20%E7%9B%AE%E5%BD%95/" data-id="claq4namk0005p4tfa91s7uku" data-title="&lt;Java&gt;目录" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%9B%AE%E5%BD%95/" rel="tag">目录</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/10/16/hello-world/" class="article-date">
  <time class="dt-published" datetime="2022-10-15T18:15:10.163Z" itemprop="datePublished">2022-10-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/10/16/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/16/hello-world/" data-id="claq4nan7002gp4tfcg2s1fr0" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-26 算法入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/" class="article-date">
  <time class="dt-published" datetime="2022-06-02T16:00:00.000Z" itemprop="datePublished">2022-06-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/">&lt;Java&gt;26 算法入门</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="26-算法初级"><a href="#26-算法初级" class="headerlink" title="26 算法初级"></a>26 算法初级</h1><h2 id="26-1-算法的执行时间"><a href="#26-1-算法的执行时间" class="headerlink" title="26.1 算法的执行时间"></a>26.1 算法的执行时间</h2><blockquote>
<p>度量一个算法执行时间的方法：</p>
<ul>
<li><p>事后统计方法</p>
<p>该方法可行，但需要实际运行该程序，并且结果受环境因素影响。</p>
</li>
<li><p>事前估算方法</p>
<p>通过分析算法的时间复杂度来判断哪个算法更优</p>
</li>
</ul>
</blockquote>
<h4 id="时间频度"><a href="#时间频度" class="headerlink" title="时间频度"></a>时间频度</h4><p>算法花费的时间与算法中语句的执行次数成正相关。算法中语句执行次数越多，其花费时间也就越多。</p>
<p>一个算法中的语句执行次数称为 时间频度（语句频度），记为 T(n)</p>
<p>举例说明（计算 1 - 100 内所有整数之和）：</p>
<ul>
<li><p>方法一：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    result += i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>该方法执行了 100 次计算，因此其时间复杂度 T(n) &#x3D; n</p>
</li>
<li><p>方法二：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> result;</span><br><span class="line">result = (<span class="number">1</span> + n) * (n / <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>该方法执行了 1 次计算，因此其时间复杂度 T(n) &#x3D; 1</p>
</li>
</ul>
<h3 id="26-1-1-时间复杂度"><a href="#26-1-1-时间复杂度" class="headerlink" title="26.1.1 时间复杂度"></a>26.1.1 时间复杂度</h3><p>一般情况下，算法中的基本操作语句的重复执行次数是问题规模 n 的某个函数，用 T(n) 表示。</p>
<p>若有某个辅助函数 f(n)，使得当 n 趋近于无穷大时，T(n) &#x2F; f(n) 的极限值为不等于零的常数，则称 f(n) 为 T(n) 的同量级函数。记作：T(n) &#x3D; O(f(n))。</p>
<p>称 O(f(n)) 为算法的渐进时间复杂度，简称时间复杂度。</p>
<p>如：T(3n<sup>2</sup>+2n-1) 的时间复杂度为 O(n<sup>2</sup>)</p>
<p><strong>常见的时间复杂度（从小到大排列）：</strong></p>
<ul>
<li>常数阶 O(1)</li>
<li>对数阶 O(㏒<sub>k</sub>n)</li>
<li>线性阶 O(n) </li>
<li>线性对数阶 O(n㏒<sub>k</sub>n) </li>
<li>平方阶 O(n<sup>2</sup>)</li>
<li>立方阶 O(n<sup>3</sup>)</li>
<li>k 次方阶 O(n<sup>k</sup>)</li>
<li>指数阶 O(2<sup>n</sup>)</li>
</ul>
<p><strong>计算时间复杂度的方法：</strong></p>
<ol>
<li>用常数 1 代替运行时间中的加法常数</li>
<li>修改后的运行次数函数中，只保留最高阶项</li>
<li>去除最高阶项的系数</li>
</ol>
<p><strong>平均时间复杂度、最坏时间复杂度：</strong></p>
<ul>
<li><p>平均时间复杂度：指所有可能的输入实例以等概率出现的情况下，该算法的运行时间</p>
</li>
<li><p>最坏时间复杂度：最坏情况下的时间复杂度。</p>
<p>一般讨论时间复杂度都是讨论最坏时间复杂度。原因是：最坏时间复杂度是算法在任何输入实例上运行时间的界限。这就保证了算法运行时间不会比最坏情况更长。</p>
<p>最坏时间复杂度和平均时间复杂度也许不一致。这和具体算法有关。</p>
</li>
</ul>
<h4 id="算法的空间复杂度"><a href="#算法的空间复杂度" class="headerlink" title="算法的空间复杂度"></a>算法的空间复杂度</h4><p>类似于时间复杂度的讨论，一个算法的空间复杂度定义为该算法所耗费的存储空间。它也是问题规模 n 的函数。</p>
<p>空间复杂度是对一个算法在运行过程中临时占用存储空间大小的量度。有的算法需要占用的临时工作单元数与问题规模 n 相关。</p>
<p>在做算法分析时，<strong>主要讨论的是时间复杂度</strong>。从用户体验上看，更看重程序执行的速度。一些缓存产品和算法本质是用空间换时间。</p>
<h2 id="26-2-常用的算法"><a href="#26-2-常用的算法" class="headerlink" title="26.2 常用的算法"></a>26.2 常用的算法</h2><h3 id="26-2-1-二分查找算法"><a href="#26-2-1-二分查找算法" class="headerlink" title="26.2.1 二分查找算法"></a>26.2.1 二分查找算法</h3><p>二分查找只适用于从有序数列中进行查找。其运行时间为 O(㏒<sub>2</sub>n)</p>
<p><em><strong>——二分查找，见 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-3-2-%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE">[5.3.2 二分查找]</a></strong></em></p>
<h4 id="一个用到二分查找算法的典型题目"><a href="#一个用到二分查找算法的典型题目" class="headerlink" title="一个用到二分查找算法的典型题目"></a>一个用到二分查找算法的典型题目</h4><blockquote>
<p><strong><a target="_blank" rel="noopener" href="https://leetcode.cn/problems/koko-eating-bananas/">爱吃香蕉的珂珂</a></strong></p>
<p>珂珂喜欢吃香蕉。这里有 n 堆香蕉，第 i 堆中有 piles[i] 根香蕉。警卫已经离开了，将在 h 小时后回来。</p>
<p>珂珂可以决定她吃香蕉的速度 k （单位：根&#x2F;小时）。每个小时，她将会选择一堆香蕉，从中吃掉 k 根。如果这堆香蕉少于 k 根，她将吃掉这堆的所有香蕉，然后这一小时内不会再吃更多的香蕉。  </p>
<p>珂珂喜欢慢慢吃，但仍然想在警卫回来前吃掉所有的香蕉。</p>
<p>返回她可以在 h 小时内吃掉所有香蕉的最小速度 k（k 为整数）。</p>
</blockquote>
<p><strong>题解：</strong></p>
<p>注意到，随着 k 的增加，吃光香蕉的用时 t 随之减少。取食数量 k 与进食总时间 t 呈线性相关。</p>
<p>因此，可以使用二分查找算法，找出 t &#x3D;&#x3D; h 时，k 的最小取值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minEatingSpeed</span><span class="params">(<span class="type">int</span>[] piles, <span class="type">int</span> h)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">0</span>;			<span class="comment">// k 可能取到的最大值。该值等于：香蕉堆中香蕉数量的最大值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> <span class="number">0</span>;			<span class="comment">// k 可能取到的最小值。该值等于：香蕉总数 / 规定时间</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;			<span class="comment">// 香蕉总数</span></span><br><span class="line">        <span class="comment">/* 进行一次遍历，完成对 max、min、sum 的初始化 */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> n : piles) &#123;</span><br><span class="line">            sum += n;</span><br><span class="line">            <span class="keyword">if</span> (max &lt; n) max = n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 由于每堆香蕉至少需要 1 小时，当 piles.length == h 时，k 是那个香蕉堆最大值 */</span></span><br><span class="line">        <span class="keyword">if</span> (piles.length == h) <span class="keyword">return</span> max;</span><br><span class="line">        min = (sum + h - <span class="number">1</span>) / h;	<span class="comment">// 这里是 int 除法的向上取整</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 二分查找，如果在 p 情况下超时（吃不完香蕉），说明 k &gt; p</span></span><br><span class="line"><span class="comment">        	如果在 p 情况下提前吃完，说明 k &lt; p </span></span><br><span class="line"><span class="comment">        	如果恰好吃完，由于要求返回那个最小 k 值，我们仍要在 &lt; p 的范围内查找 */</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> min;</span><br><span class="line">        <span class="keyword">while</span> (max &gt;= min) &#123;</span><br><span class="line">            p = (max + min) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (check(piles, p) &lt;= h) max = p - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> min = p + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 计算在吃 n 根的情况下，需要用时多久吃完 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span>[] piles, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i : piles) &#123;</span><br><span class="line">            ret += (i + n - <span class="number">1</span>) / n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="26-2-2-分治算法"><a href="#26-2-2-分治算法" class="headerlink" title="26.2.2 分治算法"></a>26.2.2 分治算法</h3><p>分治算法是一种重要算法。其核心思想是 <strong>分而治之</strong>。</p>
<p>将一个复杂问题分为多个子问题，再将子问题分为更小的子问题。直到那些子问题都能简单地直接得解，原问题的解即子问题解的组合。</p>
<p>该算法也是很多高效算法的基础，如排序算法（快速排序、归并排序），傅立叶变换（快速傅立叶变换）等。</p>
<h3 id="26-2-3-动态规划"><a href="#26-2-3-动态规划" class="headerlink" title="26.2.3 动态规划"></a>26.2.3 动态规划</h3><p>动态规划的核心思想是：将大问题划分为小问题进行解决，从而一步步获取最优解</p>
<p>与分治法不同的是，适用于动态规划求解的问题，其分解得到的子问题往往不是互相独立的。下一子阶段的求解往往是建立在上一子阶段解的基础上的。</p>
<h4 id="一个用到动态规划的典型题目："><a href="#一个用到动态规划的典型题目：" class="headerlink" title="一个用到动态规划的典型题目："></a>一个用到动态规划的典型题目：</h4><blockquote>
<p><strong><a target="_blank" rel="noopener" href="https://leetcode.cn/contest/weekly-contest-298/problems/selling-pieces-of-wood/">卖木块</a></strong></p>
<p>给你两个整数 <code>m</code> 和 <code>n</code> ，分别表示一块矩形木块的高和宽。同时给你一个二维整数数组 <code>prices</code> ，其中 <code>prices[i] = [hi, wi, pricei]</code> 表示你可以以 <code>pricei</code> 元的价格卖一块高为 <code>hi</code> 宽为 <code>wi</code> 的矩形木块。</p>
<p>每一次操作中，你必须按下述方式之一执行切割操作，以得到两块更小的矩形木块：</p>
<ul>
<li>沿垂直方向按高度 <strong>完全</strong> 切割木块，或</li>
<li>沿水平方向按宽度 <strong>完全</strong> 切割木块</li>
</ul>
<p>在将一块木块切成若干小木块后，你可以根据 <code>prices</code> 卖木块。你可以卖多块同样尺寸的木块。你不需要将所有小木块都卖出去。你 <strong>不能</strong> 旋转切好后木块的高和宽。</p>
<p>请你返回切割一块大小为 <code>m x n</code> 的木块后，能得到的 <strong>最多</strong> 钱数。</p>
<p>注意你可以切割木块任意次。</p>
</blockquote>
<p><strong>题解：</strong></p>
<p>我们可以模拟切分木块的过程，从而得到答案。</p>
<p>对于任意木块 m × n，我们可以将其切开。此时该木块的价值 V 等于两个子木块的价值和。具体来说：</p>
<ul>
<li>沿横向切开时，木块价值 V(m, n) &#x3D; V(i, n) + V(m - i, n)</li>
<li>沿纵向切开时，木块价值 V(m, n) &#x3D; V(m, i) + V(m, n - i)</li>
<li>也可以选择不切开，此时木块价值为 prices(m, n)</li>
</ul>
<p>一块木块的价值是上述三种情况中的最大值。</p>
<p>我们可以维护一个数组，从最小木块开始统计那些木块的价值。直到统计到最大木块时，那个值即是答案。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">sellingWood</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n, <span class="type">int</span>[][] prices)</span> &#123;</span><br><span class="line">        <span class="comment">/* 将那些不分割的情况记录 */</span></span><br><span class="line">        <span class="type">long</span>[][] val = <span class="keyword">new</span> <span class="title class_">long</span>[m + <span class="number">1</span>][n + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] ints : prices) val[ints[<span class="number">0</span>]][ints[<span class="number">1</span>]] = ints[<span class="number">2</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 最小的高度开始，统计木块价值 */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="comment">/* 从最小的宽度开始，统计木块的价值 */</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                <span class="comment">/* 在该高度纵切 */</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">1</span>; k &lt;= j - k; k++) &#123;</span><br><span class="line">                    <span class="type">long</span> <span class="variable">temp</span> <span class="operator">=</span> val[i][k] + val[i][j - k];</span><br><span class="line">                    <span class="keyword">if</span> (temp &gt; val[i][j]) val[i][j] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/* 在该宽度横切 */</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> <span class="number">1</span>; u &lt;= i - u; u++) &#123;</span><br><span class="line">                    <span class="type">long</span> <span class="variable">temp</span> <span class="operator">=</span> val[i - u][j] + val[u][j];</span><br><span class="line">                    <span class="keyword">if</span> (temp &gt; val[i][j]) val[i][j] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> val[m][n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="26-2-4-KMP-算法"><a href="#26-2-4-KMP-算法" class="headerlink" title="26.2.4 KMP 算法"></a>26.2.4 KMP 算法</h3><p>KMP（Knuth-Morris-Pratt，字符串查找算法），该算法以提出该算法的三人姓名命名，是一个解决查找 模式字符串 在 文本中 出现位置的经典算法。</p>
<p>KMP 算法利用前面判断过的信息，通过一个 next 数组（部分搜索池），保存模式串中，前后最长公共子序列的长度。每次回溯时，通过 next 数组找到前面匹配过的位置，省去了大量计算时间。</p>
<p>在 KMP 算法里，源串指针永远不会向前回溯，而对象串指针在当前位置匹配成功时后移，匹配失败时前移。</p>
<h4 id="KMP-算法步骤"><a href="#KMP-算法步骤" class="headerlink" title="KMP 算法步骤"></a>KMP 算法步骤</h4><p>假定我们的对象串是 <code>String tar = &quot;ABCDABD&quot;</code> </p>
<p>去匹配源串 <code>String ori = &quot;ABCDABCDABCDABDADD&quot;</code></p>
<ol>
<li><p>根据对象串，初始化一个部分匹配池。该池中的第 i 位代表匹配进行到此处时，已匹配过的部分与对象串进行自匹配的结果。</p>
<table>
    <tr>
        <th>搜索词</th>
        <td>A</td>
        <td>B</td>
        <td>C</td>
        <td>D</td>
        <td>A</td>
        <td>B</td>
        <td>D</td>
    </tr>
    <tr>
        <th>部分匹配值</th>
        <td>-1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>1</td>
    </tr>
</table>
</li>
<li><p>让源串指针和对象串指针指向各自开头。尝试匹配那些指针指向的字符。</p>
</li>
<li><p>出现字符匹配时，向后移动源串指针和对象串指针，继续下一步匹配。</p>
<p>出现不匹配时，把对象指针移动到部分匹配池指示的位置，继续尝试匹配。</p>
<p>第一个字符都不匹配时，向后移动源串指针，对象串会从头开始匹配。</p>
</li>
<li><p>对象串指针指向对象串末尾时，即匹配成功。源串指针指向源串末尾时，即匹配失败。</p>
</li>
</ol>
<h4 id="实现-KMP-算法"><a href="#实现-KMP-算法" class="headerlink" title="实现 KMP 算法"></a>实现 KMP 算法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">KMP</span><span class="params">(String ori, String tar)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (tar == <span class="literal">null</span> || ori == <span class="literal">null</span> || tar.length() &gt; ori.length()) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span>[] ts = tar.toCharArray();        <span class="comment">// 对象字符串</span></span><br><span class="line">    <span class="type">char</span>[] os = ori.toCharArray();        <span class="comment">// 源字符串</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 初始化部分匹配池 */</span></span><br><span class="line">    <span class="type">int</span>[] list = <span class="keyword">new</span> <span class="title class_">int</span>[ts.length];</span><br><span class="line">    list[<span class="number">0</span>] = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>, k = -<span class="number">1</span>; j &lt; list.length-<span class="number">1</span>; ) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k == -<span class="number">1</span> || ts[j] == ts[k]) list[++j] = list[++k] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> k = list[k];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 源串指针 op、对象串指针 tp */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">op</span> <span class="operator">=</span> <span class="number">0</span>, tp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 开始匹配 */</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">/* 对象串指针指向对象串末尾时，即匹配成功 */</span></span><br><span class="line">        <span class="keyword">if</span> (tp &gt;= ts.length) <span class="keyword">return</span> op - ts.length;</span><br><span class="line">        <span class="comment">/* 源串指针指向源串末尾时，即匹配失败 */</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op &gt;= os.length) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 匹配时，后移源串指针和对象串指针，继续匹配。</span></span><br><span class="line"><span class="comment">                出现不匹配时，把对象指针移动到部分匹配池指示的位置，并继续匹配。 */</span></span><br><span class="line">        <span class="keyword">while</span> (tp &gt;= <span class="number">0</span> &amp;&amp; ts[tp] != os[op]) tp = list[tp];</span><br><span class="line">        tp++;</span><br><span class="line">        op++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="26-2-5-贪心算法"><a href="#26-2-5-贪心算法" class="headerlink" title="26.2.5 贪心算法"></a>26.2.5 贪心算法</h3><p>贪心算法（贪婪算法）是指在对问题进行求解时，在每一步选择中都采取最好或最优的选择。从而希望结果是最好或最优的算法。</p>
<p>贪婪算法得到的结果不一定是最优结果，但都是相对接近最优的结果。</p>
<p><em><strong>——一个贪心算法的例子，见本章附录：<a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/#%E9%AA%91%E5%A3%AB%E5%91%A8%E6%B8%B8%E9%97%AE%E9%A2%98">[骑士周游问题]</a></strong></em></p>
<h3 id="26-2-6-普里姆算法"><a href="#26-2-6-普里姆算法" class="headerlink" title="26.2.6 普里姆算法"></a>26.2.6 普里姆算法</h3><p>最小生成树问题（MST，Minimum Cost Spanning Tree）：给定一个带权的无向连通图，如何选取一棵生成树，时树上所有边的权总和最小。</p>
<p>要解决最小生成树问题，可以采取 <strong>普里姆算法（Prim）</strong></p>
<h4 id="普里姆算法步骤："><a href="#普里姆算法步骤：" class="headerlink" title="普里姆算法步骤："></a>普里姆算法步骤：</h4><p>示范一个联通网图的格式。后面算法中的 <code>int[][] map</code> 都是该格式的联通网：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[][] map = <span class="keyword">new</span> <span class="title class_">int</span>[][]&#123;</span><br><span class="line">        &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>&#125;,</span><br><span class="line">        &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">        &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>&#125;,</span><br><span class="line">        &#123;<span class="number">4</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">7</span>&#125;,</span><br><span class="line">        &#123;<span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> map.length;</span><br></pre></td></tr></table></figure>

<p>网点编号为 [0, n)，n 为网点数量。<code>map[a][b]</code> 是网点 a 与网点 b 间路径的权（0 为不连通）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A((0))--1---B((1))</span><br><span class="line">A--2---C((2))</span><br><span class="line">B--3---C</span><br><span class="line">A--4---D((3))--6---C</span><br><span class="line">A--5---E((4))--7---D</span><br></pre></td></tr></table></figure>

<ol>
<li>从任意顶点 i（0 &lt;= i &lt; n）起构造最小生成树。将该顶点标记为已访问</li>
<li>如果联通网图中存在剩余顶点，则记录那些与已访问顶点相连的边中，权值最小的边（避免产生回路），并将该顶点加入已访问集合。</li>
<li>联通网图中没有未访问节点时，即所有顶点都被联通</li>
</ol>
<h4 id="实现普里姆算法"><a href="#实现普里姆算法" class="headerlink" title="实现普里姆算法"></a>实现普里姆算法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][] prim(<span class="type">int</span>[][] map) &#123;</span><br><span class="line">    <span class="comment">/* 初始化 */</span></span><br><span class="line">    Set&lt;Integer&gt; visited = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();		<span class="comment">// 已访问集合</span></span><br><span class="line">    Set&lt;Integer&gt; remain = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();		<span class="comment">// 待访问集合</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> map.length;							<span class="comment">// 网点数量</span></span><br><span class="line">    <span class="type">int</span>[][] ret = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];				<span class="comment">// 极小联通子图</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; n; i++) remain.add(i);</span><br><span class="line">    visited.add(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 记录待访问集合与已访问集合的节点间，权值最小的边，并将该节点加入已访问集合 */</span></span><br><span class="line">    <span class="keyword">while</span> (!remain.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">point</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (Integer i : visited) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Integer j : remain) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">current</span> <span class="operator">=</span> map[i][j];</span><br><span class="line">                <span class="keyword">if</span> (current != <span class="number">0</span> &amp;&amp; (min == <span class="number">0</span> || current &lt; min)) &#123;</span><br><span class="line">                    min = current;</span><br><span class="line">                    point = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        visited.add(point);</span><br><span class="line">        remain.remove((Integer) point);</span><br><span class="line">        ret[y][x] = min;</span><br><span class="line">        ret[x][y] = min;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="26-2-7-克鲁斯卡尔算法"><a href="#26-2-7-克鲁斯卡尔算法" class="headerlink" title="26.2.7 克鲁斯卡尔算法"></a>26.2.7 克鲁斯卡尔算法</h3><p>解决最小生成树问题的另一种方法是 <strong>克鲁斯卡尔算法（Kruskal）</strong></p>
<h4 id="克鲁斯卡尔算法步骤"><a href="#克鲁斯卡尔算法步骤" class="headerlink" title="克鲁斯卡尔算法步骤"></a>克鲁斯卡尔算法步骤</h4><ol>
<li>构建一个只含 n 个节点的森林。</li>
<li>依照权值从小到大，从联通网中选择边加入森林（避免产生回路）。</li>
<li>直到森林变成一棵树为止，就完成了最小生成树</li>
</ol>
<h4 id="实现克鲁斯卡尔算法"><a href="#实现克鲁斯卡尔算法" class="headerlink" title="实现克鲁斯卡尔算法"></a>实现克鲁斯卡尔算法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][] kruskal(<span class="type">int</span>[][] map) &#123;</span><br><span class="line">    <span class="comment">/* 节点类（局部内部类） */</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Node</span>&#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">prev</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        Node <span class="title function_">getSuper</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (prev == <span class="literal">null</span>) <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> prev.getSuper();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> map.length;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 构建一个只含 n 个节点的森林 */</span></span><br><span class="line">    Node[] nodes = <span class="keyword">new</span> <span class="title class_">Node</span>[n];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) nodes[i] = <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">    <span class="type">int</span>[][] ret = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 将所有边进行初始化。将这些边加入一个优先级队列，以便从小到大取出</span></span><br><span class="line"><span class="comment">    	对于其中每一项 i 都有：i[0] 为权值，i[1]、i[2] 为该边连接的两个节点 */</span></span><br><span class="line">    PriorityQueue&lt;<span class="type">int</span>[]&gt; pq = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(Comparator.comparing(o -&gt; o[<span class="number">0</span>]));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> map[i][j];</span><br><span class="line">            <span class="keyword">if</span> (temp != <span class="number">0</span>) pq.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;temp, i, j&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 依照权值从小到大，从联通网中选择边加入森林</span></span><br><span class="line"><span class="comment">    	取出边时，通过比较两个顶点的顶级父节点是否相同，可以判断两顶点是否已经联通 */</span></span><br><span class="line">    <span class="keyword">while</span> (!pq.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span>[] temp = pq.poll();</span><br><span class="line">        <span class="type">Node</span> <span class="variable">a</span> <span class="operator">=</span> nodes[temp[<span class="number">1</span>]].getSuper();</span><br><span class="line">        <span class="type">Node</span> <span class="variable">b</span> <span class="operator">=</span> nodes[temp[<span class="number">2</span>]].getSuper();</span><br><span class="line">        <span class="keyword">if</span> (a != b) &#123;</span><br><span class="line">            b.prev = a;</span><br><span class="line">            ret[temp[<span class="number">1</span>]][temp[<span class="number">2</span>]] = temp[<span class="number">0</span>];</span><br><span class="line">            ret[temp[<span class="number">2</span>]][temp[<span class="number">1</span>]] = temp[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="26-2-8-迪杰斯特拉算法"><a href="#26-2-8-迪杰斯特拉算法" class="headerlink" title="26.2.8 迪杰斯特拉算法"></a>26.2.8 迪杰斯特拉算法</h3><p>要计算一个连通图内，某一节点到图中另一节点的最短路径，可以采用 <strong>迪杰斯特拉算法（Dijkstra）</strong></p>
<p>该算法是典型最短路径算法，采用广度优先搜索，以起始点为中心向外层层扩展，直到终点为止</p>
<h4 id="迪杰斯特拉算法步骤"><a href="#迪杰斯特拉算法步骤" class="headerlink" title="迪杰斯特拉算法步骤"></a>迪杰斯特拉算法步骤</h4><ol>
<li><p>设置出发点 v、顶点集合 V、距离集合 D。其中 v 为起始点，V 包含起始点外所有顶点，D[i] 表示 v 到 V[i] 的距离</p>
</li>
<li><p>找到 D[] 中的最小值 D[n] 和其对应的顶点 V[n]。此时D[n] 即为顶点 V[n] 到 v 的最小距离。</p>
</li>
<li><p>将 V[n] 设置为当前出发点，从 V 中移除 V[n]。</p>
<p>对 D 进行更新。D[i] 变成 (原本数值) 和 (当前顶点 v 与 V[i] 距离 + D[n]) 的较小一方数值</p>
<p>从 D 中移除 D[n]</p>
</li>
<li><p>重复 2 - 3，直到当前顶点变为终点。此时的行进距离即为最短路径</p>
</li>
</ol>
<h4 id="迪杰斯特拉算法实现"><a href="#迪杰斯特拉算法实现" class="headerlink" title="迪杰斯特拉算法实现"></a>迪杰斯特拉算法实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">dijkstra</span><span class="params">(<span class="type">int</span>[][] map, <span class="type">int</span> start, <span class="type">int</span> end)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (start == end) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/* 将顶点和边放入优先级队列，以便后续取出最短距离</span></span><br><span class="line"><span class="comment">    	对于其中任意元素 n 有：n[1] 为节点，n[0] 为 n[1] 与起始节点的最短距离 */</span></span><br><span class="line">    PriorityQueue&lt;<span class="type">int</span>[]&gt; pq = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(Comparator.comparing(o-&gt;o[<span class="number">0</span>]));</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> map.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == start) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> map[start][i];</span><br><span class="line">        pq.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;temp == <span class="number">0</span> ? Integer.MAX_VALUE : temp, i&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 取出那个最短路径和对应节点，对剩余元素进行更新 */</span></span><br><span class="line">    <span class="keyword">while</span> (!pq.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span>[] temp = pq.poll();</span><br><span class="line">        <span class="keyword">if</span> (temp[<span class="number">1</span>] == end) <span class="keyword">return</span> temp[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (temp[<span class="number">1</span>] == Integer.MAX_VALUE) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] flush : pq) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">dir</span> <span class="operator">=</span> map[flush[<span class="number">1</span>]][temp[<span class="number">1</span>]];</span><br><span class="line">            <span class="keyword">if</span> (dir != <span class="number">0</span> &amp;&amp; flush[<span class="number">0</span>] &gt; dir + temp[<span class="number">0</span>]) flush[<span class="number">0</span>] = dir + temp[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="26-2-9-弗洛伊德算法"><a href="#26-2-9-弗洛伊德算法" class="headerlink" title="26.2.9 弗洛伊德算法"></a>26.2.9 弗洛伊德算法</h3><p>另一种最短路径算法是 <strong>弗洛伊德算法（Floyd）</strong></p>
<p><strong><del>I count weights!</del></strong></p>
<p>迪杰斯特拉算法用于计算图中 <strong>某一顶点</strong> 到其他顶点的最短路径。</p>
<p>弗洛伊德算法用于计算图中 <strong>各个顶点</strong> 之间的最短路径。</p>
<h4 id="弗洛伊德算法步骤"><a href="#弗洛伊德算法步骤" class="headerlink" title="弗洛伊德算法步骤"></a>弗洛伊德算法步骤</h4><ol>
<li><p>对于任意顶点 a、b ，取任意中继节点 k，则 a、b 间最短路径 D(a,b) 是 [a、b 直接路径距离] 与 [D(a,k) + D(b,k)] 间的较小方数值</p>
</li>
<li><p>对于上面的 D(a,k) 和 D(b,k)，是以相同方式获得</p>
</li>
<li><p>要计算图中每个节点的最短路径，势必要用每个顶点（作为中继节点）对图进行更新。</p>
<p>用每个顶点进行更新时，对其他所有边进行更新。</p>
</li>
</ol>
<h4 id="实现弗洛伊德算法"><a href="#实现弗洛伊德算法" class="headerlink" title="实现弗洛伊德算法"></a>实现弗洛伊德算法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[][] floyd(<span class="type">int</span>[][] map) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> map.length;</span><br><span class="line">    <span class="type">int</span>[][] ret = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) ret[i] = Arrays.copyOf(map[i], n);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* 让每个节点做中继节点 */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 取出节点 a */</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="comment">/* a 不能是中继节点，而且必须与中继节点相连</span></span><br><span class="line"><span class="comment">            	此处，由于 i == j 时 map[i][j] == 0，所以省略了 i == j 的判断 */</span></span><br><span class="line">            <span class="type">int</span> part1;</span><br><span class="line">            <span class="keyword">if</span> ((part1 = ret[i][j]) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/* 取出节点 b */</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; j; k++) &#123;</span><br><span class="line">                <span class="comment">/* 对 b 的判断与对 a 的相同，即：不是中继节点，且与中继节点相连  */</span></span><br><span class="line">                <span class="type">int</span> part2;</span><br><span class="line">                <span class="keyword">if</span> ((part2 = ret[i][k]) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">edge</span> <span class="operator">=</span> ret[k][j];				<span class="comment">// a、b 的直接路径距离</span></span><br><span class="line">                part2 += part1;						<span class="comment">// 通过中继节点的路径距离</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment">/* 如有必要，进行更新 */</span></span><br><span class="line">                <span class="keyword">if</span> (edge == <span class="number">0</span> || edge &gt; part2) &#123;</span><br><span class="line">                    ret[k][j] = part2;</span><br><span class="line">                    ret[j][k] = part2;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="骑士周游问题"><a href="#骑士周游问题" class="headerlink" title="骑士周游问题"></a>骑士周游问题</h3><p>将一枚骑士棋子放在国际象棋棋盘上。使骑士按照行棋规则移动，要求每个方格只能进入一次，最终走遍棋盘上所有方格。</p>
<p>穷举法效率较低，可以利用贪心算法进行优化。</p>
<p>每次行棋前，计算那些目标点位上包含的行棋方法的数量。行棋时，从最低数量的点位开始尝试。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Chess</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[][] chess = <span class="literal">null</span>;		<span class="comment">// 棋盘。chess[y][x] == 0 表示该格未被走过，否则是已被走过</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[][] inner = <span class="literal">null</span>;		<span class="comment">// 数据棋盘。inner[y][x] 是 (x, y) 该格能通向几个未被走过的格子</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">goal</span> <span class="operator">=</span> -<span class="number">1</span>;				<span class="comment">// 本局游戏中，需要走过多少格子</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Comparator&lt;<span class="type">int</span>[]&gt; c = Comparator.comparing(o-&gt;inner[o[<span class="number">1</span>]][o[<span class="number">0</span>]]);</span><br><span class="line">    									<span class="comment">// 比较器，期待传入的是数组形式的点位：int[] o</span></span><br><span class="line">    									<span class="comment">// 其中 o.length == 2，o[0] 为横坐标 x，o[1] 为纵坐标 y</span></span><br><span class="line">    									<span class="comment">// 该比较器比较该 o 点位的 inner 值，即 inner[o[1]][o[0]]</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 进行一次马踏棋盘游戏 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">chess</span><span class="params">(<span class="type">int</span> width, <span class="type">int</span> height, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="comment">/* 对初始的参数进行检查 */</span></span><br><span class="line">        <span class="keyword">if</span> (width &lt; <span class="number">4</span> || width &gt; <span class="number">53</span> || height &lt; <span class="number">4</span> || height &gt; <span class="number">53</span> || x &lt; <span class="number">0</span> || x &gt; width || y &lt; <span class="number">0</span> || y &gt; height)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Illegal Chess Game&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 初始化参数 */</span></span><br><span class="line">        goal = width * height;</span><br><span class="line">        chess = <span class="keyword">new</span> <span class="title class_">int</span>[height][width];</span><br><span class="line">        inner = initialInner(width, height);</span><br><span class="line">        <span class="comment">/* 进行游戏。成功时输出棋盘，否则提示失败 */</span></span><br><span class="line">        System.out.println(act(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;x, y&#125;, <span class="number">1</span>) ? deepToString(chess) : <span class="string">&quot;失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 把棋子移动到该格。</span></span><br><span class="line"><span class="comment">        该格的坐标是 (p[0], p[1])，这是棋子走的第 step 步 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">act</span><span class="params">(<span class="type">int</span>[] p, <span class="type">int</span> step)</span> &#123;</span><br><span class="line">        <span class="comment">/* 把当前格子标记为已走过 */</span></span><br><span class="line">        chess[p[<span class="number">1</span>]][p[<span class="number">0</span>]] = step;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 如果走过了所有格子，则游戏结束 */</span></span><br><span class="line">        <span class="keyword">if</span> (step &gt;= goal) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        step++;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 查看有哪些能走的格子，将其放入一个优先级队列 */</span></span><br><span class="line">        <span class="type">int</span>[][] aims = aims(p[<span class="number">0</span>], p[<span class="number">1</span>]);</span><br><span class="line">        Queue&lt;<span class="type">int</span>[]&gt; q = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(c);    <span class="comment">// 这个比较器是前面定义的，比较 inner 值的那个比较器</span></span><br><span class="line">        Stack&lt;<span class="type">int</span>[]&gt; s = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] i : aims) &#123;</span><br><span class="line">            <span class="comment">/* 点位合法时，让那个 inner 值减少（因为当前格子不能走了），并让其入列 */</span></span><br><span class="line">            <span class="keyword">if</span> (check(i)) &#123;</span><br><span class="line">                inner[i[<span class="number">1</span>]][i[<span class="number">0</span>]]--;</span><br><span class="line">                s.push(i);</span><br><span class="line">                q.add(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 从 inner 较小的点位开始，试着向目标格移动棋子 */</span></span><br><span class="line">        <span class="keyword">while</span> (!q.isEmpty()) <span class="keyword">if</span> (act(q.poll(), step)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 进行到这里说明没有有效走法，我们将该格子重新标记为未走过，并返回上一格 */</span></span><br><span class="line">        chess[p[<span class="number">1</span>]][p[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] i : s) inner[i[<span class="number">1</span>]][i[<span class="number">0</span>]]++;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 初始化那个数据棋盘。该方法仅在进入游戏时调用一次 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] initialInner(<span class="type">int</span> width, <span class="type">int</span> height) &#123;</span><br><span class="line">        <span class="type">int</span>[][] inner = <span class="keyword">new</span> <span class="title class_">int</span>[height][width];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; height; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">red</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">div</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span> || i == height - <span class="number">2</span>) red = <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">0</span> || i == height - <span class="number">1</span>) div = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; width; j++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> red;</span><br><span class="line">                <span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> div;</span><br><span class="line">                <span class="keyword">if</span> (j == <span class="number">1</span> || j == width - <span class="number">2</span>) r += <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (j == <span class="number">0</span> || j == width - <span class="number">1</span>) d += <span class="number">1</span>;</span><br><span class="line">                inner[i][j] = (<span class="number">8</span> - r) &gt;&gt; (d);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> inner;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回从 (x, y) 点位能到达的所有点位构成的数组，但不保证数组中每个点位都有效 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span>[][] aims(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">        <span class="type">int</span>[][] ret = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">8</span>][<span class="number">2</span>];</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">rx</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">ry</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">            ret[j][<span class="number">0</span>] = x + (rx ? -<span class="number">1</span> : <span class="number">1</span>) * ((j + <span class="number">4</span>) / <span class="number">4</span>);</span><br><span class="line">            ret[j][<span class="number">1</span>] = y + (ry ? -<span class="number">1</span> : <span class="number">1</span>) * ((<span class="number">11</span> - j) / <span class="number">4</span>);</span><br><span class="line">            <span class="keyword">if</span> (ry = !ry) rx = !rx;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 检查该点位是否有效 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(<span class="type">int</span>[] i)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (i[<span class="number">0</span>] &lt; <span class="number">0</span> || i[<span class="number">1</span>] &lt; <span class="number">0</span> || i[<span class="number">1</span>] &gt;= inner.length || i[<span class="number">0</span>] &gt;= inner[i[<span class="number">1</span>]].length) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> chess[i[<span class="number">1</span>]][i[<span class="number">0</span>]] == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* 输出一个棋盘的信息 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">deepToString</span><span class="params">(<span class="type">int</span>[][] array)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] ints : array) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i : ints) sb.append(i).append(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            sb.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/" data-id="claq4nan1001lp4tf88hr133c" data-title="&lt;Java&gt;26 算法入门" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%A8%8B%E5%BA%8F/" rel="tag">程序</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-14 树" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/06/02/14%20%E6%A0%91/" class="article-date">
  <time class="dt-published" datetime="2022-06-01T16:00:00.000Z" itemprop="datePublished">2022-06-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/06/02/14%20%E6%A0%91/">&lt;Java&gt;14 树</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="14-树"><a href="#14-树" class="headerlink" title="14 树"></a>14 树</h1><h4 id="什么是树？"><a href="#什么是树？" class="headerlink" title="什么是树？"></a>什么是树？</h4><table>
    <tr align="center">
        <td></td>
        <td><b>结构严格派</b><br/><font color="#FF4000">唯一父节点和复数子节点</font></td>
        <td><b>结构中立派</b><br/>有前驱和后继关系就行</td>
        <td><b>结构自由派</b><br/>能存放内容就行</td>
    </tr>
    <tr align="center">
        <td><b>类型严格派</b><br/><font color="#FF4000">是一种数据结构</font></td>
        <td>二叉树是树</td>
        <td>链表也是树</td>
        <td>栈也是树</td>
    </tr>
    <tr align="center">
        <td><b>类型中立派</b><br/>和编程有关就行</td>
        <td>包也是树</td>
        <td>语句肯定是树</td>
        <td>标识符都是树</td>
    </tr>
    <tr align="center">
        <td><b>类型自由派</b><br/>和程序员有关就行</td>
        <td>wifi 当然是树</td>
        <td>衣服拉链也是树</td>
        <td>馄饨也是树！</td>
    </tr>
</table>


<h2 id="14-1-二叉树："><a href="#14-1-二叉树：" class="headerlink" title="14.1 二叉树："></a>14.1 二叉树：</h2><p><img src="img/Java_InputImage/%E6%A0%91%E7%BB%93%E6%9E%84%E5%9B%BE_14.1.png"></p>
<p><em>（树结构图_14.1）</em></p>
<ul>
<li><p><strong>二叉树：</strong>树有多种。每个节点最多只能有 2 个子节点的一种树的形式称为二叉树</p>
<p>二叉树的子节点分为 <font color="#FF0000"><strong>左节点</strong></font > 和 <font color="#5070FF"><strong>右节点</strong></font>。</p>
</li>
<li><p><strong>满二叉树：</strong>二叉树的 所有叶节点 都在 最后一层，且节点总数是 2<sup>n</sup> - 1</p>
</li>
<li><p><strong>完全二叉树：</strong>二叉树的 所有叶节点 都在 最后一层 和 倒数第二层，且最后一层的叶节点在左侧连续、倒数第二层的叶节点在右侧连续</p>
</li>
</ul>
<h4 id="二叉树的遍历："><a href="#二叉树的遍历：" class="headerlink" title="二叉树的遍历："></a>二叉树的遍历：</h4><ul>
<li><p><strong>前序遍历：</strong>先输出<font color="#EF9F00">父节点</font>，再遍历<font color="#FF3030">左子树</font>和<font color="#5070FF">右子树</font>。</p>
<p>自根节点起。先输出当前节点。再递归前序遍历左节点。那之后，递归前序遍历右节点。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;					<span class="comment">// 节点类</span></span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    Node left;</span><br><span class="line">    Node right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">traverse</span><span class="params">(Node root)</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    traverse(root, sb);</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">traverse</span><span class="params">(Node root, StringBuilder sb)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    sb.append(root.val).append(<span class="string">&quot; &quot;</span>);		<span class="comment">// 先输出父节点</span></span><br><span class="line">    traverse(root.left, sb);				<span class="comment">// 再遍历左子树</span></span><br><span class="line">    traverse(root.right, sb);				<span class="comment">// 再遍历右子树</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>中序遍历：</strong>先遍历<font color="#FF3030">左子树</font>，再输出<font color="#EF9F00">父节点</font>，再遍历<font color="#5070FF">右子树</font>。</p>
</li>
<li><p><strong>后序遍历：</strong>先遍历<font color="#FF3030">左子树</font>，再遍历<font color="#5070FF">右子树</font>，再输出<font color="#EF9F00">父节点</font>。</p>
</li>
</ul>
<h3 id="14-1-1-顺序存储二叉树"><a href="#14-1-1-顺序存储二叉树" class="headerlink" title="14.1.1 顺序存储二叉树"></a>14.1.1 顺序存储二叉树</h3><p>从数据存储来看，数组与树可以相互转换。数组可以转换成树，树也能转换成数组。</p>
<p>顺序存储二叉树通常只考虑完全二叉树。将数组转换成树后，将可以进行前序、中序、后序遍历。</p>
<p><strong>顺序存储二叉树的例子：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] array = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>该 array 的顺序存储二叉树为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A(0)---B(1)---C(3)</span><br><span class="line">A---a(2)---aa(5)</span><br><span class="line">B---D(4)</span><br><span class="line">a---ab(6)</span><br><span class="line">C---E(7)</span><br><span class="line">C---F(8)</span><br><span class="line">D---G(9)</span><br><span class="line">D---H(10)</span><br></pre></td></tr></table></figure>

<h4 id="顺序存储二叉树的转换："><a href="#顺序存储二叉树的转换：" class="headerlink" title="顺序存储二叉树的转换："></a>顺序存储二叉树的转换：</h4><ul>
<li><p>数组下标为 0 的元素放在根节点。</p>
</li>
<li><p>对于数组下标为 n 的元素，其左子节点的数组下标为 2 × n + 1、右子节点的数组下标为 2 × n + 2、父节点的数组下标为 (n - 1) &#x2F; 2</p>
<p>可以发现，所有左节点都是奇数下标，右节点都是偶数下标</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title function_">toTree</span><span class="params">(<span class="type">int</span>[] array)</span> &#123;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(array[<span class="number">0</span>]);</span><br><span class="line">    List&lt;Node&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Node&gt;();</span><br><span class="line">    list.add(root);									<span class="comment">// 数组下标为 0 的元素放在根节点。</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; array.length; i++) &#123;		<span class="comment">// 按照前述方法，创建每个元素节点，并放在对应父节点下</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(array[i]);</span><br><span class="line">        list.add(temp);</span><br><span class="line">        <span class="type">Node</span> <span class="variable">parent</span> <span class="operator">=</span> list.get((i - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) parent.right = temp;</span><br><span class="line">        <span class="keyword">else</span> parent.left = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line">    <span class="keyword">public</span> Node left;</span><br><span class="line">    <span class="keyword">public</span> Node right;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.val = val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上是一种显式的转换。也可以直接将数组视为抽象的顺序存储二叉树。</p>
<p>如：堆。<em><strong>——见 <a href="2021/11/27/5%20%E6%95%B0%E7%BB%84%E3%80%81%E6%8E%92%E5%BA%8F%E5%92%8C%E6%9F%A5%E6%89%BE/#5-4-8-%E5%A0%86%E6%8E%92%E5%BA%8F">[5.4.8 堆排序]</a></strong></em></p>
<h3 id="14-1-2-线索化二叉树"><a href="#14-1-2-线索化二叉树" class="headerlink" title="14.1.2 线索化二叉树"></a>14.1.2 线索化二叉树</h3><p>含有 n 各节点的二叉链表中，有 n + 1 个空指针域。利用这些空指针域，存放指向节点在某种遍历次序下的前驱和后继节点的指针，这种附加的指针称为 <strong>线索</strong>。加上了线索的二叉链表称为 <strong>线索链表</strong>，相应二叉树称为 <strong>线索二叉树</strong>。</p>
<p>线索二叉树可分为：前序线索二叉树、中序线索二叉树、后续线索二叉树。</p>
<p>线索化二叉树后，那些左节点和右节点既可能指向 自身的子树，也可能指向自身的 前驱 &#x2F; 后继 节点。因此，需要添加一组标记，以记录线索的种类。</p>
<p>这个遍历的场合，不能再使用递归方式遍历，而是改为线性方式遍历即可。</p>
<h3 id="14-1-3-赫夫曼树"><a href="#14-1-3-赫夫曼树" class="headerlink" title="14.1.3 赫夫曼树"></a>14.1.3 赫夫曼树</h3><p>给定 n 个权值作为 n 个叶节点，构造一棵二叉树。若该树的带权路径长度（WPL）最小，则称其为 <strong>最优二叉树</strong>（赫夫曼树、哈夫曼树、霍夫曼树）</p>
<ul>
<li><p>节点的带权路径长度：该节点的权 × 节点路径长度</p>
</li>
<li><p>树的带权路径长度：所有的叶结点的带权路径长度之和</p>
<p>赫夫曼树中，一定是权值较大的节点距离根更近。</p>
</li>
</ul>
<p><strong>赫夫曼树的例子：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A(NaN)---B(NaN)---C(14)</span><br><span class="line">B---b(NaN)---c(5)</span><br><span class="line">b---D(NaN)---E(1)</span><br><span class="line">D---F(2)</span><br><span class="line">A---a(NaN)---aa(16)</span><br><span class="line">a---ab(20)</span><br></pre></td></tr></table></figure>



<h4 id="生成赫夫曼树："><a href="#生成赫夫曼树：" class="headerlink" title="生成赫夫曼树："></a>生成赫夫曼树：</h4><ol>
<li>对数据进行排序。每个数据都可以创建一个节点</li>
<li>取出权值最小的两颗二叉树，合并为一棵新的二叉树。该二叉树权值是两棵子树的权值之和</li>
<li>将数据再次排序，重复合并步骤，直至剩余唯一的树，即为赫夫曼树</li>
</ol>
<h4 id="赫夫曼编码："><a href="#赫夫曼编码：" class="headerlink" title="赫夫曼编码："></a>赫夫曼编码：</h4><blockquote>
<p>赫夫曼编码是一种编码方式，是一种程序算法。赫夫曼编码是赫夫曼树在电讯通信中的经典应用之一。</p>
<p>赫夫曼编码广泛应用于数据文件压缩，其压缩率在 20% ~ 90% 间</p>
<p>赫夫曼编码是可变字长编码的一种。是老赫在 1952 年提出的编码方法，称为 “最佳编码”</p>
<p>赫夫曼编码是无损处理方案。由于赫夫曼编码是按字节处理数据，因此可以处理所有文件</p>
</blockquote>
<p>编码方式有三种：</p>
<ul>
<li><p><strong>定长编码：</strong></p>
<p>如 ASCII 码，其每个字符占用长度为固定 8 字节</p>
</li>
<li><p><strong>变长编码：</strong></p>
<p>对字符进行统计，按照各个字符出现的次数进行编码。出现次数越多，编码越小。</p>
<p>字符的编码不能是其他字符编码的前缀，这样的编码叫做前缀编码（消除二义性）。</p>
</li>
<li><p><strong>赫夫曼编码：</strong></p>
<p>按照字符的出现次数，构建赫夫曼树。之后，按照赫夫曼树结构，给字符规定编码。向左的路径记为 0，向右记为 1。</p>
<p>这样得到的编码，一定是前缀编码。因为那些字符节点都是叶节点。赫夫曼行啊赫夫曼！</p>
<p>之后，用规定的编码将指定字符串转化为字节数组。最后，传递字符数组即可。</p>
</li>
</ul>
<h5 id="实现赫夫曼编码："><a href="#实现赫夫曼编码：" class="headerlink" title="实现赫夫曼编码："></a>实现赫夫曼编码：</h5><p><em><strong>——见本章附录：[F1 实现赫夫曼编码&#x2F;解码]</strong></em></p>
<p><strong>注意事项：</strong></p>
<ul>
<li>压缩已经过压缩处理的文件，那个压缩率会变低</li>
<li>如果一个文件中重复的数据很少，压缩效果也会不明显</li>
</ul>
<h3 id="14-1-4-二叉排序树"><a href="#14-1-4-二叉排序树" class="headerlink" title="14.1.4 二叉排序树"></a>14.1.4 二叉排序树</h3><p>二叉排序树（BST，Binary Sort Tree）：对于任何一个非叶节点，其左节点小于等于当前节点，右节点大于等于当前节点</p>
<p><strong>二叉排序树的例子：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A(10)---B(8)</span><br><span class="line">B---D(4)---c(2)---d(1)</span><br><span class="line">D---b(6)</span><br><span class="line">B---E(9)</span><br><span class="line">A---C(15)---e(12)</span><br><span class="line">C---ee(23)</span><br></pre></td></tr></table></figure>

<p><strong>二叉排序树删除节点：</strong></p>
<ul>
<li><p>删除叶节点的场合，将那个父节点的对应连接置空即可。</p>
</li>
<li><p>删除有唯一子节点的节点场合，让那个父节点的对应连接改为指向子树即可。</p>
</li>
<li><p>删除有两个子节点的节点的场合，将该节点置为正无穷或负无穷。</p>
<p>之后维护该二叉排序树，直到该节点成为叶节点时，删除该节点即可。</p>
</li>
</ul>
<h4 id="14-1-4-1-平衡二叉树"><a href="#14-1-4-1-平衡二叉树" class="headerlink" title="14.1.4.1 平衡二叉树"></a>14.1.4.1 平衡二叉树</h4><blockquote>
<p>二叉排序树可能形成一些奇怪的形状（如左子树全部为空），这样就不能发挥树形结构的比较优势。</p>
</blockquote>
<p>平衡二叉树（AVL 树）：也叫平衡二叉搜索树。非空时，其任意节点左右两个子树的高度差不超过 1，且左右子树也都是平衡二叉树。</p>
<p>平衡二叉树的实现方法有：红黑树、AVL、替罪羊树、Treap、伸展树等</p>
<h5 id="平衡二叉树的左旋转："><a href="#平衡二叉树的左旋转：" class="headerlink" title="平衡二叉树的左旋转："></a>平衡二叉树的左旋转：</h5><ul>
<li>创建一个新节点。该节点的值等于根节点值</li>
<li>使该新节点的左子树指向当前根节点的左子树。使该节点的右子树指向当前根节点右子树的左子树</li>
<li>使当前根节点的右子树的左子树指向该新节点</li>
<li>使当前根节点的右子树成为新的根节点。旧的根节点被废弃</li>
</ul>
<p>简单的说，就是让根节点的右子树指向右子树的左子树。而右子树的左子树指向根节点。</p>
<p>合理性在于，根节点（root）的右子树（right）上的所有值都大于 root；而 right 的所有左子树的值，以及 root 所有左子树的值也一定小于 right 值</p>
<h5 id="平衡二叉树的右旋转："><a href="#平衡二叉树的右旋转：" class="headerlink" title="平衡二叉树的右旋转："></a>平衡二叉树的右旋转：</h5><p>还不是一样？</p>
<h5 id="平衡二叉树的双旋转："><a href="#平衡二叉树的双旋转：" class="headerlink" title="平衡二叉树的双旋转："></a>平衡二叉树的双旋转：</h5><p>符合进行右旋转的条件（右子树高度 &gt; 左子树高度 + 1）时，如果那个左子树的右子树高度高于其左子树高度，需要先对左子树进行左旋转。以此类推。</p>
<h5 id="实现平衡二叉树："><a href="#实现平衡二叉树：" class="headerlink" title="实现平衡二叉树："></a>实现平衡二叉树：</h5><p><em><strong>——见本章附录：[F2 实现平衡二叉树]</strong></em></p>
<h3 id="14-1-5-线段树"><a href="#14-1-5-线段树" class="headerlink" title="14.1.5 线段树"></a>14.1.5 线段树</h3><p>线段树（Segment Tree）是一棵二叉树。其每个节点表示一个闭区间，父节点的区间内包含所有子节点的区间。</p>
<ul>
<li><p>对于每个非叶节点，将其区间平均划分成两个子区间。左节点指向其中较小区间，右节点指向那个较大区间</p>
<p>换言之，对于非叶节点 [L, R]，其左子节点是 [L, (L + R) &#x2F; 2]，右子节点是 [((L + R) &#x2F; 2) + 1, R]</p>
</li>
<li><p>对于每个叶节点，其区间仅包含一个元素。即，其区间的左界等于右界。</p>
</li>
</ul>
<p><strong>线段树的例子：</strong></p>
<p>在区间 [1, 9] 中，记录 [2, 9] 的样子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">Root(&amp;#91&amp;#49,9&amp;#93)</span><br><span class="line"></span><br><span class="line">Root---L(&amp;#91&amp;#49,5&amp;#93)</span><br><span class="line">style R fill: #BFFFFC</span><br><span class="line">Root---R(&amp;#91&amp;#54,9&amp;#93)</span><br><span class="line"></span><br><span class="line">L---LL(&amp;#91&amp;#49,3&amp;#93)</span><br><span class="line">style LR fill: #BFFFFC</span><br><span class="line">L---LR(&amp;#91&amp;#52,5&amp;#93)</span><br><span class="line">R---RL(&amp;#91&amp;#54,7&amp;#93)</span><br><span class="line">R---RR(&amp;#91&amp;#56,9&amp;#93)</span><br><span class="line"></span><br><span class="line">LL---LLL(&amp;#91&amp;#49,2&amp;#93)</span><br><span class="line">style LLR fill: #BFFFFC</span><br><span class="line">LL---LLR(&amp;#91&amp;#51,3&amp;#93)</span><br><span class="line">LR---LRL(&amp;#91&amp;#52,4&amp;#93)</span><br><span class="line">LR---LRR(&amp;#91&amp;#53,5&amp;#93)</span><br><span class="line">RL---RLL(&amp;#91&amp;#54,6&amp;#93)</span><br><span class="line">RL---RLR(&amp;#91&amp;#55,7&amp;#93)</span><br><span class="line">RR---RRL(&amp;#91&amp;#56,8&amp;#93)</span><br><span class="line">RR---RRR(&amp;#91&amp;#57,9&amp;#93)</span><br><span class="line"></span><br><span class="line">LLL---LLLL(&amp;#91&amp;#49,1&amp;#93)</span><br><span class="line">style LLLR fill: #BFFFFC</span><br><span class="line">LLL---LLLR(&amp;#91&amp;#50,2&amp;#93)</span><br></pre></td></tr></table></figure>

<p>线段树是近似的完全二叉树。有时，线段树的节点是随着线段树的更新逐渐建立的，此时线段树不处于完全二叉树的状态。</p>
<p><strong>线段树的更新：</strong></p>
<p>标记区间时，按照 <strong>广度优先搜索</strong> 的思想，从根节点开始遍历区间。</p>
<p><em><strong>——广度优先搜索，见本章 [14.3.2 广度优先搜索 BFS]</strong></em></p>
<p>比如，添加区间 [START, END] 时：</p>
<ul>
<li><p>如果一个节点的区间内所有元素都被标记，则标记这个节点</p>
<p>对于区间 [L, R]，如果 L &gt;&#x3D; STRAT 且 R &lt;&#x3D; END，则标记该节点</p>
</li>
<li><p>如果一个节点的区间内部分元素被标记，则继续遍历其左右节点</p>
<p>对于区间 [L, R]，MID &#x3D; (L + R) &#x2F; 2</p>
<p>如果 MID &gt;&#x3D; L，则需要遍历其左节点。如果 MID &lt; R，则需要遍历其右节点</p>
</li>
</ul>
<p>标记节点时，只需在该节点添加懒标记，而不必对所有子节点进行标记。</p>
<p><strong>懒标记：</strong></p>
<p>使用懒标记，可以只更新到满足条件的区间，而不必对所有子区间一一更新。此后再次遍历到该节点时，再对懒标记进行下推</p>
<p>上述例子中，记录区间 [2, 7] 时，仅更新了 [2, 2]、[3, 3]、[4, 5]、[6, 9] 这些节点。</p>
<p>以节点 [6, 9] 为例，该区间上被添加了懒标记，代表该区间及所有子区间都被记录了一次。下次遍历到这个节点时，懒标记被下推给子节点 [6, 7]、[8, 9]</p>
<p><strong>线段树的查询：</strong></p>
<p>一个区间的元素和，等于 <em>其子区间各自元素和</em> 的合计值</p>
<p>一个区间中的最大值，等于 <em>其子区间各自最大值</em> 中的较大值</p>
<h2 id="14-2-多路查找树"><a href="#14-2-多路查找树" class="headerlink" title="14.2 多路查找树"></a>14.2 多路查找树</h2><blockquote>
<p>二叉树虽然效率较高，但需要加载到内存中。节点过多时就可能出现问题。</p>
<p>如：需要进行多次 I &#x2F; O 操作，导致构建速度慢；造成二叉树高度很大，降低操作速度。</p>
</blockquote>
<p>每个节点可以拥有更多数据项和更多子节点的树，就是多叉树（multiway tree）。</p>
<p>多叉树通过重新组织节点，能减少树的高度，能对二叉树进行优化。</p>
<h4 id="名词解释："><a href="#名词解释：" class="headerlink" title="名词解释："></a>名词解释：</h4><ul>
<li>节点的度：节点的子节点数量</li>
<li>树的度 &#x2F; 阶：树中所有节点的度的最大值</li>
</ul>
<h3 id="14-2-1-2-3-树"><a href="#14-2-1-2-3-树" class="headerlink" title="14.2.1 2-3 树"></a>14.2.1 2-3 树</h3><p>2-3 树是最简单的 B 树结构。其具有如下特点：</p>
<ul>
<li><p>所有叶节点都在同一层。节点包含不超过 2 个值。</p>
</li>
<li><p>有两个子节点的节点叫 <strong>二节点</strong>。二节点要么没有子节点，要么有两个子节点。</p>
<p>有三个子节点的节点叫 <strong>三节点</strong>。三节点要么没有子节点，要么有三个子节点。</p>
</li>
<li><p>2-3 树是由 二节点 和 三节点 构成的树。其节点仍遵循二叉排序树的规则。</p>
<p>对于二节点：其左子树的值需小于当前节点、右子树的值需大于当前节点</p>
<p>对于三节点：其左子树的值小于当前节点的最小值，中子树的值需介于当前节点的两个值之间，右子树的值大于当前节点的最大值</p>
</li>
</ul>
<p><strong>2-3 树的例子：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A(10)---B(6)</span><br><span class="line">B---D(1, 3)</span><br><span class="line">B---E(7)</span><br><span class="line">A---C(15, 20)</span><br><span class="line">C---F(11, 12)</span><br><span class="line">C---G(19)</span><br><span class="line">C---H(22, 32)</span><br></pre></td></tr></table></figure>

<h4 id="构建-2-3-树："><a href="#构建-2-3-树：" class="headerlink" title="构建 2-3 树："></a>构建 2-3 树：</h4><ul>
<li><p>插入节点时，如果不能满足条件，即需要拆分。</p>
<p>拆分时先拆上层。上层满时，才拆本层。拆分后仍要满足规则</p>
</li>
</ul>
<h4 id="2-3-4-树："><a href="#2-3-4-树：" class="headerlink" title="2-3-4 树："></a>2-3-4 树：</h4><p>还不是一样？</p>
<h3 id="14-2-2-B-树"><a href="#14-2-2-B-树" class="headerlink" title="14.2.2 B 树"></a>14.2.2 B 树</h3><p>B 树（b-tree，balance tree）。2-3 树与 2-3-4 树都是 B 树的种类。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">ROOT(30, 60&lt;br/&gt;P1 - P2 - P3)</span><br><span class="line">ROOT---R1(10, 20&lt;br/&gt;P1 - P2 - P3)</span><br><span class="line">ROOT---R2(40, 50&lt;br/&gt;. - P2 - P3)</span><br><span class="line">ROOT---R3(70, 80&lt;br/&gt;P1 - P2 - P3)</span><br><span class="line">R1---R11(3, 6)</span><br><span class="line">R1---R12(12, 13)</span><br><span class="line">R1---R13(23, 24)</span><br><span class="line">R2---R21( )</span><br><span class="line">R2---R22(41, 48)</span><br><span class="line">R2---R23(55, 57)</span><br><span class="line">R3---R31(61, 62)</span><br><span class="line">R3---R32(73, 74)</span><br><span class="line">R3---R33(84, 86)</span><br></pre></td></tr></table></figure>

<p>B 树具有如下特点：</p>
<ul>
<li><p>树树我啊，所有叶节点都在同一层呢。</p>
</li>
<li><p>搜索时，从根节点起，对当前节点内的关键字（有序）进行二分查找。</p>
<p>命中则结束。否则，进入那个对应范围的子节点。那个命中可能发生在叶节点，也可能在非叶节点。</p>
<p>如果当前节点为空，则表示没有找到。</p>
</li>
<li><p>B 树的关键字集合分布在整棵树中，非叶节点和叶节点都存放数据</p>
</li>
<li><p>B 树的搜索性能等价于在关键字全集内进行二分查找</p>
</li>
</ul>
<h4 id="B-树："><a href="#B-树：" class="headerlink" title="B+ 树："></a>B+ 树：</h4><p>B+ 树是 B 树的变体。</p>
<p>使用链表存储数据时，查找数据缓慢。因此将链表数据分为若干段，将每段的索引节点保存为树。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">ROOT(0, 32, 61&lt;br/&gt;A - B - C)</span><br><span class="line">ROOT---R1(0, 12, 23&lt;br/&gt;A - B - C)</span><br><span class="line">ROOT---R2(32, 40, 52&lt;br/&gt;A - B - C)</span><br><span class="line">ROOT---R3(61, 73, 84&lt;br/&gt;A - B - C)</span><br><span class="line">R1---R11(0&lt;br/&gt;4&lt;br/&gt;9)</span><br><span class="line">R1---R12(12&lt;br/&gt;13&lt;br/&gt;17)</span><br><span class="line">R1---R13(23&lt;br/&gt;24&lt;br/&gt;25)</span><br><span class="line">R2---R21(32&lt;br/&gt;38&lt;br/&gt;39)</span><br><span class="line">R2---R22(40&lt;br/&gt;41&lt;br/&gt;48)</span><br><span class="line">R2---R23(52&lt;br/&gt;55&lt;br/&gt;57)</span><br><span class="line">R3---R31(61&lt;br/&gt;62&lt;br/&gt;66)</span><br><span class="line">R3---R32(73&lt;br/&gt;74&lt;br/&gt;79)</span><br><span class="line">R3---R33(84&lt;br/&gt;86&lt;br/&gt;87)</span><br><span class="line">subgraph 数据链表</span><br><span class="line">R11</span><br><span class="line">R12</span><br><span class="line">R13</span><br><span class="line">R21</span><br><span class="line">R22</span><br><span class="line">R23</span><br><span class="line">R31</span><br><span class="line">R32</span><br><span class="line">R33</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>B+ 树具有如下特点：</p>
<ul>
<li><p>B+ 树的关键字都出现在叶节点的链表中，链表中数据是有序的。</p>
<p>非叶节点只相当于叶节点的索引（稀疏索引），叶节点相当于是存储数据的数据层（稠密索引）。</p>
</li>
<li><p>B+ 树的命中只可能发生在叶节点。</p>
</li>
<li><p>B+ 树的搜索性能也等价于在关键字全集内进行二分查找</p>
</li>
<li><p>B+ 树更适合文件索引系统</p>
</li>
</ul>
<h4 id="B-树：-1"><a href="#B-树：-1" class="headerlink" title="B* 树："></a>B* 树：</h4><p>B* 树是 B+ 树的变体，其在非根、非叶节点间加入了兄弟指针。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">ROOT(0, 32, 61&lt;br/&gt;A - B - C)</span><br><span class="line">ROOT---R1(0, 12, 23&lt;br/&gt;A - B - C)</span><br><span class="line">ROOT---R2(32, 40, 52&lt;br/&gt;A - B - C)</span><br><span class="line">ROOT---R3(61, 73, 84&lt;br/&gt;A - B - C)</span><br><span class="line">R1---R11(0&lt;br/&gt;4&lt;br/&gt;9)</span><br><span class="line">R1---R12(12&lt;br/&gt;13&lt;br/&gt;17)</span><br><span class="line">R1---R13(23&lt;br/&gt;24&lt;br/&gt;25)</span><br><span class="line">R2---R21(32&lt;br/&gt;38&lt;br/&gt;39)</span><br><span class="line">R2---R22(40&lt;br/&gt;41&lt;br/&gt;48)</span><br><span class="line">R2---R23(52&lt;br/&gt;55&lt;br/&gt;57)</span><br><span class="line">R3---R31(61&lt;br/&gt;62&lt;br/&gt;66)</span><br><span class="line">R3---R32(73&lt;br/&gt;74&lt;br/&gt;79)</span><br><span class="line">R3---R33(84&lt;br/&gt;86&lt;br/&gt;87)</span><br><span class="line">subgraph 数据链表</span><br><span class="line">R11</span><br><span class="line">R12</span><br><span class="line">R13</span><br><span class="line">R21</span><br><span class="line">R22</span><br><span class="line">R23</span><br><span class="line">R31</span><br><span class="line">R32</span><br><span class="line">R33</span><br><span class="line">end</span><br><span class="line">subgraph 索引相连</span><br><span class="line">R1</span><br><span class="line">R2</span><br><span class="line">R3</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>B* 树具有以下特点：</p>
<ul>
<li>B* 树定义了非叶子节点关键字个数至少为 (2 &#x2F; 3) * M。其块的最低使用率为 2 &#x2F; 3，而 B+ 树最低使用率为 1 &#x2F; 2</li>
<li>B* 树分配新节点的概率更低，空间使用率更高</li>
</ul>
<h3 id="14-2-3-前缀树"><a href="#14-2-3-前缀树" class="headerlink" title="14.2.3 前缀树"></a>14.2.3 前缀树</h3><p>前缀树（字典树、单词查找树、键树），是一种多路查找树。利用元素的公共前缀来减少查询时间。</p>
<p>下面是一个存储了数个单词（a、act、art、cat、can、cant、roin）的前缀树：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">R[ ]</span><br><span class="line">style a fill: #C0F0E0</span><br><span class="line">R --- a((a))</span><br><span class="line">R --- c[c]</span><br><span class="line">R --- r[r]</span><br><span class="line">a --- ac[c]</span><br><span class="line">a --- ar[r]</span><br><span class="line">style act fill: #C0F0E0</span><br><span class="line">ac --- act((t))</span><br><span class="line">style art fill: #C0F0E0</span><br><span class="line">ar --- art((t))</span><br><span class="line">c --- ca[a]</span><br><span class="line">style cat fill: #C0F0E0</span><br><span class="line">ca --- cat((t))</span><br><span class="line">style can fill: #C0F0E0</span><br><span class="line">ca --- can((n))</span><br><span class="line">style cant fill: #C0F0E0</span><br><span class="line">can --- cant((t))</span><br><span class="line">r --- ro[o]</span><br><span class="line">ro --- roi[i]</span><br><span class="line">style roin fill: #C0F0E0</span><br><span class="line">roi --- roin((n))</span><br></pre></td></tr></table></figure>

<p>前缀树具有如下特点：</p>
<ul>
<li><p>根节点不包含字符，除根节点外每一个节点包含一个字符。</p>
</li>
<li><p>节点的路径即为一条存储字符串。特别的，根节点表示空字符串</p>
<p>每个节点持有一个计数器，计算该节点处存储的字符串数量。</p>
</li>
<li><p>所有的子节点都与父节点具有相同前缀。</p>
</li>
<li><p>在前缀树中，查询字符串的时间复杂度为 O(L)，其中 L 为字符串长度</p>
</li>
</ul>
<p><strong>实现前缀树：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TrimTree</span> &#123;</span><br><span class="line">    <span class="comment">/* 节点类 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        Map&lt;Character, Node&gt; next = <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        Node() &#123;</span><br><span class="line">            <span class="built_in">this</span>.next = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            <span class="built_in">this</span>.count = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Node</span> <span class="variable">root</span> <span class="operator">=</span> <span class="literal">null</span>;		<span class="comment">// 根节点</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 构造器 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TrimTree</span><span class="params">(String... strings)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.root = <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">        <span class="keyword">for</span> (String s : strings) add(s);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 添加字符串 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> c : s.toCharArray()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!p.next.containsKey(c)) p.next.put(c, <span class="keyword">new</span> <span class="title class_">Node</span>());</span><br><span class="line">            p = p.next.get(c);</span><br><span class="line">        &#125;</span><br><span class="line">        p.count++;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 查找字符串 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> c : s.toCharArray()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!p.next.containsKey(c)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            p = p.next.get(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p.count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="14-3-图"><a href="#14-3-图" class="headerlink" title="14.3 图"></a>14.3 图</h2><blockquote>
<p>线性表局限于一个直接前驱和一个直接后继的关系。</p>
<p>树可能有数个直接后继，但只能有一个直接前驱（父节点）</p>
<p>当需要表示多对多关系时，就需要 <strong>图</strong></p>
</blockquote>
<p>图是一种数据结构。每个节点可以有零个或多个相邻元素。</p>
<p>两个节点间的连接称为 <strong>边（edge）</strong>，节点也被称为 <strong>顶点（vertex）</strong></p>
<p>图的分类：</p>
<ul>
<li>按照 顶点间的连接有无方向 分为：有向图、无向图</li>
<li>按照 是否带权 分为：带权图（网）、非带权图</li>
<li>按照 表示方式 分为：二维数组表示（邻接矩阵）、链表表示（邻接表）</li>
</ul>
<h4 id="图的表示方式："><a href="#图的表示方式：" class="headerlink" title="图的表示方式："></a>图的表示方式：</h4><p>一组连接的节点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">A(1)---B(0)</span><br><span class="line">A---C(2)</span><br><span class="line">B---C</span><br><span class="line">B---D(3)</span><br><span class="line">B---E(4)</span><br></pre></td></tr></table></figure>

<p><strong>邻接矩阵：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   0  1  2  3  4</span><br><span class="line">0 ┌0, 1, 1, 1, 1┐</span><br><span class="line">1 |1, 0, 1, 0, 0|</span><br><span class="line">2 |1, 1, 0, 0, 0|</span><br><span class="line">3 |1, 0, 0, 0, 0|</span><br><span class="line">4 └1, 0, 0, 0, 0┘</span><br></pre></td></tr></table></figure>

<p>其中，(0, 1) &#x3D;&#x3D; 1 表示 节点 0 与 节点 1 相连</p>
<p>邻接矩阵为每个顶点都分配了 n 个边的空间。这样，造成了空间的损失</p>
<p><strong>邻接表：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0 [1]→[2]→[3]→[4]→</span><br><span class="line">1 [0]→[2]→</span><br><span class="line">2 [0]→[1]→</span><br><span class="line">3 [0]→</span><br><span class="line">4 [0]→</span><br></pre></td></tr></table></figure>

<p>邻接表为每个节点创建一个链表，链表中是与其相连的节点。邻接表由 数组 + 链表 组成</p>
<p>邻接表只关心存在的边，不关心不存在的边，因此没有空间浪费</p>
<h3 id="14-3-1-深度优先搜索-DFS"><a href="#14-3-1-深度优先搜索-DFS" class="headerlink" title="14.3.1 深度优先搜索 DFS"></a>14.3.1 深度优先搜索 DFS</h3><p>深度优先搜索（Depth First Search），其策略是优先纵向挖掘深入，而不是对一个节点的所有节点先进行横向访问。</p>
<p>从初始访问节点出发，首先访问其第一个相邻节点。之后，从那个访问节点出发，递归访问第一个相邻节点。直到一个节点的路径完全访问结束后，才访问第二个节点。</p>
<h4 id="步骤："><a href="#步骤：" class="headerlink" title="步骤："></a>步骤：</h4><ul>
<li>访问初始节点 s，标记其为已访问</li>
<li>从 s 的第一个相邻节点起，以递归方式对其进行深度优先搜索。</li>
<li>当前节点没有可访问的相邻节点时，就完成了对一条路径访问。此时才返回上一级，继续搜索下一节点。</li>
</ul>
<h3 id="14-3-2-广度优先搜索-BFS"><a href="#14-3-2-广度优先搜索-BFS" class="headerlink" title="14.3.2 广度优先搜索 BFS"></a>14.3.2 广度优先搜索 BFS</h3><p>广度优先搜索（Broad First Search），其策略是优先横向访问所有相邻节点，而不是对一条路径进行纵向挖掘。</p>
<p>从初始访问节点出发，记录所有相邻节点。之后，访问先前记录节点，并记录所有相邻节点。直到没有能访问的节点为止，就完成了对所有连接节点的搜索。</p>
<h4 id="步骤：-1"><a href="#步骤：-1" class="headerlink" title="步骤："></a>步骤：</h4><ul>
<li>记录初始节点 s</li>
<li>访问上一次记录的节点，将其标记为已访问。将那些节点的所有可访问的相邻节点记录。</li>
<li>重复上一步，直到没有可访问的节点时，就完成了对所有连接节点的访问。</li>
</ul>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="F1-实现赫夫曼编码-x2F-解码"><a href="#F1-实现赫夫曼编码-x2F-解码" class="headerlink" title="F1 实现赫夫曼编码&#x2F;解码"></a>F1 实现赫夫曼编码&#x2F;解码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 压缩数据包 */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataBox</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] data;				<span class="comment">// 压缩信息主体</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;Byte, String&gt; key;	<span class="comment">// 赫夫曼表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> step;				<span class="comment">// 补位数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Huff</span> &#123;</span><br><span class="line">    <span class="comment">/* 将数据压缩，返回一个压缩包 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DataBox <span class="title function_">huff</span><span class="params">(<span class="type">byte</span>[] data)</span> &#123;</span><br><span class="line">        <span class="type">DataBox</span> <span class="variable">dataBox</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataBox</span>();</span><br><span class="line">        dataBox.key = getHuffMap(data);						<span class="comment">// 在压缩包内记录编码表</span></span><br><span class="line">        dataBox.data = toHuff(data, dataBox);				<span class="comment">// 在压缩包内记录压缩后数据，也会记录补位数</span></span><br><span class="line">        <span class="keyword">return</span> dataBox;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 根据要压缩的数据，计算那个赫夫曼表 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Byte, String&gt; <span class="title function_">getHuffMap</span><span class="params">(<span class="type">byte</span>[] val)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (val == <span class="literal">null</span> || val.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Map&lt;Byte, Node&gt; huff = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> c : val) &#123;								<span class="comment">// 记录每个字符出现的次数</span></span><br><span class="line">            <span class="keyword">if</span> (huff.containsKey(c)) huff.get(c).times++;</span><br><span class="line">            <span class="keyword">else</span> huff.put(c, <span class="keyword">new</span> <span class="title class_">Node</span>(c, <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        PriorityQueue&lt;Node&gt; pq = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(huff.values());</span><br><span class="line">        <span class="keyword">while</span> (pq.size() &gt; <span class="number">1</span>) &#123;								<span class="comment">// 生成赫夫曼树</span></span><br><span class="line">            <span class="type">Node</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(pq.remove(), pq.remove());</span><br><span class="line">            pq.add(temp);</span><br><span class="line">        &#125;</span><br><span class="line">        Map&lt;Byte, String&gt; ret = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        update(ret, pq.remove(), <span class="string">&quot;&quot;</span>);						<span class="comment">// 根据那个赫夫曼树，生成赫夫曼编码</span></span><br><span class="line">        <span class="keyword">if</span> (ret.size() == <span class="number">1</span>) ret.put(val[<span class="number">0</span>], <span class="string">&quot;0&quot;</span>);			<span class="comment">// 特别地，只有唯一字符从场合这样处理</span></span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 根据赫夫曼表，将数据压缩 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">byte</span>[] toHuff(<span class="type">byte</span>[] val, DataBox d) &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> c : val) &#123;								<span class="comment">// 得到压缩后的 bit 字符串</span></span><br><span class="line">            sb.append(d.key.get(c));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">byte</span>[] ret = <span class="keyword">new</span> <span class="title class_">byte</span>[(sb.length() + <span class="number">7</span>) / <span class="number">8</span>];		<span class="comment">// 压缩后的数据放在 byte 数组中</span></span><br><span class="line">        d.step = sb.length() % <span class="number">8</span>;							<span class="comment">// 记录那个补位数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; ret.length; i ++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= ret.length - <span class="number">1</span> &amp;&amp; d.step != <span class="number">0</span>) &#123;		<span class="comment">// 最后一位可能有补位。那个场合，让有效数字在最左侧</span></span><br><span class="line">                ret[i] = (<span class="type">byte</span>) (Integer.parseInt(sb.substring(<span class="number">8</span> * i), <span class="number">2</span>) &lt;&lt; (<span class="number">8</span> - d.step));</span><br><span class="line">            &#125; <span class="keyword">else</span> ret[i] = (<span class="type">byte</span>) Integer.parseInt(sb.substring(<span class="number">8</span> * i, <span class="number">8</span> * i + <span class="number">8</span>), <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 该方法能遍历赫夫曼树，以获取赫夫曼表 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Map&lt;Byte, String&gt; ss, Node root, String s)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (root.right == <span class="literal">null</span> &amp;&amp; root.left == <span class="literal">null</span>) &#123;</span><br><span class="line">            ss.put(root.val, s);									<span class="comment">// 是叶节点的场合，记录这个编码值</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root.left != <span class="literal">null</span>) update(ss, root.left, s + <span class="string">&quot;0&quot;</span>);		<span class="comment">// 向左路径记为 0</span></span><br><span class="line">        <span class="keyword">if</span> (root.right != <span class="literal">null</span>) update(ss, root.right, s + <span class="string">&quot;1&quot;</span>);	<span class="comment">// 向右路径记为 1</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 解压压缩包 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] antiHuff(DataBox d) &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; d.data.length; i++) &#123;					<span class="comment">// 获取那个压缩数据的编码</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= d.data.length - <span class="number">1</span> &amp;&amp; d.step != <span class="number">0</span>) sb.append((temp = Integer.toBinaryString(d.data[i] | <span class="number">256</span>)), temp.length() - <span class="number">8</span>, temp.length() - <span class="number">8</span> + d.step);				<span class="comment">// 遍历到最后，要处理那个补位</span></span><br><span class="line">            <span class="keyword">else</span> sb.append((temp = Integer.toBinaryString(d.data[i] | <span class="number">256</span>)).substring(temp.length() - <span class="number">8</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        Map&lt;String, Byte&gt; anti = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Byte aByte : d.key.keySet()) &#123;							<span class="comment">// 将编码表转化为解码表</span></span><br><span class="line">            anti.put(d.key.get(aByte), aByte);</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Byte&gt; ret = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; sb.length(); i++) &#123;						<span class="comment">// 按照解码表，把压缩编码转化为未解压编码</span></span><br><span class="line">            s.append(sb.charAt(i));</span><br><span class="line">            <span class="keyword">if</span> (anti.containsKey(s.toString())) &#123;</span><br><span class="line">                ret.add(anti.get(s.toString()));</span><br><span class="line">                s = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">byte</span>[] bt = <span class="keyword">new</span> <span class="title class_">byte</span>[ret.size()];							<span class="comment">// 将 Byte 数组转化为 byte 数组</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bt.length; i++) &#123;</span><br><span class="line">            bt[i] = ret.get(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* 节点类，是构建赫夫曼树时用到的类 */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Node&gt; &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">byte</span> val;			<span class="comment">// 代表的 byte 值</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> times;			<span class="comment">// 出现的次数</span></span><br><span class="line">        <span class="keyword">public</span> Node left;</span><br><span class="line">        <span class="keyword">public</span> Node right;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(Node l, Node r)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.left = l;</span><br><span class="line">            <span class="built_in">this</span>.right = r;</span><br><span class="line">            <span class="built_in">this</span>.times = l.times + r.times;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">byte</span> val, <span class="type">int</span> pow)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.times = pow;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">byte</span> val)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.times = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Node o)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.times - o.times;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="F2-实现平衡二叉树"><a href="#F2-实现平衡二叉树" class="headerlink" title="F2 实现平衡二叉树"></a>F2 实现平衡二叉树</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AVL</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">Node</span> <span class="variable">root</span> <span class="operator">=</span> <span class="literal">null</span>;				<span class="comment">// 根节点</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 添加一个值（添加一个节点）</span></span><br><span class="line"><span class="comment">    	val：要添加的值 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">toAdd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(val);</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) root = toAdd;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">par</span> <span class="operator">=</span> root;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">temp</span> <span class="operator">=</span> root;</span><br><span class="line">            <span class="keyword">while</span> (temp != <span class="literal">null</span>) &#123;			<span class="comment">// 确定其插入位置</span></span><br><span class="line">                par = temp;</span><br><span class="line">                <span class="keyword">if</span> (val &gt; temp.val) &#123;</span><br><span class="line">                    temp = temp.right;</span><br><span class="line">                    toAdd.way = <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    temp = temp.left;</span><br><span class="line">                    toAdd.way = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (toAdd.way) &#123;				<span class="comment">// 将其插入到指定位置</span></span><br><span class="line">                par.right = toAdd;</span><br><span class="line">                par.right.parent = par;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                par.left = toAdd;</span><br><span class="line">                par.left.parent = par;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;					<span class="comment">// 维护该平衡二叉树</span></span><br><span class="line">                par = toAVL(par);</span><br><span class="line">                <span class="keyword">if</span> (par.parent == <span class="literal">null</span>) &#123;</span><br><span class="line">                    root = par;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (par.way) par.parent.right = par;</span><br><span class="line">                    <span class="keyword">else</span> par.parent.left = par;</span><br><span class="line">                    par = par.parent;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 维护平衡二叉树</span></span><br><span class="line"><span class="comment">    	root: 待检查节点 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Node <span class="title function_">toAVL</span><span class="params">(Node root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">gap</span> <span class="operator">=</span> root.rightHeight() - root.leftHeight();</span><br><span class="line">        <span class="keyword">if</span> (Math.abs(gap) &gt; <span class="number">1</span>) &#123;			<span class="comment">// |gap| &gt; 1 时，需要旋转</span></span><br><span class="line">            <span class="keyword">if</span> (gap &gt; <span class="number">0</span>) &#123;					<span class="comment">// gap &gt; 0 需要左旋，否则右旋</span></span><br><span class="line">                <span class="keyword">if</span> (root.right.leftHeight() &gt; root.right.rightHeight()) root.right = roll(root.right, <span class="literal">true</span>);</span><br><span class="line">                <span class="keyword">return</span> roll(root, <span class="literal">false</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (root.left.rightHeight() &gt; root.left.leftHeight()) root.left = roll(root.left, <span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">return</span> roll(root, <span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 对该节点进行旋转。</span></span><br><span class="line"><span class="comment">    	root：待旋转节点</span></span><br><span class="line"><span class="comment">    	dirR：true 的场合右旋，否则左旋 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Node <span class="title function_">roll</span><span class="params">(Node root, <span class="type">boolean</span> dirR)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (dirR) &#123;</span><br><span class="line">            temp = root.left;</span><br><span class="line">            root.left = temp.right;</span><br><span class="line">            <span class="keyword">if</span> (temp.right != <span class="literal">null</span>) &#123;</span><br><span class="line">                temp.right.way = <span class="literal">false</span>;</span><br><span class="line">                temp.right.parent = root;</span><br><span class="line">            &#125;</span><br><span class="line">            temp.right = root;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            temp = root.right;</span><br><span class="line">            root.right = temp.left;</span><br><span class="line">            <span class="keyword">if</span> (temp.left != <span class="literal">null</span>) &#123;</span><br><span class="line">                temp.left.way = <span class="literal">true</span>;</span><br><span class="line">                temp.left.parent = root;</span><br><span class="line">            &#125;</span><br><span class="line">            temp.left = root;</span><br><span class="line">        &#125;</span><br><span class="line">        temp.way = root.way;</span><br><span class="line">        temp.parent = root.parent;</span><br><span class="line">        root.way = dirR;</span><br><span class="line">        root.parent = temp;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 一个展示树的方法。供 debug 用 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">(Node root)</span> &#123;</span><br><span class="line">        LinkedList&lt;Node&gt; a = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        LinkedList&lt;Node&gt; b = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        a.add(root);</span><br><span class="line">        <span class="keyword">while</span> (!a.isEmpty()) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">temp</span> <span class="operator">=</span> a.removeFirst();</span><br><span class="line">            System.out.print(temp.val + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (temp.left != <span class="literal">null</span>) b.add(temp.left);</span><br><span class="line">            <span class="keyword">if</span> (temp.right != <span class="literal">null</span>) b.add(temp.right);</span><br><span class="line">            <span class="keyword">if</span> (a.isEmpty()) &#123;</span><br><span class="line">                System.out.println();</span><br><span class="line">                a = b;</span><br><span class="line">                b = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;共 &quot;</span> + count(root) + <span class="string">&quot; 个节点&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 一个清点树中节点的方法 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">count</span><span class="params">(Node root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + count(root.left) + count(root.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;				<span class="comment">// 值</span></span><br><span class="line">        <span class="keyword">public</span> Node left;			<span class="comment">// 左节点</span></span><br><span class="line">        <span class="keyword">public</span> Node right;			<span class="comment">// 右节点</span></span><br><span class="line">        <span class="keyword">public</span> Node parent;			<span class="comment">// 父节点</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">way</span> <span class="operator">=</span> <span class="literal">false</span>;        <span class="comment">// false：该节点是左节点；true：是右节点</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">leftHeight</span><span class="params">()</span> &#123;	<span class="comment">// 左子树高度</span></span><br><span class="line">            <span class="keyword">return</span> (left == <span class="literal">null</span> ? <span class="number">0</span> : left.height());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rightHeight</span><span class="params">()</span> &#123;	<span class="comment">// 右子树高度</span></span><br><span class="line">            <span class="keyword">return</span> (right == <span class="literal">null</span> ? <span class="number">0</span> : right.height());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">height</span><span class="params">()</span> &#123;		<span class="comment">// 该节点树高度</span></span><br><span class="line">            <span class="keyword">return</span> Math.max(leftHeight(), rightHeight()) + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/02/14%20%E6%A0%91/" data-id="claq4namn0009p4tf006l3ucr" data-title="&lt;Java&gt;14 树" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-13 Java 数据结构" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="article-date">
  <time class="dt-published" datetime="2022-05-28T16:00:00.000Z" itemprop="datePublished">2022-05-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">&lt;Java&gt;13 Java 数据结构</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="13-Java-数据结构"><a href="#13-Java-数据结构" class="headerlink" title="13 Java 数据结构"></a>13 Java 数据结构</h1><blockquote>
<p>数据结构分为两种：线性结构、非线性结构</p>
</blockquote>
<p><strong>线性结构：</strong></p>
<ul>
<li><p>最常用的数据结构。数据元素间存在一对一线性关系。</p>
</li>
<li><p>线性结构有 2 种不同的存储结构：顺序储存结构，链式储存结构</p>
<p>顺序存储结构中元素存储在连续的内存空间中。</p>
<p>链式储存结构中元素储存在非连续的空间中，元素节点中存放数据元素及相邻元素的地址信息</p>
</li>
<li><p>常见的线性结构有：数组、队列、链表、栈等</p>
</li>
</ul>
<p><strong>非线性结构：</strong></p>
<ul>
<li>非线性结构包括：二维数组、多维数组、广义表、树结构、图结构</li>
</ul>
<h2 id="13-1-集合的框架体系"><a href="#13-1-集合的框架体系" class="headerlink" title="13.1 集合的框架体系"></a>13.1 集合的框架体系</h2><blockquote>
<p>Java 提供了一系列集合容器，以方便程序员动态保存元素。并提供了一系列方便的操作对象的方法。</p>
<p>Java 集合主要分为两组：单列集合（Collection）、双列集合（Map）</p>
</blockquote>
<p><img src="img/Java_InputImage/%E9%9B%86%E5%90%88%E4%BD%93%E7%B3%BB%E5%9B%BE_13.1.png"></p>
<p><em>（集合体系图_13.1）</em></p>
<ul>
<li><p><strong>Collection 接口</strong>（单列集合）：可以存放多个元素。每个元素可以是 Object</p>
<p>Collection 接口有两个重要子接口：List（有序集合）和 Set（无序集合）</p>
</li>
<li><p><strong>Map 接口</strong>（双列集合）：用于保存具有映射关系的数据：key - value（双列元素）</p>
<p>key 和 value 可以是任何类型的引用数据类型。其中 key 不能重复，value 可以重复</p>
<p>key 和 value 存在单一对应关系。通过特定的 key 一定能找到指定的 value</p>
</li>
</ul>
<h2 id="13-2-单列集合接口-Collection"><a href="#13-2-单列集合接口-Collection" class="headerlink" title="13.2 单列集合接口 Collection"></a>13.2 单列集合接口 Collection</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Collection</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Lterable</span>&lt;E&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Collection 实现子类可以存放多个元素。每个元素可以是 Object</p>
<p>有些 Collection 实现子类能存放重复的元素，有些不能</p>
<p>有些 Collection 实现子类是有序的（List） ，有些不是（Set）</p>
<p>Collection 接口没有直接的实现子类，都是通过其子接口实现的</p>
</blockquote>
<h3 id="常用方法："><a href="#常用方法：" class="headerlink" title="常用方法："></a>常用方法：</h3><ul>
<li><p><code>add</code>：添加单个元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ArrayList</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">list.add(<span class="string">&quot;哈哈啊&quot;</span>);</span><br><span class="line">list.add(<span class="number">10</span>);				<span class="comment">// 相当于List.add(new Integer(10));</span></span><br><span class="line">list.add(<span class="literal">true</span>);				<span class="comment">// 同上</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>remove</code>：删除单个元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list.remove(<span class="number">0</span>)				<span class="comment">// 删除编号 0 的元素。上例中会删除 &quot;哈哈啊&quot;</span></span><br><span class="line">list.remove((Integer)<span class="number">10</span>);	<span class="comment">// 删除上例的 10 要这样写</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>contains</code>：检查元素是否存在</p>
</li>
<li><p><code>size</code>：获取元素个数</p>
</li>
<li><p><code>isEmpty</code>：判断是否为空</p>
</li>
<li><p><code>clear</code>：清空</p>
</li>
<li><p><code>addAll</code>：添加多个元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ArrayList</span> <span class="variable">list2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">list2.add(<span class="number">111</span>);</span><br><span class="line">list2.add(<span class="string">&quot;idea&quot;</span>);</span><br><span class="line">list.addAll(list2);			<span class="comment">// 这里可以输入所有实现了 Collection 接口的集合</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>containsAll</code>：检查多个元素是否存在</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list.contaionsAll(list2);	<span class="comment">// 同上，放一个实现了 Collection 接口的集合</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>removeAll</code>：删除多个元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list.removeAll(list2);		<span class="comment">// 同上</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Iterator iterator()</code>：返回指向集合开始位置的迭代器</p>
</li>
</ul>
<h3 id="13-2-1-迭代器-Iterator"><a href="#13-2-1-迭代器-Iterator" class="headerlink" title="13.2.1 迭代器 Iterator"></a>13.2.1 迭代器 Iterator</h3><blockquote>
<p>Iterator 对象称为迭代器，主要用于遍历 Collection 集合中的元素。</p>
<p>Collection 继承的 Iterable 接口中，提供了 <code>iterator()</code> 方法，会返回一个新的迭代器。</p>
<p>Iterator 对象仅用于遍历集合，本身不存放元素</p>
<p>IDEA 中，迭代器 while 循环的模板快捷键：<code>itit</code></p>
</blockquote>
<p><strong>常用方法：</strong></p>
<ul>
<li><code>boolean hasNext()</code>：该方法判断是否有下一个元素。</li>
<li><code>T next()</code>：该方法会将指针下移，然后返回下移后的位置上的元素</li>
</ul>
<p><strong>用迭代器遍历元素：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Collection&lt;Object&gt; c = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">Iterator&lt;Object&gt; iterator = c.iterator();		<span class="comment">// [1]</span></span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext())&#123;						<span class="comment">// [2]</span></span><br><span class="line">	<span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> iterator.next();				<span class="comment">// [3]</span></span><br><span class="line">	System.out.println(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>获取迭代器</p>
</li>
<li><p>判断有无下一元素</p>
</li>
<li><p>将迭代器后移，并返回那个后移位置上的元素</p>
<p>while 循环结束后，指针指向最后元素的位置。再次 <code>next()</code> 会报错。如果需要再使用，需要重置迭代器。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iterator = list.iterator();				<span class="comment">// 重置了迭代器</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>for each（增强 for 循环）：</strong></p>
<blockquote>
<p>for each 的语法与 for 循环相似，但是可以遍历 Collection 和 数组 中的元素</p>
<p>IDEA 中，增强 for 循环的模板快捷键：<code>I</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Object o : list)&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>for each 可在 Collection 集合中使用。</li>
<li>for each 的底层在本质上也是 <code>Iterator</code>。可以理解为简化版本的迭代器遍历。</li>
</ul>
<h2 id="13-3-有序集合接口-List"><a href="#13-3-有序集合接口-List" class="headerlink" title="13.3 有序集合接口 List"></a>13.3 有序集合接口 List</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">List</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Collection</span>&lt;E&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>List 是 Collection 接口的子类接口</p>
<p>List 是有序（添加顺序和取出顺序一致）的，可重复的</p>
<p>List 中的每个元素都有其对应的顺序索引（从 0 开始编号）</p>
</blockquote>
<h3 id="常用方法：-1"><a href="#常用方法：-1" class="headerlink" title="常用方法："></a>常用方法：</h3><ul>
<li><p><code>add(int, obj)</code>：在 int 位置插入 obj 元素。返回 true</p>
<p><code>add(obj)</code>：在末尾插入 obj。返回 true</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list.add(<span class="number">111</span>);</span><br><span class="line">list.add(<span class="number">0</span>, <span class="number">110</span>);						<span class="comment">// 在第 1 个位置插入数字 110</span></span><br></pre></td></tr></table></figure>

<p><code>addElement(obj)</code>：在末尾插入 obj。无返回值。你说要这方法有啥用？名字还长一截</p>
</li>
<li><p><code>addAll(int, collection)</code>：在 int 位置插入 collection 中的所有元素</p>
</li>
<li><p><code>get(int)</code>：返回 int 位置的元素</p>
</li>
<li><p><code>indexOf(obj)</code>：返回 obj 首次出现时的位置</p>
</li>
<li><p><code>lastIndexOf(obj)</code>：返回 obj 最后一次出现时的位置</p>
</li>
<li><p><code>remove(int)</code>：移除 int 位置的元素，并返回那个被移除的元素</p>
</li>
<li><p><code>set(int, obj)</code>：设置 int 位置的元素为 obj。相当于替换。返回那个被替换元素的下标</p>
<p><code>setElement(obj, int)</code>：设置 int 位置的元素为 obj。无返回值</p>
</li>
<li><p><code>subList(int1, int2)</code>：返回 [int1, int2) 范围的元素构成的子集合</p>
</li>
</ul>
<h3 id="13-3-1-可变数组-ArrayList"><a href="#13-3-1-可变数组-ArrayList" class="headerlink" title="13.3.1 可变数组 ArrayList"></a>13.3.1 可变数组 ArrayList</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractList</span>&lt;E&gt;</span><br><span class="line">     <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ArrayList 是 List 的实现子类。其底层由数组来实现存储。</p>
<p>ArrayList 可以存放 null</p>
</blockquote>
<h4 id="ArrayList-的源码："><a href="#ArrayList-的源码：" class="headerlink" title="ArrayList 的源码："></a>ArrayList 的源码：</h4><ol>
<li><p>ArrayList 中维护了一个 Object 类型的数组 elementData。该数组就是用来存放元素的数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Object[] elementData;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 ArrayList 对象时，如果使用无参构造器，则 elementData[] 初始容量为 0</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果使用指定大小构造器，则初始容量为指定大小。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] EMPTY_ELEMENTDATA = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">ArrayList</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.elementData = <span class="keyword">new</span> <span class="title class_">Object</span>[initialCapacity];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == <span class="number">0</span>) &#123;</span><br><span class="line">	<span class="comment">/* 这个场合，与默认构造器的不同之处在于</span></span><br><span class="line"><span class="comment">		扩容时，该 0 容量变为 1，而默认构造器会变为 10 */</span></span><br><span class="line">        <span class="built_in">this</span>.elementData = EMPTY_ELEMENTDATA;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(...);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>扩容的场合：</p>
<p>如果是 <strong>无参构造器生成的初始 0 长度的 elementData</strong>，则将其容量置为 10。</p>
<p>否则容量扩容为 1.5 倍。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 扩容方法，传入的参数 minCapacity 是容器现有元素数量 + 1 的值</span></span><br><span class="line"><span class="comment">	如果是无参构造器生成的默认数组，此时传入固定值 10 */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">grow</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> elementData.length;</span><br><span class="line">    <span class="comment">/* 计算新的容量（旧容量的 1.5 倍）</span></span><br><span class="line"><span class="comment">    	此处 &gt;&gt; 为位运算符，等同于 newC = oldC + oldC / 2; */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> oldCapacity + (oldCapacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="comment">/* 这里如果原容量是特殊值（1 或 0），容量会变为那个 minCapacity 的值 */</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="13-3-2-可变数组-Vector"><a href="#13-3-2-可变数组-Vector" class="headerlink" title="13.3.2 可变数组 Vector"></a>13.3.2 可变数组 Vector</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vector</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">AbstractList</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Vector 是 List 的实现子类。其底层由数组来实现存储</p>
<p>Vector 与 ArrayList 基本等同。ArrayList 效率更高，Vector 线程安全。</p>
<p>在开发中，需要考虑线程安全时，建议使用 Vector ，而非 ArrayList。</p>
</blockquote>
<h4 id="Vector-的源码："><a href="#Vector-的源码：" class="headerlink" title="Vector 的源码："></a>Vector 的源码：</h4><ol>
<li><p>底层维护了一个 Object 类型的数组 elementData。用以存放元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Object[] elementData;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用无参构造器创建对象时，默认大小是 10</p>
<p>使用有参构造器的场合，默认是那个指定大小（initialCapaticy）</p>
<p>也能在构造器中指定那个扩容的增长速度（capacityIncrement）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">Vector</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Vector</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(initialCapacity, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Vector</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">int</span> capacityIncrement)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(...);</span><br><span class="line">    <span class="built_in">this</span>.elementData = <span class="keyword">new</span> <span class="title class_">Object</span>[initialCapacity];</span><br><span class="line">    <span class="built_in">this</span>.capacityIncrement = capacityIncrement;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>扩容的场合，容量变成 2 倍</p>
<p>使用有参构造器改变了 capacityIncrement 的场合，增量是那个指定数值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">grow</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> elementData.length;</span><br><span class="line">    <span class="comment">/* 计算新的容量（按照指定的增速扩容）</span></span><br><span class="line"><span class="comment">    	那个指定无效或未指定时，容量变为 2 倍 */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> oldCapacity + ((capacityIncrement &gt; <span class="number">0</span>) ?</span><br><span class="line">                                     capacityIncrement : oldCapacity);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="13-3-3-链表-LinkedList"><a href="#13-3-3-链表-LinkedList" class="headerlink" title="13.3.3 链表 LinkedList"></a>13.3.3 链表 LinkedList</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedList</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">AbstractSequentialList</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, Deque&lt;E&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>LinkedList 是 List 的实现子类，底层以链表形式存储元素。</p>
<p>链表是一种<strong>非线性结构</strong>：其以节点方式存储，节点间在内存上的位置不连续。</p>
<p>链表是有序的列表。单向链表每个节点包含 data 域和 next 域。那些 next 域指向下一节点的位置。</p>
<p>双向链表在单向链表的基础上，每个节点加入 prev 区域以指示其前方节点。这样，就能实现双向查找。双向链表可以不依靠辅助节点而实现自我删除。</p>
<p>LinkedList 底层实现了 双向链表 和 双端队列 特点。</p>
<p>LinkedList 可以添加 null，可添加重复元素。但没有实现同步，因此线程不安全。</p>
</blockquote>
<p><img src="img/Java_InputImage/%E9%93%BE%E8%A1%A8%E5%9B%BE_13.3.3.png"></p>
<h4 id="常用方法：-2"><a href="#常用方法：-2" class="headerlink" title="常用方法："></a>常用方法：</h4><ul>
<li><p><code>void addLast(E e)</code>：尾插一个新的元素</p>
<p>LinkedList 的 add 方法即调用该方法</p>
</li>
<li><p><code>void addFirst(E e)</code>：头插一个新的元素</p>
</li>
<li><p><code>E removeLast()</code>：移除并返回尾部元素。为空时报错</p>
<p><code>E poll()</code>：移除并返回尾部元素。为空时返回 null</p>
<p><code>E removeFirst()</code>：移除并返回头部元素。为空时报错</p>
</li>
<li><p><code>E getLast()</code>：仅返回尾部元素。为空时报错</p>
<p><code>E peek()</code>：返回尾部元素。为空时返回 null</p>
<p><code>E element()</code>：返回头部元素。为空时返回 null</p>
<p><code>E getFirst()</code></p>
</li>
</ul>
<h4 id="LinkedList-的源码"><a href="#LinkedList-的源码" class="headerlink" title="LinkedList 的源码"></a>LinkedList 的源码</h4><ol>
<li><p>LinkedList 只有默认构造器和一个拷贝构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedList</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedList</span><span class="params">(Collection&lt;? extends E&gt; c)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>();</span><br><span class="line">    addAll(c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>LinkedList 底层维护了一个 双向链表</p>
<p>两个属性 first、last 分别指向 首节点 和 尾节点</p>
<p>每个节点（Node 对象），里面又维护了 prev、next、item 属性。</p>
<p>其中通过 prev 指向前一个节点，通过 next 指向后一个节点。最终实现双向链表。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;E&gt; first;</span><br><span class="line"><span class="keyword">transient</span> Node&lt;E&gt; last;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;E&gt; &#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"></span><br><span class="line">    Node(Node&lt;E&gt; prev, E element, Node&lt;E&gt; next) &#123;</span><br><span class="line">        <span class="built_in">this</span>.item = element;</span><br><span class="line">        <span class="built_in">this</span>.next = next;</span><br><span class="line">        <span class="built_in">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>LinkedList 不需要扩容。其增删元素时只要改变节点的指向即可。</p>
<p>也因此，其添加、删除元素效率比数组更高</p>
</li>
</ol>
<h4 id="ArrayList-和-LinkedList-的比较："><a href="#ArrayList-和-LinkedList-的比较：" class="headerlink" title="ArrayList 和 LinkedList 的比较："></a>ArrayList 和 LinkedList 的比较：</h4><table>
<thead>
<tr>
<th></th>
<th>底层结构</th>
<th>增删效率</th>
<th>改查效率</th>
</tr>
</thead>
<tbody><tr>
<td>ArrayList</td>
<td>可变数组</td>
<td>低（数组扩容）</td>
<td>高</td>
</tr>
<tr>
<td><code>LinkedList</code></td>
<td>双向链表</td>
<td>高（链表追加）</td>
<td>低</td>
</tr>
</tbody></table>
<p>应该根据实际情况来选择使用的集合：</p>
<ul>
<li><p>如果改查操作多，选择 ArrayList。一般来说，在程序中，80% - 90% 都是查询。大部分情况下，选择 ArrayList。</p>
</li>
<li><p>如果增删操作多，选择 LinkedList</p>
</li>
</ul>
<h3 id="13-3-4-稀疏数组"><a href="#13-3-4-稀疏数组" class="headerlink" title="13.3.4 稀疏数组"></a>13.3.4 稀疏数组</h3><blockquote>
<p>二维数组的很多值是默认值 0，因此记录了很多没有意义的数据。因此，可以使用稀疏数组。</p>
</blockquote>
<p>稀疏数组的处理方法：</p>
<ol>
<li>记录数组共有几行几列，有多少个不同的值</li>
<li>把具有不同值的元素的行列及值记录在一个小规模数组中，从而缩小程序规模</li>
</ol>
<p><strong>二维数组转换为稀疏数组：</strong></p>
<p>下面用 ArrayList 模拟一个稀疏数组。</p>
<p>二维数组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[][] map = &#123;&#123;<span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> ,<span class="number">0</span> , <span class="number">0</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>&#125;,</span><br><span class="line">              &#123;<span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">              &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br></pre></td></tr></table></figure>

<p>遍历原始的二维数组，得到有效数据的个数 sum，并将二维数组的有效数据存入稀疏数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;<span class="type">int</span>[]&gt; sparseArray = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">sparseArray.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;map.length, map[<span class="number">0</span>].length, <span class="number">0</span>&#125;);	<span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> <span class="number">0</span>; y &lt; map.length; y++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0</span>; x &lt; map[<span class="number">0</span>].length; x++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (map[y][x] != <span class="number">0</span>) &#123;</span><br><span class="line">            sparseArray.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;y, x, map[y][x]&#125;);</span><br><span class="line">            sparseArray.get(<span class="number">0</span>)[<span class="number">2</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>稀疏数组转化为二维数组：</strong></p>
<p>读取稀疏数组的每一行，按照其第一行数据，创建原始的二维数组。</p>
<p>读取后几行数据，将值赋给二维数组</p>
<h3 id="13-3-5-栈-Stack"><a href="#13-3-5-栈-Stack" class="headerlink" title="13.3.5 栈 Stack"></a>13.3.5 栈 Stack</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Stack</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Vector</span>&lt;E&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Stack 是 Vector 的子类。以数组模拟了栈的数据结构。</p>
<p>栈是一个先入后出的有序列表。其元素之插入删除只能在该线性表的同一端进行。</p>
<p>其允许增删的一端称为栈顶，另一端即为栈底。</p>
<p>最先放入的元素位于栈底，最后放入的元素位于栈顶。</p>
<p>放入元素称为入栈（push），取出元素称为出栈（pop）</p>
</blockquote>
<p><img src="img/Java_InputImage/%E6%A0%88%E5%9B%BE_13.3.5.png"></p>
<p><strong>栈的应用场景：</strong></p>
<ul>
<li>子程序的调用</li>
<li>处理递归调用</li>
<li>表达式的转换与求值</li>
<li>二叉树的遍历</li>
<li>图形的深度优先搜索法</li>
</ul>
<h4 id="常用方法：-3"><a href="#常用方法：-3" class="headerlink" title="常用方法："></a>常用方法：</h4><ul>
<li><p><code>E push(E item)</code>：将元素 item 压入栈。返回值是 item 自己</p>
</li>
<li><p><code>E pop()</code>：让栈顶元素出栈</p>
</li>
<li><p><code>E peek()</code>：仅获取栈顶元素</p>
</li>
<li><p><code>int search(Object o)</code>：查找该元素最后出现的位置。</p>
<p>栈底为 1，栈顶为 size()，不存在返回 -1</p>
</li>
</ul>
<h4 id="13-3-5-1-栈模拟计算器"><a href="#13-3-5-1-栈模拟计算器" class="headerlink" title="13.3.5.1 栈模拟计算器"></a>13.3.5.1 栈模拟计算器</h4><blockquote>
<p>使用栈结构完成对计算器的实现</p>
</blockquote>
<p>要进行计算，需要获得表达式。</p>
<p>表达式分为三种：</p>
<ul>
<li><p><strong>中缀表达式：</strong></p>
<p>中缀表达式即生活中常见的运算表达式。比如：(3 + 4) * 5 - 6</p>
<p>中缀表达式是人最熟悉的。但是对于计算机来说却不好操作。因此，计算时常将其转化为其他表达式进行操作。</p>
</li>
<li><p><strong>前缀表达式：</strong></p>
<p>前缀表达式（波兰表达式）是一种没有括号的表达式。其将运算符写在前面，操作数写在后面</p>
<blockquote>
<p>(3 + 4) * 5 - 6 的前缀表达式为： + 3 * 4 - 5 6</p>
<p>(1 + 2) * (3 + 4) 的前缀表达式为：* + 1 2 + 3 4</p>
</blockquote>
<p>前缀表达式的计算机求值：</p>
<ul>
<li>从<b style="color:#FF3080">右</b>向<b style="color:#00C0AF">左</b>扫描表达式</li>
<li>将数字压入堆栈</li>
<li>遇到运算符的场合，对数字栈顶元素与次顶元素进行计算，并把那个结果入栈</li>
<li>重复该操作，最终数字栈的唯一剩余数字即为运算结果</li>
</ul>
</li>
<li><p><strong>后缀表达式：</strong></p>
<p>后缀表达式（逆波兰表达式）与前缀表达式相似。但其运算符位于操作数之后</p>
<blockquote>
<p>(3 + 4) * 5 - 6 的后缀表达式为： 3 4 + 5 * 6 -</p>
<p>(1 + 2) * (3 + 4) 的后缀表达式为：1 2 + 3 4 + *</p>
</blockquote>
<p>后缀表达式的计算机求值：</p>
<ul>
<li>从<b style="color:#00C0AF">左</b>向<b style="color:#FF3080">右</b>扫描表达式</li>
<li>将数字压入堆栈</li>
<li>遇到运算符的场合，对数字栈顶元素与次顶元素进行计算，并把那个结果入栈</li>
<li>重复该操作，最终数字栈的唯一剩余数字即为运算结果</li>
</ul>
</li>
</ul>
<p>对于人类来说，中缀表达式最为熟悉。但对于计算机来说，前缀、后缀表达式更容易识别。</p>
<p>我们可以将中缀表达式转化为后缀表达式，再进行运算。</p>
<p><strong>中缀表达式转换为后缀表达式：</strong></p>
<ol>
<li><p>初始化两个栈：运算符栈 operator_stack、表达式栈 formula_stack</p>
</li>
<li><p>从左到右扫描中缀表达式</p>
</li>
<li><p>遇到操作数时，将其压入表达式栈 formula_stack</p>
</li>
<li><p>遇到运算符时，比较其与 operator_stack 栈顶运算符的优先级。</p>
<ul>
<li>operator_stack 为空，或栈顶为 <code>(</code> 的场合，让运算符入栈</li>
<li>优先级高于栈顶运算符的场合，让其入栈</li>
<li>优先级低于或等于栈顶运算符的场合，将那个堆顶运算符弹出并压入 formula_stack。之后，重复该步骤。</li>
</ul>
</li>
<li><p>遇到括号时：</p>
<ul>
<li>遇到 <code>(</code> 时，压入 operator_stack</li>
<li>遇到 <code>)</code> 时，直到遇到 <code>(</code> 前，依次弹出 operator_stack 堆顶的运算符，并压入 formula_stack。之后将这一对括号丢弃。</li>
</ul>
</li>
<li><p>到达表达式最右边时，依次弹出 operator_stack 堆顶的运算符，压入 formula_stack。</p>
</li>
<li><p>此时，formula_stack 即为后缀表达式。</p>
<p>使用 Java 的 toArray 方法将其转为数组。或将其依次弹出，并逆序输出。</p>
</li>
</ol>
<p><strong>计算器的实现：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;Character, Integer&gt; priority = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        priority.put(<span class="string">&#x27;+&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">        priority.put(<span class="string">&#x27;-&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">        priority.put(<span class="string">&#x27;*&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">        priority.put(<span class="string">&#x27;/&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">        priority.put(<span class="string">&#x27;×&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">        priority.put(<span class="string">&#x27;÷&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">        priority.put(<span class="string">&#x27;(&#x27;</span>, -<span class="number">100</span>);</span><br><span class="line">        priority.put(<span class="string">&#x27;)&#x27;</span>, -<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">calculate</span><span class="params">(String formula)</span> &#123;</span><br><span class="line">        String[] ss = formula.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        Stack&lt;String&gt; operator_stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        Stack&lt;String&gt; formula_stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String s : ss) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s.matches(<span class="string">&quot;\\d+([.]\\d+)?&quot;</span>)) &#123;</span><br><span class="line">                formula_stack.push(s);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (operator_stack.empty() || s.equals(<span class="string">&quot;(&quot;</span>)) &#123;</span><br><span class="line">                operator_stack.push(s);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">String</span> <span class="variable">temp</span> <span class="operator">=</span> operator_stack.peek();</span><br><span class="line">            <span class="keyword">while</span> (priority.get(s.charAt(<span class="number">0</span>)) &lt;= priority.get(temp.charAt(<span class="number">0</span>))) &#123;</span><br><span class="line">                formula_stack.push(operator_stack.pop());</span><br><span class="line">                <span class="keyword">if</span> (operator_stack.empty()) <span class="keyword">break</span>;</span><br><span class="line">                temp = operator_stack.peek();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (s.equals(<span class="string">&quot;)&quot;</span>)) &#123;</span><br><span class="line">                operator_stack.pop();</span><br><span class="line">            &#125; <span class="keyword">else</span> operator_stack.push(s);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!operator_stack.empty()) &#123;</span><br><span class="line">            formula_stack.push(operator_stack.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> anti_Poland(String.join(<span class="string">&quot; &quot;</span>, formula_stack.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;&#125;)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">anti_Poland</span><span class="params">(String formula)</span> &#123;</span><br><span class="line">        String[] ss = formula.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        Stack&lt;Double&gt; ns = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String s : ss) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">double</span> <span class="variable">num</span> <span class="operator">=</span> Double.parseDouble(s);</span><br><span class="line">                ns.push(num);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">switch</span> (s) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;+&quot;</span>:</span><br><span class="line">                        ns.push(ns.pop() + ns.pop());</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;*&quot;</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;×&quot;</span>:</span><br><span class="line">                        ns.push(ns.pop() * ns.pop());</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;/&quot;</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;÷&quot;</span>:</span><br><span class="line">                        ns.push(<span class="number">1</span> / ns.pop() * ns.pop());</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;-&quot;</span>:</span><br><span class="line">                        ns.push(-ns.pop() + ns.pop());</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Illegal operator&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ns.pop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="13-3-6-跳表-SkipList"><a href="#13-3-6-跳表-SkipList" class="headerlink" title="13.3.6 跳表 SkipList"></a>13.3.6 跳表 SkipList</h3><p>跳表是一种特殊的链表。普通的链表虽然添加、删除节点的速度很快（O(1)），但是要查找节点却很慢（O(n)）。跳表是一个多层次的链表，其在链表的基础上增加了多级索引，实现了 O(㏒n) 的查找速度。</p>
<img src="img/Java_InputImage/13_3_6 跳表图.jpg"/>

<p><em>（13_3_6 跳表图）</em></p>
<p>跳表将原本数据层的数据按照一定间隔抽取节点形成索引层，之后再从索引层抽取节点形成第二级索引，以此类推形成多层索引。</p>
<p>跳表的查询速度得到了优化，但占用空间更大。本质上是一种空间换时间的做法。</p>
<p><strong>查询</strong></p>
<p>从最稀疏的索引层（最上层）开始，确定那个待查找数据所在的范围，逐层向下并确定范围，直至数据层。</p>
<p><strong>增删</strong></p>
<p>删除元素时，如果那个元素是索引元素，那些索引也会被删除。同时，如果只向数据层中增加元素，可能使索引间隔过大，从而降低查找效率。如果在增加元素时还能保持索引数量的动态平衡，就能防止跳表退化，保持跳表效率。</p>
<p>跳表给出的解决方案是：在增加元素时产生一个随机值，让这个随机值决定该新节点是否成为索引节点，以及成为几级索引节点。</p>
<p><strong>实现跳表</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Skiplist</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> level;					<span class="comment">// 该跳表的合计层数，包括数据层和索引层</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Random seed;					<span class="comment">// 随机数种子</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Node root;					<span class="comment">// 链表开头</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Node end;						<span class="comment">// 链表结尾</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;					<span class="comment">// 链表节点类</span></span><br><span class="line">        <span class="type">int</span> val;				<span class="comment">// 值</span></span><br><span class="line">        <span class="type">int</span> count;				<span class="comment">// 储存的值的数量</span></span><br><span class="line">        Node[] next;			<span class="comment">// 指向的下一节点</span></span><br><span class="line">        Node[] prev;			<span class="comment">// 指向的上一节点</span></span><br><span class="line">        						<span class="comment">// 需要指出的是：next 和 prev 的长度指示了节点所在的最高层级</span></span><br><span class="line">        						<span class="comment">// 长度为 1 时仅处在数据层，2 时也位于一级索引，以此类推</span></span><br><span class="line">        						<span class="comment">// 也就是说，next 和 prev 里，下标 0 的位置位于数据层，1 位于一级索引层</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 三个参数是：值 val，节点的层级 rand，节点储存值的数量 count */</span></span><br><span class="line">        Node(<span class="type">int</span> val, <span class="type">int</span> rand, <span class="type">int</span> count) &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.count = count;</span><br><span class="line">            next = <span class="keyword">new</span> <span class="title class_">Node</span>[rand];</span><br><span class="line">            prev = <span class="keyword">new</span> <span class="title class_">Node</span>[rand];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 构造器 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Skiplist</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 有参构造器。输入的值是索引层数量。该值至少应为 1 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Skiplist</span><span class="params">(<span class="type">int</span> level)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (level &lt; <span class="number">1</span> || level &gt; <span class="number">30</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(level == <span class="number">0</span> ?</span><br><span class="line">                    <span class="string">&quot;Why not choose a LinkedList?&quot;</span> :</span><br><span class="line">                    <span class="string">&quot;SkipList level out of range: given &quot;</span> + level + <span class="string">&quot; out of range [1, 30]&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.level = level + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">this</span>.seed = <span class="keyword">new</span> <span class="title class_">Random</span>(System.currentTimeMillis());</span><br><span class="line">        root = <span class="keyword">new</span> <span class="title class_">Node</span>(Integer.MIN_VALUE, <span class="built_in">this</span>.level, <span class="number">0</span>);</span><br><span class="line">        end = <span class="keyword">new</span> <span class="title class_">Node</span>(Integer.MAX_VALUE, <span class="built_in">this</span>.level, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>; n &lt; <span class="built_in">this</span>.level; n++) &#123;</span><br><span class="line">            root.next[n] = end;</span><br><span class="line">            end.prev[n] = root;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 查询一个值是否存在 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">search</span><span class="params">(<span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">find</span> <span class="operator">=</span> position(target);</span><br><span class="line">        <span class="keyword">return</span> find.val == target &amp;&amp; find.count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 搜索一个值的位置。不存在时会返回数据层中前一个节点的位置 */</span></span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">position</span><span class="params">(<span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">see</span> <span class="operator">=</span> root;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (see.val == target) <span class="keyword">return</span> see;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> see.next.length - <span class="number">1</span>; ; n--) &#123;</span><br><span class="line">                <span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="keyword">return</span> see;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (see.next[n].val &lt;= target) &#123;</span><br><span class="line">                    see = see.next[n];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 添加一个值 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">pos</span> <span class="operator">=</span> position(num);</span><br><span class="line">        <span class="keyword">if</span> (pos.val == num) &#123;		<span class="comment">// 如果这个节点已经建立，就仅使该节点计数增加</span></span><br><span class="line">            pos.count++;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rand</span> <span class="operator">=</span> <span class="number">1</span> + level - Integer.toBinaryString(seed.nextInt(<span class="number">1</span> &lt;&lt; level)).length();</span><br><span class="line">        			<span class="comment">// level 的值等于总层数。seed 是一个随机数种子，nextInt(int n) 方法返回 [0, n) 的数值</span></span><br><span class="line">        			<span class="comment">// Integer.toBinaryString(int n) 方法是将一个数字转化成二进制表示的字符串</span></span><br><span class="line">        			<span class="comment">// seed.nextInt(1 &lt;&lt; level) 保证了返回值的二进制长度在 [1, level] 之间，并且概率合意</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">add</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(num, rand, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>; t &lt; rand; ) &#123;			<span class="comment">// 将新节点添加到链表中。</span></span><br><span class="line">            <span class="keyword">for</span> (; t &lt; pos.next.length &amp;&amp; t &lt; rand; t++) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">next</span> <span class="operator">=</span> pos.next[t];</span><br><span class="line">                add.next[t] = next;</span><br><span class="line">                next.prev[t] = add;</span><br><span class="line">                pos.next[t] = add;</span><br><span class="line">                add.prev[t] = pos;</span><br><span class="line">            &#125;</span><br><span class="line">            pos = pos.prev[pos.prev.length - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 删除节点（的值） */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">erase</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">pos</span> <span class="operator">=</span> position(num);</span><br><span class="line">        <span class="keyword">if</span> (pos.val == num &amp;&amp; pos.count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            pos.count--;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="13-4-队列接口-Queue"><a href="#13-4-队列接口-Queue" class="headerlink" title="13.4 队列接口 Queue"></a>13.4 队列接口 Queue</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Queue</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Collection</span>&lt;E&gt; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>Queue 是 Collection 的子接口</p>
<p>Queue 的实现子类都是队列式集合。队列是一个有序列表，可以用数组或链表来实现</p>
<p>队列遵循先入先出的原则。队列中元素是以添加顺序取出的。</p>
<p>向队列中增加元素称为<strong>入列</strong>（push），取出元素称为<strong>出列</strong>（pop）</p>
</blockquote>
<p><img src="img/Java_InputImage/%E9%98%9F%E5%88%97%E5%9B%BE_13.4.png"></p>
<h3 id="常用方法：-4"><a href="#常用方法：-4" class="headerlink" title="常用方法："></a>常用方法：</h3><ul>
<li><p><code>add(E e)</code>：添加元素。队列满的场合抛出异常</p>
<p><code>put(E e)</code>：添加元素。队列满的场合可能阻塞</p>
<p><code>boolean offer(E e)</code>：添加元素。队列满的场合返回 false</p>
</li>
<li><p><code>E remove()</code>：移除并返回队列头部元素。队列空的场合抛出异常</p>
<p><code>E poll()</code>：移除并返回队列头部元素</p>
<p><code>E take()</code>：移除并返回队列头部元素。队列空的场合可能阻塞</p>
</li>
<li><p><code>E peek()</code>：仅返回队列头部元素。为空时返回 null</p>
<p><code>E element()</code>：仅返回队列头部元素。为空时抛出异常</p>
</li>
</ul>
<h3 id="13-4-1-优先级队列-PriorityQueue"><a href="#13-4-1-优先级队列-PriorityQueue" class="headerlink" title="13.4.1 优先级队列 PriorityQueue"></a>13.4.1 优先级队列 PriorityQueue</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PriorityQueue</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractQueue</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>PriorityQueue 是一个无界优先级队列。底层以数组储存元素。</p>
<p>无界队列：即没有范围限制的队列。</p>
<p>PriorityQueue 不允许 null 元素，也不允许不可比较的元素。</p>
<p>PriorityQueue 中的元素以自然顺序，或传入的比较器决定的顺序排序。其中的最小元素位于队头，最大元素位于队尾。</p>
<p>以迭代器遍历时，会按照原本的放入顺序获取元素。PriorityQueue 的源码：</p>
</blockquote>
<ol>
<li><p>底层维护了一个 Object 类型的数组 queue。用以存放元素</p>
<p>另维护了一个比较器 comparator，用以比较元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Object[] queue;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Comparator&lt;? <span class="built_in">super</span> E&gt; comparator;</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认构造器初始容量为 11，比较器为 null</p>
<p>也能指定初始容量，或传入比较器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">PriorityQueue</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(DEFAULT_INITIAL_CAPACITY, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">PriorityQueue</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(initialCapacity, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">PriorityQueue</span><span class="params">(Comparator&lt;? <span class="built_in">super</span> E&gt; comparator)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(DEFAULT_INITIAL_CAPACITY, comparator);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">PriorityQueue</span><span class="params">(<span class="type">int</span> initialCapacity,</span></span><br><span class="line"><span class="params">                     Comparator&lt;? <span class="built_in">super</span> E&gt; comparator)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">    <span class="built_in">this</span>.queue = <span class="keyword">new</span> <span class="title class_">Object</span>[initialCapacity];</span><br><span class="line">    <span class="built_in">this</span>.comparator = comparator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>放入时依靠比较器 comparator 进行排序。</p>
<p>那个比较器为 null 的场合，每次放入元素会按元素自身的自然顺序进行排序。</p>
<p>不能排序的场合会抛出异常。</p>
</li>
<li><p>扩容时，容量小于 64 的场合容量变为 2 倍 + 2。否则那个容量变为 1.5 倍</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">grow</span><span class="params">(<span class="type">int</span> minCapacity)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">oldCapacity</span> <span class="operator">=</span> queue.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> oldCapacity + ((oldCapacity &lt; <span class="number">64</span>) ?</span><br><span class="line">                                         (oldCapacity + <span class="number">2</span>) :</span><br><span class="line">                                         (oldCapacity &gt;&gt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; <span class="number">0</span>)</span><br><span class="line">            newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">        queue = Arrays.copyOf(queue, newCapacity);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="13-4-2-阻塞队列接口-BlockingQueue"><a href="#13-4-2-阻塞队列接口-BlockingQueue" class="headerlink" title="13.4.2 阻塞队列接口 BlockingQueue"></a>13.4.2 阻塞队列接口 BlockingQueue</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BlockingQueue</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Queue</span>&lt;E&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>BlockingQueue 是一个接口，其实现子类都是阻塞队列。</p>
<p>阻塞队列：</p>
<ul>
<li>元素入列时，那个队列已满的场合，会进行等待。直到有元素出列后，元素数量未超过队列总数时，解除阻塞状态，进而继续入列。</li>
<li>元素出列时，如果队列为空，则会进行等待。直到有元素入列时，解除阻塞状态，进而继续出列。</li>
<li>阻塞队列能防止容器溢出。只要是阻塞队列，就是线程安全的队列。</li>
<li>阻塞队列不接受 null 元素</li>
</ul>
<p>BlockingQueue 的常用实现子类有：</p>
<ul>
<li>ArrayBlockingQueue：底层以数组存放元素的有界阻塞队列</li>
<li>LinkedBlockingQueue：底层以链表存放元素的可选边界的阻塞队列</li>
<li>PriorityBlockingQueue：无界阻塞队列，与 PriorityQueue 排序方式相同</li>
</ul>
</blockquote>
<h4 id="常用方法：-5"><a href="#常用方法：-5" class="headerlink" title="常用方法："></a>常用方法：</h4><p>实际上，其常用方法能分为几类：</p>
<table>
    <tr>
        <td></td>
        <th>抛出异常</th>
        <th>特殊值</th>
        <th>阻塞</th>
        <th>等待</th>
    </tr>
    <tr>
        <th>插入</th>
        <td>add(e)</td>
        <td>offer(e)</td>
        <td>put(e)</td>
        <td>offer(e, time, unit)</td>
    </tr>
    <tr>
        <th>删除</th>
        <td>remove()</td>
        <td>poll()</td>
        <td>take()</td>
        <td>take(time, unit)</td>
    </tr>
    <tr>
        <th>查找</th>
        <td>element()</td>
        <td>peek()</td>
        <td>-</td>
        <td>-</td>
    </tr>
</table>




<h2 id="13-5-双列集合接口-Map"><a href="#13-5-双列集合接口-Map" class="headerlink" title="13.5 双列集合接口 Map"></a>13.5 双列集合接口 Map</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Map</span>&lt;K,V&gt;</span><br></pre></td></tr></table></figure>

<p><strong>以下关于 Map 接口的描述，适用于 JDK 8 的环境</strong></p>
<blockquote>
<p>Map 与 Collection 并列存在，用于保存具有映射关系的数据：key - value（双列元素）</p>
<p>Map 的 key 和 value 可以是任何类型的引用数据类型，也能存入 null。</p>
<p>Map 的 key 不允许重复，value 可以重复。key 和 value 存在单一对应关系。通过特定的 key 一定能找到指定的 value。</p>
<p>一组 k - v 会被封装到一个 Entry 对象中。Entry 是一个内部接口。Map 的实现子类中都包含一个实现这个接口的内部类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Entry</span>&lt;K,V&gt; &#123;</span><br><span class="line">	K <span class="title function_">getKey</span><span class="params">()</span>;</span><br><span class="line">	V <span class="title function_">getValue</span><span class="params">()</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果添加相同的 key，会覆盖原先的 key -value。等同于修改（key 不会替换，value 会被替换）</p>
</blockquote>
<h4 id="常用方法：-6"><a href="#常用方法：-6" class="headerlink" title="常用方法："></a>常用方法：</h4><ul>
<li><p><code>put()</code>：添加。已存在的场合，实行替换。（key 不替换，value 替换）</p>
</li>
<li><p><code>remove()</code>：根据键删除映射关系</p>
</li>
<li><p><code>get()</code>：根据键获取值</p>
</li>
<li><p><code>size()</code>：元素个数</p>
</li>
<li><p><code>isEmpty()</code>：判断个数是否为 0</p>
</li>
<li><p><code>clear()</code>：清空</p>
</li>
<li><p><code>containsKey()</code>：查找键是否存在</p>
</li>
<li><p><code>Set&lt;K&gt; keySet()</code>：获取所有 键 构成的集合</p>
<p><code>Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet()</code>：获取所有 Entry 构成的集合</p>
<p><code>Collection&lt;V&gt; values()</code>：获取所有 值 构成的集合</p>
</li>
</ul>
<h4 id="Map-接口遍历元素："><a href="#Map-接口遍历元素：" class="headerlink" title="Map 接口遍历元素："></a>Map 接口遍历元素：</h4><ul>
<li><p><strong>方法一</strong>：利用 <code>Set&lt;K&gt; keySet()</code> 方法</p>
<p>先得到所有 keys，再遍历 keys，根据每个 key 获得 value：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Set</span> <span class="variable">keyset</span> <span class="operator">=</span> map.keySet();</span><br><span class="line"><span class="keyword">for</span> (Object o : keyset) &#123;</span><br><span class="line">	System.out.println(o + <span class="string">&quot; = &quot;</span> + map.get(o));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>方法二</strong>：利用 <code>Set&lt;V&gt; values()</code> 方法</p>
<p>直接把所有 values 取出，之后遍历 values</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Collection</span> <span class="variable">values</span> <span class="operator">=</span> map.values();</span><br><span class="line"><span class="keyword">for</span> (Object value : values) &#123;</span><br><span class="line">	System.out.println(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>方法三</strong>：利用 <code>Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet()</code> 方法</p>
<p>通过获取 entrySet 来获取 k - v</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;Map.Entry&gt; entrySet = map.entrySet();</span><br><span class="line"><span class="keyword">for</span> (Map.Entry e : entrySet) &#123;</span><br><span class="line">	System.out.println(e.getKey() + <span class="string">&quot; - &quot;</span> + e.getValue());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="13-5-1-散列表-HashMap"><a href="#13-5-1-散列表-HashMap" class="headerlink" title="13.5.1 散列表 HashMap"></a>13.5.1 散列表 HashMap</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashMap</span>&lt;K,V&gt; <span class="keyword">extends</span> <span class="title class_">AbstractMap</span>&lt;K,V&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K,V&gt;, Cloneable, Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>HashMap 是 Map 接口使用频率最高的实现类。是根据关键码值（key value）而进行直接访问的数据结构。通过将关键码值映射到表中一个位置来访问记录，以加快查找速度。</p>
<p>那个映射函数叫做散列函数，存放记录的数组叫做散列表（哈希表）</p>
<p>HashMap 是以 k - v 对得到方式来存储数据。一组数据会被封装到一个 Node 对象中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span>&lt;K,V&gt; <span class="keyword">implements</span> <span class="title class_">Map</span>.Entry&lt;K,V&gt; &#123;</span><br><span class="line"> <span class="keyword">final</span> <span class="type">int</span> hash;</span><br><span class="line"> <span class="keyword">final</span> K key;</span><br><span class="line"> V value;</span><br><span class="line"> Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JDK 7 前，HashMap 底层是 数组 + 链表。JDK 8 后，底层是 数组 + 链表 + 红黑树。HashMap 不保证映射的顺序。</p>
<p>HashMap 没有实现同步（没有 synchronized），是线程不安全的</p>
</blockquote>
<h4 id="HashMap-的源码："><a href="#HashMap-的源码：" class="headerlink" title="HashMap 的源码："></a>HashMap 的源码：</h4><ol>
<li><p>HashMap 底层维护了 Node 类型的数组 table。默认为 null</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br></pre></td></tr></table></figure>

<p>另外，还有集合 values、keySet、enrtySet。这些集合能帮助程序员进行遍历</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Set&lt;K&gt;				keySet;</span><br><span class="line"><span class="keyword">transient</span> Collection&lt;V&gt;			values;</span><br><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt;	entrySet;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建对象时，默认构造器将加载因子（loadfactor）初始化为 0.75。</p>
<p>也能指定那些初始容量和加载因子。</p>
<p>默认构造器第一次添加元素的场合，table 扩容为 16，临界值为 16 * 0.75 &#x3D; 12。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">float</span> <span class="variable">DEFAULT_LOAD_FACTOR</span> <span class="operator">=</span> <span class="number">0.75f</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAXIMUM_CAPACITY</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashMap</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;					<span class="comment">// 这个默认构造的场合，其他参数都是默认值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashMap</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashMap</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(...);</span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)</span><br><span class="line">        initialCapacity = MAXIMUM_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (loadFactor &lt;= <span class="number">0</span> || Float.isNaN(loadFactor))</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(...);</span><br><span class="line">    <span class="built_in">this</span>.loadFactor = loadFactor;</span><br><span class="line">    <span class="built_in">this</span>.threshold = tableSizeFor(initialCapacity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加时容量不够的场合，需要扩容。</p>
<p>默认构造器第一次添加元素的场合，table 扩容为 16，临界值为 16 * 0.75 &#x3D; 12。</p>
<p>扩容的场合，容量变为 2 倍。临界值相应变化。</p>
<p>临界值不会超过那个指定的 MAXIMUM_CAPACITY（1 &lt;&lt; 30），否则变成 Integer.MAX_VALUE。</p>
<p>JDK 8 中，如果一条链表的元素个数超过 TREEIFY_THRESHOLD（默认是 8），并且 <code>table</code> 的大小 &gt;&#x3D; MIN_TREEIFY_CAPACITY（默认 64），会进行树化。</p>
<p>剪枝：红黑树的元素减少到一定程度，会被重新转化为 链表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAXIMUM_CAPACITY</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; <span class="number">30</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DEFAULT_INITIAL_CAPACITY</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;								<span class="comment">// &lt;- 旧的数据数组 table</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldCap</span> <span class="operator">=</span> (oldTab == <span class="literal">null</span>) ? <span class="number">0</span> : oldTab.length;		<span class="comment">// &lt;- 旧的 table 的容量</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">oldThr</span> <span class="operator">=</span> threshold;									<span class="comment">// &lt;- 旧的临界值</span></span><br><span class="line">    <span class="type">int</span> newCap, newThr = <span class="number">0</span>;									<span class="comment">// &lt;- 新的容量、临界值</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 旧的数组不为空时，</span></span><br><span class="line"><span class="comment">    	如果容量已达指定的 MAXIMUM_CAPACITY，则不扩容</span></span><br><span class="line"><span class="comment">    	否则扩容为 2 倍容量，临界值也变为 2 倍 */</span></span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        newCap = oldCap &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 旧的数组为空，但临界值已被指定（原因是：指定构造器传入初始容量为 0） */</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>)</span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="comment">/* 旧的数组为空，临界值为 0（原因是：使用默认构造器）</span></span><br><span class="line"><span class="comment">    	默认构造器初始化容量为 16，默认临界因子为 0.75f */</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        newThr = (<span class="type">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 到这里，newThr（新临界值）为 0 的原因可能是：</span></span><br><span class="line"><span class="comment">    	1. 旧容量小于那个最小容量（16）</span></span><br><span class="line"><span class="comment">    	2. 扩容后容量大于那个最大容量</span></span><br><span class="line"><span class="comment">    	3. 旧的临界值为 0 或 Integer.MIN_VALUE</span></span><br><span class="line"><span class="comment">    	4. 构造器传入初始容量为 0 */</span></span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">/* 按照 新容量 * 临界因子 的方法计算临界值。临界值不会超过一个指定的最大值 */</span></span><br><span class="line">        <span class="type">float</span> <span class="variable">ft</span> <span class="operator">=</span> (<span class="type">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="type">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="type">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 确定了容量和临界值，下面把旧数组元素移至新数组。</span></span><br><span class="line"><span class="comment">    	那个移动的场合，会以新容量重新计算所有元素的下标位置 */</span></span><br><span class="line">    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> <span class="title class_">Node</span>[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="literal">null</span>) &#123;</span><br><span class="line">                oldTab[j] = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="literal">null</span>)</span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="built_in">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="literal">null</span>, loTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="literal">null</span>, hiTail = <span class="literal">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="literal">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="literal">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="literal">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="literal">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="literal">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加 k - v 时，通过 key 的哈希值得到其在 table 的索引，判断索引位置是否被占用。</p>
<p>未占用的场合，直接添加。</p>
<p>占用的场合，判断其 key 是否相等。相等的场合，替换 value。否则，按照 树 或 链表 的方式处理。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 会先对放入元素的哈希值进行一次计算，得到一个数字：hash */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">h</span> <span class="operator">=</span> key.hashCode();</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="literal">null</span>) ? <span class="number">0</span> : (h ^ (h &gt;&gt;&gt; <span class="number">16</span>));	<span class="comment">// 位运算符：&gt;&gt;&gt; 无符号右移</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* put 方法会调用该 putVal 方法。</span></span><br><span class="line"><span class="comment">	那些传入值是：	hash、	key、	value、			false、				true */</span></span><br><span class="line"><span class="keyword">final</span> V <span class="title function_">putVal</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">boolean</span> onlyIfAbsent, <span class="type">boolean</span> evict)</span> &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab = table; 		<span class="comment">// &lt;- 是那个存放数据的 table 数组</span></span><br><span class="line">    <span class="type">int</span> n;							<span class="comment">// &lt;- 是 table.length</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 如果原先的 table 为空，则对其重新分配空间 */</span></span><br><span class="line">    <span class="keyword">if</span> (tab == <span class="literal">null</span> || (n = tab.length) == <span class="number">0</span>) &#123;</span><br><span class="line">        tab = resize();</span><br><span class="line">        n = tab.length;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 用方才计算的 hash 数，得到要放入元素的下标值 i</span></span><br><span class="line"><span class="comment">    	n - 1 是数据数组的最大下标，(n - 1) &amp; hash 必定不大于 n - 1 */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> (n - <span class="number">1</span>) &amp; hash;			<span class="comment">// 位运算符：&amp; 按位与</span></span><br><span class="line">    Node&lt;K,V&gt; p = tab[i];			<span class="comment">// 得到 table 中，位于那个插入位置的元素</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 倘若该位置为空，则直接放入 */</span></span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">null</span>) &#123;</span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 该位置不为空，意味着可能添加了重复元素 */</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt; e; 			<span class="comment">// &lt;- 被发现重复的那个 Node。无重复时结果为 null。这个 Node 的 value 会被替换。</span></span><br><span class="line">        <span class="type">K</span> <span class="variable">k</span> <span class="operator">=</span> p.key;			<span class="comment">// &lt;- 当前取出进行比较的 key 值</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 为了验证其是否重复，这里要进行如下比较：</span></span><br><span class="line"><span class="comment">        	1. 比较两者的 hash 数。不同的场合是不同元素</span></span><br><span class="line"><span class="comment">        	2. 使用 == 和 equals 两种方法比较 key。不同的场合是不同元素 </span></span><br><span class="line"><span class="comment">        	如果是相同元素，则该节点的值会被替换 */</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp; (k  == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">            e = p;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 此处节点结构是 树 的场合，还需遍历比较树的每个节点 */</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="built_in">this</span>, tab, hash, key, value);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 此处节点结构是 链表 的场合，还需遍历比较每个链表节点 */</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">binCount</span> <span class="operator">=</span> <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                e = p.next;</span><br><span class="line">                <span class="comment">/* e == null 意味着遍历结束，全部不同。这样，在此处添加那个新的 Node */</span></span><br><span class="line">                <span class="keyword">if</span> (e == <span class="literal">null</span>) &#123;</span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/* 故技重施，如果发现相同，则替换那个新元素 */</span></span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 经历上述比较后，e != null 意味着有元素要被替换了 */</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> e.value;</span><br><span class="line">            <span class="comment">/* 传入的参数 onluIfAbsent == false，所以此处一定是 true */</span></span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="literal">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);		<span class="comment">// &lt;- HashMap 中，该方法为空实现。</span></span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 如果到达这里，说明添加了元素（而非替换），要查看大小是否超过临界值 */</span></span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);		<span class="comment">// &lt;- HashMap 中，该方法为空实现。</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 上面提到的一些空实现的方法 */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">afterNodeAccess</span><span class="params">(Node&lt;K,V&gt; p)</span> &#123; &#125;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">afterNodeInsertion</span><span class="params">(<span class="type">boolean</span> evict)</span> &#123; &#125;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">afterNodeRemoval</span><span class="params">(Node&lt;K,V&gt; p)</span> &#123; &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="13-5-2-散列表-Hashtable"><a href="#13-5-2-散列表-Hashtable" class="headerlink" title="13.5.2 散列表 Hashtable"></a>13.5.2 散列表 Hashtable</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hashtable</span>&lt;K,V&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">Dictionary</span>&lt;K,V&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Map</span>&lt;K,V&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Hashtable 和 HashMap 基本一致，但Hashtable 是线程安全的 。但也因为如此，Hashtable 的效率低下。</p>
</blockquote>
<h4 id="Hashtable-与-HashMap-的比较："><a href="#Hashtable-与-HashMap-的比较：" class="headerlink" title="Hashtable 与 HashMap 的比较："></a>Hashtable 与 HashMap 的比较：</h4><table>
<thead>
<tr>
<th></th>
<th>版本</th>
<th>线程安全（同步）</th>
<th>效率</th>
<th>是否允许 null值</th>
</tr>
</thead>
<tbody><tr>
<td>Hashtable</td>
<td>1.0</td>
<td>安全</td>
<td>较低</td>
<td>不允许</td>
</tr>
<tr>
<td>HashMap</td>
<td>1.2</td>
<td>不安全</td>
<td>高</td>
<td>允许</td>
</tr>
</tbody></table>
<ul>
<li><p>Hashtable 底层也是有数组，默认构造器的初始容量为 11。临界值是 11 * 0.75 &#x3D; 8。</p>
</li>
<li><p>扩容大致如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> (oldCapacity &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>;			<span class="comment">//即，原容量 * 2 + 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Hashtable 不会树化</p>
</li>
</ul>
<h3 id="13-5-3-红黑树-TreeMap"><a href="#13-5-3-红黑树-TreeMap" class="headerlink" title="13.5.3 红黑树 TreeMap"></a>13.5.3 红黑树 TreeMap</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeMap</span>&lt;K,V&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">AbstractMap</span>&lt;K,V&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">NavigableMap</span>&lt;K,V&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>TreeMap 实现了 Map 接口。底层使用 红黑树 存储数据。</p>
<p>相较数组（访问快，检索、插入慢）和链表（插入快，检索、访问慢），树形数据结构（如二叉排序树）在保证数据检索速度的同时，也能保证数据插入、删除、修改的速度</p>
</blockquote>
<p><em><strong>——见 <a href="2022/06/02/14%20%E6%A0%91/#14-1-4-1-%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91">[14.1.4.1 平衡二叉树]</a></strong></em></p>
<h4 id="TreeMap-的源码："><a href="#TreeMap-的源码：" class="headerlink" title="TreeMap 的源码："></a>TreeMap 的源码：</h4><ol>
<li><p>TreeMap 底层维护了一个二叉树，以及一个比较器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Comparator&lt;? <span class="built_in">super</span> K&gt; comparator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> Entry&lt;K,V&gt; root;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建对象时，能采用无参构造，也能指定比较器完成构造</p>
<p>那个无参构造的场合，比较器为空。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">TreeMap</span><span class="params">()</span> &#123;</span><br><span class="line">    comparator = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">TreeMap</span><span class="params">(Comparator&lt;? <span class="built_in">super</span> K&gt; comparator)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.comparator = comparator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比较器如果为空，则要求传入的 key 必须是 Comparable 接口的实现子类，否则无法进行比较。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Object k1, Object k2)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> comparator==<span class="literal">null</span> ? ((Comparable&lt;? <span class="built_in">super</span> K&gt;)k1).compareTo((K)k2)</span><br><span class="line">        : comparator.compare((K)k1, (K)k2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加时，通过比较器确定那个添加位置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">    Entry&lt;K,V&gt; t = root;	<span class="comment">// &lt;- 树的根节点</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 二叉树为空的场合，创建根节点，将数据放入 */</span></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">null</span>) &#123;</span><br><span class="line">        compare(key, key);</span><br><span class="line">        root = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;&gt;(key, value, <span class="literal">null</span>);</span><br><span class="line">        size = <span class="number">1</span>;</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> cmp;				<span class="comment">// &lt;- 临时值，存放比较结果</span></span><br><span class="line">    Entry&lt;K,V&gt; parent;		<span class="comment">// &lt;- 临时值，存放父节点</span></span><br><span class="line">    Comparator&lt;? <span class="built_in">super</span> K&gt; cpr = comparator;		<span class="comment">// &lt;- 比较器</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 有比较器的场合，按照这个方法进行比较 */</span></span><br><span class="line">    <span class="keyword">if</span> (cpr != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            parent = t;</span><br><span class="line">            cmp = cpr.compare(key, t.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> t.setValue(value);</span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 比较器为空的场合，按照这个方法进行比较 */</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (key == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        Comparable&lt;? <span class="built_in">super</span> K&gt; k = (Comparable&lt;? <span class="built_in">super</span> K&gt;) key;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            parent = t;</span><br><span class="line">            cmp = k.compareTo(t.key);</span><br><span class="line">            <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">                t = t.left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cmp &gt; <span class="number">0</span>)</span><br><span class="line">                t = t.right;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> t.setValue(value);</span><br><span class="line">        &#125; <span class="keyword">while</span> (t != <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 将数据节点放到正确的路径下 */</span></span><br><span class="line">    Entry&lt;K,V&gt; e = <span class="keyword">new</span> <span class="title class_">Entry</span>&lt;&gt;(key, value, parent);</span><br><span class="line">    <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>)</span><br><span class="line">        parent.left = e;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        parent.right = e;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 此处会试着将该树转换成完全二叉树 */</span></span><br><span class="line">    fixAfterInsertion(e);</span><br><span class="line">    size++;</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加的最后，会试着将该树转换成完全二叉树</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">fixAfterInsertion</span><span class="params">(Entry&lt;K,V&gt; x)</span> &#123;</span><br><span class="line">    x.color = RED;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (x != <span class="literal">null</span> &amp;&amp; x != root &amp;&amp; x.parent.color == RED) &#123;</span><br><span class="line">        <span class="keyword">if</span> (parentOf(x) == leftOf(parentOf(parentOf(x)))) &#123;</span><br><span class="line">            Entry&lt;K,V&gt; y = rightOf(parentOf(parentOf(x)));</span><br><span class="line">            <span class="keyword">if</span> (colorOf(y) == RED) &#123;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(y, BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                x = parentOf(parentOf(x));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (x == rightOf(parentOf(x))) &#123;</span><br><span class="line">                    x = parentOf(x);</span><br><span class="line">                    rotateLeft(x);</span><br><span class="line">                &#125;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                rotateRight(parentOf(parentOf(x)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Entry&lt;K,V&gt; y = leftOf(parentOf(parentOf(x)));</span><br><span class="line">            <span class="keyword">if</span> (colorOf(y) == RED) &#123;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(y, BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                x = parentOf(parentOf(x));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (x == leftOf(parentOf(x))) &#123;</span><br><span class="line">                    x = parentOf(x);</span><br><span class="line">                    rotateRight(x);</span><br><span class="line">                &#125;</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(parentOf(parentOf(x)), RED);</span><br><span class="line">                rotateLeft(parentOf(parentOf(x)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    root.color = BLACK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="13-5-4-Properties"><a href="#13-5-4-Properties" class="headerlink" title="13.5.4 Properties"></a>13.5.4 Properties</h3><blockquote>
<p>Properties 继承自 Hashtable  并实现了 Map 接口。也使用键值对的方式保存数据</p>
<p>Properties 使用特点与 Hashtable 相似</p>
<p>Properties 还可以用于 xxx.properties 文件中，加载数据到 Properties 对象，进行读取和修改</p>
<p>xxx.properties 文件常作为配置文件</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Properties</span> <span class="keyword">extends</span> <span class="title class_">Hashtable</span>&lt;Object,Object&gt;</span><br></pre></td></tr></table></figure>

<p><em><strong>——关于这些，详见 <a href="2022/01/06/17%20IO%E6%B5%81/">[17 IO流 ]</a></strong></em></p>
<ul>
<li><p><code>String getProperty(String key)</code> ：输入一个 String 类型的 key，返回一个 String 的 value</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">getProperty</span><span class="params">(String key)</span> &#123;</span><br><span class="line"><span class="type">Object</span> <span class="variable">oval</span> <span class="operator">=</span> <span class="built_in">super</span>.get(key);</span><br><span class="line"><span class="type">String</span> <span class="variable">sval</span> <span class="operator">=</span> (oval <span class="keyword">instanceof</span> String) ? (String)oval : <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">return</span> ((sval == <span class="literal">null</span>) &amp;&amp; (defaults != <span class="literal">null</span>)) ? defaults.getProperty(key) : sval;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="13-6-无序集合接口-Set"><a href="#13-6-无序集合接口-Set" class="headerlink" title="13.6 无序集合接口 Set"></a>13.6 无序集合接口 Set</h2><blockquote>
<p>Set 是 Collection 接口的子类接口。</p>
<p>Set 接口的特点是无序（添加和取出顺序不一致，其取出顺序由某个算法决定），没有索引</p>
<p>不允许重复元素。故而，最多包含一个 null</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Set</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Collection</span>&lt;E&gt; </span><br></pre></td></tr></table></figure>



<h3 id="13-6-1-HashSet"><a href="#13-6-1-HashSet" class="headerlink" title="13.6.1 HashSet"></a>13.6.1 HashSet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HashSet</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">AbstractSet</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Set</span>&lt;E&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>HashSet 实现了 Set 接口。底层实际上使用 HashMap 来存储数据。<del>身在 Collection 心在 Map</del></p>
<p>HashSet 是无序的。其实际顺序取决于计算得到的 hash 值</p>
</blockquote>
<h4 id="HashSet-的源码"><a href="#HashSet-的源码" class="headerlink" title="HashSet 的源码"></a>HashSet 的源码</h4><ol>
<li><p>HashSet 底层是 HashMap。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> HashMap&lt;E,Object&gt; map;</span><br></pre></td></tr></table></figure>
</li>
<li><p>实例化也和 HashMap 相同</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">HashSet</span><span class="params">()</span> &#123;</span><br><span class="line">    map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashSet</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(initialCapacity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HashSet</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor)</span> &#123;</span><br><span class="line">    map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(initialCapacity, loadFactor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加一个元素时调用 HashMap 的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> map.put(e, PRESENT)==<span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="13-6-2-LinkedHashSet"><a href="#13-6-2-LinkedHashSet" class="headerlink" title="13.6.2 LinkedHashSet"></a>13.6.2 LinkedHashSet</h3><blockquote>
<p>LinkedHashSet 是 HashSet 的子类</p>
<p>LinkedHashSet 底层是一个 LinkedHashMap，维护了一个数组 + 双向链表。<del>有其父必有其子</del></p>
<p>LinkedHashSet 根据元素的 hashCode 值来决定元素的存储位置。同时，使用链表维护元素的次序。这使得元素看起来是以插入顺序保存的，并得以按照放入顺序取出</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedHashSet</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">extends</span> <span class="title class_">HashSet</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">Set</span>&lt;E&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<h4 id="LinkedHashSet-的源码："><a href="#LinkedHashSet-的源码：" class="headerlink" title="LinkedHashSet 的源码："></a>LinkedHashSet 的源码：</h4><ol>
<li><p>在类 HashSet 中，存在一个默认访问范围的构造器。该构造器不同于其他构造器，会让实例维护一个 LinkedHashMap </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HashSet(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor, <span class="type">boolean</span> dummy) &#123;</span><br><span class="line">    map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;(initialCapacity, loadFactor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>LinkedHashSet 的构造器即调用了该父类构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedHashSet</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(initialCapacity, loadFactor, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedHashSet</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(initialCapacity, <span class="number">.75f</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">LinkedHashSet</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(<span class="number">16</span>, <span class="number">.75f</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="13-6-3-TreeSet"><a href="#13-6-3-TreeSet" class="headerlink" title="13.6.3 TreeSet"></a>13.6.3 TreeSet</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TreeSet</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractSet</span>&lt;E&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">NavigableSet</span>&lt;E&gt;, Cloneable, java.io.Serializable</span><br></pre></td></tr></table></figure>

<blockquote>
<p>TreeSet 实现了 Set 接口，其底层是一个 TreeMap。<del>好家伙，原来 Set 全家都是卧底</del></p>
<p>调用无参构造器创建 TreeSet 时，默认是无序排列。也能在构造时传入一个比较器。有比较器的场合，比较器返回 0 时，不发生替换</p>
<p>不传入比较器的场合，使用的是传入对象自带的比较器。所以，这个场合，传入的 key 对象必须是 Comparable 接口的实现子类</p>
</blockquote>
<h2 id="13-7-集合的选择"><a href="#13-7-集合的选择" class="headerlink" title="13.7 集合的选择"></a>13.7 集合的选择</h2><p>在开发中，选择什么集合实现类，主要取决于业务操作特点，然后根据集合实现类特性进行分析选择。</p>
<p>判断存储的类型（一组对象 [单列]，或一组键值对 [双列]）</p>
<ul>
<li>一组对象：Collection 接口<ul>
<li>允许重复：List<ul>
<li>增删多：<code>LinkedList</code> （双向链表）</li>
<li>改查多：ArrayList （<code>Object[]</code> 数组）</li>
</ul>
</li>
<li>不允许重复：Set<ul>
<li>无序：HashSet （数组 + 链表 + 红黑树，底层是 HashMap）</li>
<li>排序：<code>TreeSet</code></li>
<li>顺序一致：LinkedHashSet （数组 + 双向链表，底层是 <code>LinkedHashMap</code>）</li>
</ul>
</li>
</ul>
</li>
<li>一组键值对：Map<ul>
<li>键无序：HashMap （数组 + 链表 + 红黑树 [ JDK 8 以后 ] ）</li>
<li>键排序：<code>TreeMap</code></li>
<li>键顺序一致：<code>LinkedHashMap</code> （底层是 HashMap）</li>
<li>读取文件：Properties</li>
</ul>
</li>
</ul>
<h2 id="13-8-工具类-Collections"><a href="#13-8-工具类-Collections" class="headerlink" title="13.8 工具类 Collections"></a>13.8 工具类 Collections</h2><blockquote>
<p>Collections 工具类是一个操作 Set、List、Map 等集合的工具类</p>
<p>其中提供了一系列静态方法，对集合元素进行 排序、查询和修改等操作</p>
</blockquote>
<h4 id="常用方法：-7"><a href="#常用方法：-7" class="headerlink" title="常用方法："></a>常用方法：</h4><p><strong>排序：</strong></p>
<ul>
<li><code>reverse(List)</code>：反转 List 中元素的排序</li>
<li><code>shuffle(List)</code>：对 <code>List </code> 中元素进行随机排序</li>
<li><code>sort(List)</code>：根据元素的自然顺序对指定 List 集合元素升序排列</li>
<li><code>reverse(List, Comparator)</code>：根据指定 Comparator 对 List 排序</li>
<li><code>swap(List, int, int)</code>：将两处元素位置互换</li>
</ul>
<p><strong>查找、替换：</strong></p>
<ul>
<li><p><code>Object max(Collection)</code>：根据元素的自然排序，返回集合中最大的元素</p>
</li>
<li><p><code>Object max(Collection, Comparator)</code>：根据比较器，返回最大元素</p>
</li>
<li><p><code>Object min(Collection)</code>：根据元素的自然排序，返回最小元素</p>
</li>
<li><p><code>Object min(Collection, Comparator)</code>：根据比较器，返回最小元素</p>
</li>
<li><p><code>int frequency(Collection, Object)</code>：返回集合中指定元素的出现次数</p>
</li>
<li><p><code>void copy(List dest, List src)</code>：将 src 的内容复制到 dest 中</p>
<p>这个场合，要保证 dest 的大小不小于 src。所以，可能需要先给 dest 赋值</p>
</li>
<li><p><code>boolean replaceAll(List list, Object oldVal, Object newVal)</code>：用 newVal 替换所有 oldVal 值</p>
</li>
</ul>
<h2 id="13-9-JUnit"><a href="#13-9-JUnit" class="headerlink" title="13.9 JUnit"></a>13.9 JUnit</h2><blockquote>
<p>一个类有多个功能代码需要测试，为了测试，就要写入 <code>main</code> 方法中</p>
<p>如果有多个功能代码测试，需要反复撤销，过程繁琐</p>
</blockquote>
<blockquote>
<p>JUnit 是一个 Java 语言单元测试框架</p>
<p>多数 Java 开发环境都已集成了 JUnit 作为单元测试工具</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1fh411y7R8?p=566&t=259.3" title="看这个吧">使用方法</a></p>
<p>……总的来讲，方法就是加入 <code>@Test</code>，然后 <code>alt + enter</code> 引入 JUnit 5，最后运行</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" data-id="claq4naml0006p4tf5nx38uhi" data-title="&lt;Java&gt;13 Java 数据结构" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-15 图形界面设计" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/" class="article-date">
  <time class="dt-published" datetime="2022-04-21T16:00:00.000Z" itemprop="datePublished">2022-04-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/">&lt;Java&gt;15 图形界面设计</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="15-图形界面设计"><a href="#15-图形界面设计" class="headerlink" title="15 图形界面设计"></a>15 图形界面设计</h1><blockquote>
<p>图形用户界面（Graphical User Interface，简称 GUI）是大多数程序不可缺少的部分。</p>
<p>Java 的图形界面由各种组件组成。在 java.awt 和 java.swing 包中定义了多种用于创建图形用户界面的组件类。</p>
<p>Swing 组件和 AWT 组件最大的不同是 Swing 组件实现时不包含任何本地代码，因此不受硬件平台的限制，而具有更多的功能，并且在任何平台上运行效果都是相同的。不包含本地代码的 Swing 组件被称为 “轻量级” 组件，而 AWT 被称为 “重量级” 组件。两种组件一同使用的场合，AWT 总是显示在上面。</p>
</blockquote>
<p>设计用户界面是一般有 3 个步骤：</p>
<ol>
<li>选取组件</li>
<li>设计布局</li>
<li>响应事件</li>
</ol>
<h2 id="15-1-容器"><a href="#15-1-容器" class="headerlink" title="15.1 容器"></a>15.1 容器</h2><blockquote>
<p>组件分为容器组件和非容器组件。容器组件即可以包含其他组件的组件。非容器组件必须包含在容器组件中。</p>
<p>容器组件分为：顶层容器、一般用途容器</p>
</blockquote>
<h3 id="15-1-1-顶层容器"><a href="#15-1-1-顶层容器" class="headerlink" title="15.1.1 顶层容器"></a>15.1.1 顶层容器</h3><p>Swing 中提供了 4 种顶层容器：</p>
<ul>
<li>JFrame：带有标题行和控制按钮（最小化、恢复&#x2F;最大化、关闭）的独立窗口。有时称为框架。创建程序时要使用 JFream</li>
<li>JApplet：创建小应用程序时要使用 JApplet。其被包含在浏览器窗口中</li>
<li>JDialog：创建对话框时使用 JDialog</li>
<li>JWindow：一个不带有标题行和控制按钮的窗口。一般很少使用</li>
</ul>
<p>构造方法：</p>
<ul>
<li><code>new JFrame()</code>：构造一个初始不可见，无标题的新框架窗体</li>
<li><code>new JFrame(&quot;Title&quot;)</code>：构造一个初始不可见，具有指定标题的新框架窗体</li>
</ul>
<p>常用方法：</p>
<ul>
<li><p><code>void setBounds(int x, int y, int width, int height)</code>：移动并调整框架大小。框架左上角位置为（x, y），框架大小为 width × height</p>
</li>
<li><p><code>void setSize(int width, int height)</code>：设置窗口大小</p>
</li>
<li><p><code>void setBackground(Color bg)</code>：设置框架背景色</p>
<p><code>void setForeground(Color fg)</code>：设置框架前景色</p>
</li>
<li><p><code>void setVisible(boolean aFlag)</code>：设置可见性</p>
</li>
<li><p><code>void pack()</code>：自适应框架大小，以符合子组件的首选大小和布局</p>
</li>
<li><p><code>void setTitle(String title)</code>：设置标题</p>
</li>
<li><p><code>Container getContentPane()</code>：返回此框架窗体的内容窗格对象</p>
<p><em>Container 类是所有容器类的父类，包含容器的共有操作</em></p>
<p><code>void setContentPane(Container contentPane)</code>：把指定内容窗格设置为此框架的内容窗格对象</p>
</li>
<li><p><code>void setLayout(LayoutManager manager)</code>：设置布局管理器</p>
</li>
</ul>
<p>​		<em><strong>—— 哦我的上帝啊，如果有什么名词是你不懂的，为什么不试着继续看下去呢？</strong></em></p>
<h3 id="15-1-2-内容窗格"><a href="#15-1-2-内容窗格" class="headerlink" title="15.1.2 内容窗格"></a>15.1.2 内容窗格</h3><blockquote>
<p>4 个顶层容器每个都有 1 个内容窗格。除菜单外，顶层容器的所有组件都放在这个内容窗格内。</p>
</blockquote>
<ul>
<li><p>直接添加组件至内容窗格</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Container</span> <span class="variable">contentPane</span> <span class="operator">=</span> jframe.getContentPane();		<span class="comment">//[1] 获取内容窗格对象</span></span><br><span class="line">contentPane.add(button, BorderLayout.CENTER);			<span class="comment">//[2] 将组件添加到内容窗格</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><p>使用顶层容器的 <code>getContentPane()</code> 方法获得其内容窗格对象。</p>
</li>
<li><p>将组件添加到内容窗格。</p>
<p>其中 button 是一个按钮控件，BorderLayout.CENTER 代表位置在中间</p>
<p>向顶层容器内容窗格添加组件时，也可以直接调用顶层容器的 add() 方法</p>
</li>
</ol>
</blockquote>
</li>
<li><p>以新的内容窗格代替原有内容窗格</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JPanel</span> <span class="variable">contentPane</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();					<span class="comment">//[1] 创建 JPanel 实例</span></span><br><span class="line">contentPane.setLayout(<span class="keyword">new</span> <span class="title class_">BorderLayout</span>());			<span class="comment">//[2] 创建布局管理器</span></span><br><span class="line">contentPane.add(button, BorderLayout.CENTER);		<span class="comment">//[3] 添加组件</span></span><br><span class="line">jfream.setContentPane(contentPane);					<span class="comment">//[4] 添加内容窗格</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><p>创建 JPanel（面板）实例。JPanel 是 Container 的子类。</p>
</li>
<li><p>顶层容器默认的布局管理器是 BorderLayout，而 JPanel 的默认布局管理器是 FlowLayout</p>
</li>
<li><p>通过 <code>setContentPane(contentPane)</code> 方法为 jfream 设置新的内容窗格</p>
</li>
</ol>
</blockquote>
</li>
</ul>
<h3 id="15-1-3-面板"><a href="#15-1-3-面板" class="headerlink" title="15.1.3 面板"></a>15.1.3 面板</h3><blockquote>
<p>普通面板（JPanel）和滚动面板（JScrollPanel）都是用途广泛的容器。面板与顶层容器不同，不能独立存在，而必须添加到其他容器内部。面板可以嵌套，由此可以设计出复杂的图形用户界面。</p>
</blockquote>
<h4 id="15-1-3-1-JPanel"><a href="#15-1-3-1-JPanel" class="headerlink" title="15.1.3.1 JPanel"></a>15.1.3.1 JPanel</h4><p><strong>构造方法：</strong></p>
<ul>
<li><code>new JPanel()</code>：创建具有 FlowLayout 布局的新面板</li>
<li><code>new JPanel(LayoutManager layout)</code>：创建指定布局的新面板</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><code>Component add(Compinent comp)</code>：将指定组件添加至面板</li>
</ul>
<h4 id="15-1-3-2-JScrollPanel"><a href="#15-1-3-2-JScrollPanel" class="headerlink" title="15.1.3.2 JScrollPanel"></a>15.1.3.2 JScrollPanel</h4><p>JScrollPanel 是一个带有滚动条的面板，但只能添加一个组件。添加多个组件的场合，先将那些组件添加入 JPanel 对象，再将该 JPanel 对象添加进 JScrollPanel 对象中</p>
<p><strong>构造方法：</strong></p>
<ul>
<li><code>new JScrollPanel()</code>：创建一个空的 JScrollPanel。水平、垂直滚动条都能显示</li>
<li><code>new JScrollPanel(Component view)</code>：创建指定组件内容的 JScrollPanel</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>void setHorizontalScrollBarPolicy(int policy)</code>：确定水平滚动条何时显示</p>
<p>其中 policy 的可选值是以下三种：</p>
<ul>
<li>ScrollPaneConstants.HORIZONTAL_SCROLLBAR_AS_NEEDED：需要时可见</li>
<li>ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER：永远不可见</li>
<li>ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS：永远可见</li>
</ul>
</li>
<li><p><code>void setVerticalScrollBarPolicy(int policy)</code>：确定垂直滚动条何时显示</p>
<p>其中 policy 的可选值是以下三种：</p>
<ul>
<li>ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED：需要时可见</li>
<li>ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER：永远不可见</li>
<li>ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS：永远可见</li>
</ul>
</li>
</ul>
<h4 id="15-1-3-3-Scrollbar"><a href="#15-1-3-3-Scrollbar" class="headerlink" title="15.1.3.3 Scrollbar"></a>15.1.3.3 Scrollbar</h4><p>AWT 中还有一个滚动条组件，提供了允许用户在一定范围的值中进行选择的便捷方式</p>
<p><strong>构造器：</strong></p>
<ul>
<li><p><code>new Scrollbar()</code>：构造一个新的滚动条</p>
</li>
<li><p><code>new Scrollbar(int orientation)</code>：构造一个有指定方向的滚动条</p>
<p>其中 orientation 的可选值是：</p>
<ul>
<li>Scrollbar.HORIZONTAL：水平滚动条</li>
<li>Scrollbar.VERTICAL：垂直滚动条</li>
</ul>
</li>
<li><p><code>new Scrollbar(int orientation, int value, int visible, int minimum, int maximun)</code>：构造一个有初始方向、初始值、可视量、最小&#x2F;最大值的滚动条</p>
</li>
</ul>
<h2 id="15-2-标签和按钮"><a href="#15-2-标签和按钮" class="headerlink" title="15.2 标签和按钮"></a>15.2 标签和按钮</h2><h3 id="15-2-1-标签"><a href="#15-2-1-标签" class="headerlink" title="15.2.1 标签"></a>15.2.1 标签</h3><blockquote>
<p>标签（JLable）是最简单的 Swing 组件，通常用于显示提示性的文本信息或图标。其不可被编辑</p>
</blockquote>
<p><strong>构造器：</strong></p>
<ul>
<li><p><code>new JLable()</code>：构造一个不显示文本或图标的空标签</p>
</li>
<li><p><code>new JLable(Icon image)</code>：构造一个显示图标的标签</p>
</li>
<li><p><code>new JLable(String text)</code>：构造一个显示文本的标签</p>
</li>
<li><p><code>new JLable(Icon image, int horizontalAlignment)</code>：构造一个显示图标的标签，并指定水平对齐方式</p>
<p>其中 horizontalAlignment 的取值可以是：</p>
<ul>
<li>JLable.LEFT：左对齐</li>
<li>JLable.RIGHT：右对齐</li>
<li>JLable.CENTER：居中对齐</li>
</ul>
</li>
<li><p><code>new JLable(String text, int horizontalAlignment)</code>：构造一个显示文本的标签，并指定水平对齐方式</p>
</li>
<li><p><code>new JLable(String text, Icon image, int horizontalAlignment)</code>：构造一个同时显示文本和图标的标签，并指定水平对齐方式</p>
</li>
</ul>
<h3 id="15-2-2-按钮"><a href="#15-2-2-按钮" class="headerlink" title="15.2.2 按钮"></a>15.2.2 按钮</h3><blockquote>
<p>按钮（JButton）是 Java 图形用户界面的基本组件之一。</p>
<p>经常用到的按钮有 4 种形式：按钮（JButton）、切换按钮（JToggleButton）、复选按钮（JCheckButton）、单选按钮（JRadioButton）</p>
<p>这些按钮类均是 AbstractButton 的子类或间接子类</p>
</blockquote>
<h4 id="15-2-2-1-JButton"><a href="#15-2-2-1-JButton" class="headerlink" title="15.2.2.1 JButton"></a>15.2.2.1 JButton</h4><p><strong>构造器：</strong></p>
<ul>
<li><code>new JButton()</code>：构造一个既没有文本也没有图标的按钮</li>
<li><code>new JButton(Icon icon)</code>：构造一个有图标的按钮</li>
<li><code>new JButton(String text)</code>：构造一个有文本的按钮</li>
<li><code>new JButton(String text, Icon icon)</code>：构造一个有文本也有图标的按钮</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>void setMnemonic(int mnemonic)</code>：设置当前按钮的键盘助记符</p>
</li>
<li><p><code>void setText(String text)</code>：设置按钮的文本</p>
<p><code>void setIcon(Icon icon)</code>：设置按钮图标</p>
</li>
<li><p><code>void setEnabled(boolean mod)</code>：是否启用按钮</p>
</li>
<li><p><code>String getText()</code>：返回按钮的文本</p>
</li>
<li><p><code>void setToolTipText()</code>：设置提示文本</p>
</li>
<li><p><code>void addActionListener(ActionListener l)</code>：为按钮添加事件监听程序</p>
<p><code>void removeActionListener(ActionListener l)</code>：移除事件监听程序</p>
</li>
</ul>
<h4 id="15-2-2-2-JToggleButton、JCheckButton、JRadioButton"><a href="#15-2-2-2-JToggleButton、JCheckButton、JRadioButton" class="headerlink" title="15.2.2.2 JToggleButton、JCheckButton、JRadioButton"></a>15.2.2.2 JToggleButton、JCheckButton、JRadioButton</h4><blockquote>
<p>JToggleButton 是有两种状态（选中状态、未选中状态）的按钮。通过点击切换这两种状态</p>
<p>JCheckButton、JRadioButton 是 JToggleButton 的子类，构造方法与 JToggleButton 相同。</p>
</blockquote>
<p><strong>构造器：</strong></p>
<ul>
<li><p><code>new JToggleButton()</code>：构造一个没有文本也没有图标的切换按钮</p>
</li>
<li><p><code>new JToggleButton(Icon icon)</code>：构造一个有图标的切换按钮</p>
<p><code>new JToggleButton(Icon icon, boolean selected)</code>：构造一个有图标的切换按钮，设置其初始状态</p>
</li>
<li><p><code>new JToggleButton(String text)</code>：构造一个有文本的切换按钮</p>
<p><code>new JToggleButton(String text, boolean selected)</code></p>
</li>
<li><p><code>new JToggleButton(String text, Icon icon)</code>：构造一个有文本也有图标的切换按钮</p>
<p><code>new JToggleButton(String text, Icon icon, boolean selected)</code></p>
</li>
</ul>
<p><strong>常用方法（除 JButton 方法外）：</strong></p>
<ul>
<li><p><code>boolean isSeleced()</code>：获取按钮的当前状态</p>
</li>
<li><p><code>void addItemListener(ItemListener l)</code>：为按钮添加事件侦听程序</p>
<p><code>void removeItemListener(ItemListener l)</code>：移除事件侦听程序</p>
</li>
</ul>
<h2 id="15-3-布局管理器"><a href="#15-3-布局管理器" class="headerlink" title="15.3 布局管理器"></a>15.3 布局管理器</h2><blockquote>
<p>容器中包含了组件。组件的布局，包括其位置和大小，通常由布局管理器负责安排。每个容器都有一个默认的布局管理器。</p>
</blockquote>
<h3 id="15-3-1-FlowLayout-流布局管理器"><a href="#15-3-1-FlowLayout-流布局管理器" class="headerlink" title="15.3.1 FlowLayout 流布局管理器"></a>15.3.1 FlowLayout 流布局管理器</h3><blockquote>
<p>FlowLayout 定义在 java.awt 包中。</p>
</blockquote>
<p><strong>构造器：</strong></p>
<ul>
<li><p><code>new FlowLayout()</code>：创建默认的 FlowLayout 布局管理器。</p>
<p>居中对齐。默认水平、垂直间距是 5 像素</p>
</li>
<li><p><code>new FlowLayout(int align)</code>：创建一个 FlowLayout 布局管理器。</p>
<p>指定对齐方式。默认水平、垂直间距是 5 像素</p>
<p>align 的可选值有这些：</p>
<ul>
<li>FlowLayout.LEFT：左对齐</li>
<li>FlowLayout.RIGHT：右对齐</li>
<li>FlowLayout.CENTER：居中对齐</li>
</ul>
</li>
<li><p><code>new FlowLayout(int align, int hgap, int vgap)</code>：创建一个 FlowLayout 布局管理器。</p>
<p>指定对齐方式。指定水平、垂直间距</p>
</li>
</ul>
<p><strong>使用说明：</strong></p>
<ol>
<li>FlowLayout 对容器中组件进行布局的方式是将组件逐个放置在容器中的一行上。一行满后，另起一行。</li>
<li>与其他布局管理器不同。FlowLayout 不会强行设定组件的大小，而是通过每个组件的 getPreferredSize() 方法获取其各自的期望大小</li>
</ol>
<h3 id="15-3-2-BorderLayout-边界布局管理器"><a href="#15-3-2-BorderLayout-边界布局管理器" class="headerlink" title="15.3.2 BorderLayout 边界布局管理器"></a>15.3.2 BorderLayout 边界布局管理器</h3><blockquote>
<p>BorderLayout 定义在 java.awt 包中，是顶层容器的默认布局管理器。它提供了一种较为复杂的组件布局管理方案。</p>
</blockquote>
<p><strong>构造方法：</strong></p>
<ul>
<li><code>new BorderLayout()</code>：一个组件间没有间距的布局管理器</li>
<li><code>new BorderLayout(int hgap, int vgap)</code>：定义水平、垂直间距的布局管理器</li>
</ul>
<p><strong>使用说明：</strong></p>
<ol>
<li>每个由 BorderLayout 管理的容器被划分成 5 个区域，分别是容器的 上部（BorderLayout.NORTH）、下部（BorderLayout.SOUTH）、左部（BorderLayout.WEST）、右部（BorderLayout.EAST）、中部（BorderLayout.CENTER）</li>
<li>在 BorderLayout 布局管理器的管理下，组件必须通过 add() 方法加入容器的指定区域。不指定的场合，默认加入中部区域</li>
<li>容器的每个区域仅能加入一个组件。加入了多个组件的场合，只有最后一个生效</li>
<li>对于中部以外的 4 个边界区域，没有使用的区域的大小将变为零。此时，中部区域会扩展并占据该未用区域的位置。如果 4 个边界区域都没有使用，中部区域会占据整个窗口。</li>
<li>窗口大小改变时，按钮的相对位置不会变化。但按钮的大小会改变</li>
</ol>
<h3 id="15-3-3-GridLayout-网格布局管理器"><a href="#15-3-3-GridLayout-网格布局管理器" class="headerlink" title="15.3.3 GridLayout 网格布局管理器"></a>15.3.3 GridLayout 网格布局管理器</h3><blockquote>
<p>GridLayout 定义在 java.awt 包中，是一种网格式的布局管理器。</p>
</blockquote>
<p><strong>构造器：</strong></p>
<ul>
<li><p><code>new GridLayout()</code>：创建一个一行的网格。列数根据实际需要决定</p>
</li>
<li><p><code>new GridLayout(int rows, int cols)</code>：指定行数、列数的网格布局</p>
<p>rows 和 cols 中，最多有一个可以是 0，但不能都为 0。那个为 0 的场合，根据实际需要决定数量</p>
</li>
<li><p><code>new GridLayout(int rows, int cols, int hgap, int vgap)</code>：指定行数、列数，也指定水平、垂直间距的网格</p>
</li>
</ul>
<p><strong>使用说明：</strong></p>
<ol>
<li><p>GridLayout 将容器空间划分成若干行乘若干列的网格。组件依次放入其中，每个组件占据一格</p>
</li>
<li><p>网格每列宽度相同，每行高度相同。组件放入的次序决定了其位置</p>
</li>
<li><p>想要组件间留有空白的场合，可以添加一个空白标签</p>
</li>
<li><p>网格数多于组件数的场合，那些多余的格子为空白。</p>
<p>网格数少于组件数的场合，系统根据需要适当添加。</p>
</li>
<li><p>窗口大小改变时，按钮的相对位置不会变化。但按钮的大小会改变</p>
</li>
</ol>
<h3 id="15-3-4-CardLayout-卡片式布局管理器"><a href="#15-3-4-CardLayout-卡片式布局管理器" class="headerlink" title="15.3.4 CardLayout 卡片式布局管理器"></a>15.3.4 CardLayout 卡片式布局管理器</h3><blockquote>
<p>CardLayout 定义在 java.awt 包中，是一种卡片式的布局管理器。</p>
</blockquote>
<p><strong>构造器：</strong></p>
<ul>
<li><code>new CardLayout()</code>：一个默认无间距的 CardLayout 布局管理器</li>
<li><code>new CardLayout(int hgap, int vgap)</code>：指定水平、垂直间距的 CardLayout 布局管理器</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>void first(Container parent)</code>：翻转到容器的第一张卡片</p>
<p><code>void next(Container parent)</code>：翻转到下一张卡片。当前是最后一张的场合，翻到第一张卡片</p>
<p><code>void previous(Container parent)</code>：翻转到前一张卡片。当前是第一张的场合，翻到最后一张卡片</p>
<p><code>void last(Container parent)</code>：翻转到容器的最后一张卡片</p>
</li>
<li><p><code>void show(Container parent, String name)</code>：翻转到卡片集中具有指定 name 的卡片。没有该卡片的场合不执行任何操作</p>
</li>
</ul>
<p><strong>使用说明：</strong></p>
<ol>
<li>CardLayout 将容器中的组件处理为一系列卡片，每一刻只显示其中一张。</li>
<li>容器第一次显示时，显示第一个添加的组件。</li>
</ol>
<h3 id="15-3-5-BoxLayout-方框布局管理器"><a href="#15-3-5-BoxLayout-方框布局管理器" class="headerlink" title="15.3.5 BoxLayout 方框布局管理器"></a>15.3.5 BoxLayout 方框布局管理器</h3><blockquote>
<p>BoxLayout 定义在 javax.swing 包中，其组件横排一行或竖排一列，但宽度（高度）可以不同。</p>
</blockquote>
<p><strong>构造器：</strong></p>
<ul>
<li><p><code>new BoxLayout(Container target, int axis)</code>：创建一个沿给定轴放置组件的布局管理器</p>
<p>其中 target 表明为哪个容器设置此布局管理器，axis 指明组件排列方向</p>
<p>axis 的值是：</p>
<ul>
<li>BoxLayout.X_AXIS：水平方向排列</li>
<li>BoxLayout.Y_AXIS：竖直方向排列</li>
</ul>
<p>举个例子：</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">JPanel</span> <span class="variable">jp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br><span class="line">jp.setLayout(<span class="keyword">new</span> <span class="title class_">BoxLayout</span>(jp, BoxLayout.X_AXXIS));</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<p><strong>使用说明：</strong></p>
<ol>
<li>BoxLayout 将容器中的组件横排一行或竖排一列。那些组件横排一行时，可以有不同宽度；竖排一列时，可以有不同的高度。</li>
<li>窗口大小改变时，按钮的相对位置不会变化。</li>
</ol>
<p><strong>Box 类</strong></p>
<blockquote>
<p>javax.swing 中定义了一个专门使用 BoxLayout 的容器 Box 类。</p>
</blockquote>
<ul>
<li><p><code>static Box createHorizontalBox()</code>：返回一个使用水平方向的 BoxLayout 的 Box</p>
<p><code>static Box createVerticalBox()</code>：返回一个使用竖直方向的 BoxLayout 的 Box</p>
</li>
<li><p><code>static Component createHorizontalGlue()</code>：创建一个水平方向的不可视的组件（填满剩余空间）</p>
<p><code>static Component createVerticalGlue()</code></p>
</li>
<li><p><code>static Component createHorizontalStrut()</code>：创建一个水平方向的不可视的组件（指定宽高）</p>
<p><code>static Component createVerticalStrut()</code></p>
</li>
<li><p><code>static Component createRigidArea()</code>：创建一个不可视的组件，不大不小，尺寸真是好极了</p>
</li>
</ul>
<h3 id="15-3-6-空布局"><a href="#15-3-6-空布局" class="headerlink" title="15.3.6 空布局"></a>15.3.6 空布局</h3><blockquote>
<p>其实也能不用布局管理器的，真的</p>
</blockquote>
<ol>
<li>调用容器的 <code>setLayout(null)</code> 将容器的布局管理器置空</li>
<li>&#x3D;调用组件的 <code>setBounds(x, y, w, h)</code> 方法设置其位&#x3D;置和大小。<del>老东西，你的布局管理器最没用啦！</del></li>
</ol>
<h2 id="15-4-事件处理"><a href="#15-4-事件处理" class="headerlink" title="15.4 事件处理"></a>15.4 事件处理</h2><blockquote>
<p>Java 运行时，如果用户进行某个操作，程序应当做出相应。</p>
<p>程 · 序 · 无 · 响 · 应（噔 噔 咚）</p>
<p>……总之，用户在程序界面进行的操作称为用户事件，对事件的相应称为事件处理。</p>
</blockquote>
<h3 id="15-4-1-事件处理模型"><a href="#15-4-1-事件处理模型" class="headerlink" title="15.4.1 事件处理模型"></a>15.4.1 事件处理模型</h3><blockquote>
<p>Java 事件处理是采取 “委派事件模型”。当事件发生时，产生事件类对象。这里说的事件类对象实际上就是 <code>java.awt.event</code> 事件类库里某个类创建的对象。操作不同的场合，事件类对象不同。</p>
<p>会把此事件类对象传递给事件侦听程序处理。它是实现了对应侦听程序接口的一个类。</p>
<p>事件只是一个对象，其只向注册的侦听程序报告</p>
</blockquote>
<p>示范一个简单的事件处理：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.seing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;													<span class="comment">//[0]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Code_15_4_1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="type">Button</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Button</span>(<span class="string">&quot;Button&quot;</span>);</span><br><span class="line">        b.addActionListener((e) -&gt; System.out.println(<span class="string">&quot;Pressed&quot;</span>));	<span class="comment">//[1]</span></span><br><span class="line">        <span class="type">JFrame</span> <span class="variable">jFrame</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JFrame</span>(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line">        jFrame.setBounds(<span class="number">30</span>, <span class="number">30</span>, <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">        jFrame.add(b);</span><br><span class="line">        jFrame.setVisible(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="0">
<li><p>引入 java.awt.event 包</p>
</li>
<li><p>注册事件侦听程序，并实现其方法</p>
<p>示例中的简写其实相当于以下代码（匿名内部类）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b.addActionListener(<span class="keyword">new</span> <span class="title class_">ActionListener</span>() &#123;</span><br><span class="line">    <span class="meta">@OverRide</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span> <span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Pressed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><em><strong>—— 示例写法见 [27 Java8 新特性]</strong></em></p>
<p>事件侦听程序可以定义在单独的类中，也可以定义在组件类中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyButton</span> <span class="keyword">extends</span> <span class="title class_">JButton</span> <span class="keyword">implements</span> <span class="title class_">ActionListener</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyButton</span><span class="params">()</span> &#123;</span><br><span class="line">        addActionListener(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	                           </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Pressed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</blockquote>
<h3 id="15-4-2-事件的种类"><a href="#15-4-2-事件的种类" class="headerlink" title="15.4.2 事件的种类"></a>15.4.2 事件的种类</h3><blockquote>
<p>在 java.awt.event 包和 javax.swing.event 包中定义了很多其他的事件类。每种事件类有一个对应的接口，接口中声明了一个或多个抽象的事件处理方法。</p>
</blockquote>
<table>
<thead>
<tr>
<th>事件类</th>
<th>组件</th>
<th>方法及说明</th>
</tr>
</thead>
<tbody><tr>
<td>ActionEvent</td>
<td>JButton、JCheckBox、JComboBox、JMenuItem、JRaidoButton</td>
<td>actionPerformed(e) 单击按钮、选择菜单项或在文本框中按回车时</td>
</tr>
<tr>
<td>AdjustmentEvent</td>
<td>JScrollBar</td>
<td>adjustmentValueChanged(e) 当改变滚动条滑块位置时</td>
</tr>
<tr>
<td>ComponentEvent</td>
<td>JComponent 及其子类</td>
<td>componentMoved(e) 组件移动时；componentHidden(e) 组件隐藏时；componenetResized(e) 组件缩时；componentShown(e) 组件显示时</td>
</tr>
<tr>
<td>ContainerEvent</td>
<td>JContainer 及其子类</td>
<td>containerAdded(e) 添加组件时；containerMoved(e)移除组件时</td>
</tr>
<tr>
<td>FocusEvent</td>
<td>同 ComponentEvent</td>
<td>focusGained(e) 组件获得焦点时；focusLost(e) 组件失去焦点时</td>
</tr>
<tr>
<td>ItemEvent</td>
<td>JCheckBox、JCheckboxMenuItem、JComboBox</td>
<td>itemStateChanged(e) 选择复选框、选项框、单击列表框、选中带复选框菜单时</td>
</tr>
<tr>
<td>KeyEvent</td>
<td>同 ComponentEvent</td>
<td>keyPressed(e) 键按下时；keyReleased(e) 键释放时；keyTaped(e) 击键时</td>
</tr>
<tr>
<td>MouseEvent</td>
<td>同 ComponentEvent</td>
<td>mousePressed(e) 鼠标按下时；mouseEntered(e) 鼠标进入时；mouseExited(e) 鼠标离开时；mouseClicked(e) 鼠标点击时；mouseReleased(e) 鼠标释放时</td>
</tr>
<tr>
<td>MouseMotionEvent</td>
<td>同 ComponentEvent</td>
<td>mouseDragged(e) 鼠标拖放时；mouseMoved(e) 鼠标移动时</td>
</tr>
<tr>
<td>TextEvent</td>
<td>JTextField、JTextArea</td>
<td>textValueChanged(e) 文本框、多行文本框内容修改时</td>
</tr>
<tr>
<td>WindowEvent</td>
<td>JFrame、JWindow、JDialog</td>
<td>windowOpened(e) 窗口打开时；windowClosing(e) 窗口关闭时；windowClosed(e) 窗口关闭后；windowActived(e) 窗口激活时；windowDeactivated(e) 窗口失去焦点时；windowIconified(e) 窗口最小化时；WindowDeiconified(e) 窗口最小化还原时</td>
</tr>
</tbody></table>
<p>使用说明：</p>
<ol>
<li><p>XXXEvent 事件类的接口名就是 XXXListener。占地方太大，上面就没写</p>
</li>
<li><p>事件侦听模式允许为一个组件多次调用 addListener 方法，注册多个侦听程序。</p>
<p>事件发生时，单个事件的多个侦听程序的调用顺序不确定。</p>
</li>
<li><p>调用事件处理方法时会传入一个参数。该参数就是那些事件类实例，其中包含事件有关的重要信息。</p>
<p>调用这些事件类实例各自特有的方法获取这些信息。</p>
</li>
</ol>
<h3 id="15-4-3-事件适配器"><a href="#15-4-3-事件适配器" class="headerlink" title="15.4.3 事件适配器"></a>15.4.3 事件适配器</h3><blockquote>
<p>侦听程序必须实现接口的全部抽象方法，但有时我们只关心其中的某一种方法。为了编程方便，Java 为一些声明了多个抽象方法的 Listener 接口提供了相应的适配器类。</p>
</blockquote>
<table>
<thead>
<tr>
<th>接口名称</th>
<th>适配器名称</th>
</tr>
</thead>
<tbody><tr>
<td>ComponentListener</td>
<td>ComponentAdapter</td>
</tr>
<tr>
<td>ContainerListener</td>
<td>ContainerAdapter</td>
</tr>
<tr>
<td>FocusListener</td>
<td>FocusAdapter</td>
</tr>
<tr>
<td>KeyListener</td>
<td>KeyAdapter</td>
</tr>
<tr>
<td>MouseListener</td>
<td>MouseAdapter</td>
</tr>
<tr>
<td>MouseMotionListener</td>
<td>MouseMotionAdapter</td>
</tr>
<tr>
<td>MouseInputListener</td>
<td>MouseInputAdapter</td>
</tr>
<tr>
<td>WindowListener</td>
<td>WindowAdapter</td>
</tr>
</tbody></table>
<p>这些适配器实现了接口的全部抽象方法，只是方法内容为空</p>
<p>这样，创建新类时可以不必实现接口，而是继承适配器类，并重写需要的方法</p>
<h2 id="15-5-Java-绘图技术"><a href="#15-5-Java-绘图技术" class="headerlink" title="15.5 Java 绘图技术"></a>15.5 Java 绘图技术</h2><blockquote>
<p>Java 语言约定，显示屏上一个长方形区域为程序绘图区域，坐标原点（0, 0）位于整个区域左上角。</p>
<p>一个坐标点（x, y）对应一个像素，其中坐标点的 x、y 必须是非负整数。x 沿水平方向从左向右递增、y 沿竖直方向从上往下递增</p>
</blockquote>
<h3 id="15-5-1-颜色"><a href="#15-5-1-颜色" class="headerlink" title="15.5.1 颜色"></a><font color=#FF0000>1</font><font color=#FFC800>5.</font><font color=#F9F000>5</font><font color=#00FF00>.</font><font color=#00FFFF>1</font> <font color=#0000FF>颜</font><font color=#FF00FF>色</font></h3><blockquote>
<p>可以使用 java.awt 包中的 Color 类来定义和管理颜色。Color 类的每个对象代表一种颜色。</p>
</blockquote>
<p>Color 类有 26 个常量，代表 13 种预定义颜色：</p>
<table>
<thead>
<tr>
<th>颜色</th>
<th>对象</th>
<th>ᓚᘏᗢ</th>
</tr>
</thead>
<tbody><tr>
<td>黑色<font color=#000000>（#000000）</font></td>
<td>Color.black</td>
<td>Color.BLACK</td>
</tr>
<tr>
<td>蓝色<font color=#0000FF>（#0000FF）</font></td>
<td>Color.blue</td>
<td>Color.BLUE</td>
</tr>
<tr>
<td>青色<font color=#00FFFF>（#00FFFF）</font></td>
<td>Color.cyan</td>
<td>Color.CYAN</td>
</tr>
<tr>
<td>灰色<font color=#808080>（#808080）</font></td>
<td>Color.gray</td>
<td>Color.GRAY</td>
</tr>
<tr>
<td>深灰色<font color=#404040>（#404040）</font></td>
<td>Color.darkGary</td>
<td>Color.DARKGARY</td>
</tr>
<tr>
<td>浅灰色<font color=#C0C0C0>（#C0C0C0）</font></td>
<td>Color.lightGary</td>
<td>Color.LIGHTGARY</td>
</tr>
<tr>
<td>绿色<font color=#00FF00>（#00FF00）</font></td>
<td>Color.green</td>
<td>Color.GREEN</td>
</tr>
<tr>
<td>洋红色<font color=#FF00FF>（#FF00FF）</font></td>
<td>Color.magenta</td>
<td>Color.MAGENTA</td>
</tr>
<tr>
<td>橙色<font color=#FFC800>（#FFC800）</font></td>
<td>Color.orange</td>
<td>Color.ORANGE</td>
</tr>
<tr>
<td>粉红色<font color=#FFAFAF>（#FFAFAF）</font></td>
<td>Color.pink</td>
<td>Color.PINK</td>
</tr>
<tr>
<td>红色<font color=#FF0000>（#FF0000）</font></td>
<td>Color.red</td>
<td>Color.RED</td>
</tr>
<tr>
<td>白色<font color=#FFFFFF>（#FFFFFF）</font></td>
<td>Color.write</td>
<td>Color.WRITE</td>
</tr>
<tr>
<td>黄色<font color=#FFFF00>（#FFFF00）</font></td>
<td>Color.yellow</td>
<td>Color.YELLOW</td>
</tr>
</tbody></table>
<p>也可以通过<font color=#FF0000>红</font>、<FONT COLOR=#00FF00>绿</FONT>、<FoNt CoLoR=#0000fF>蓝</fOnT>三原色值来组合。每种颜色由三个值组成（<font color=#FF0000>R</font><font color=#00FF00>G</font><font color=#0000FF>B</font>），值的范围是 [0, 256)：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Color</span> <span class="variable">color</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Color</span>(<span class="number">102</span>, <span class="number">204</span>, <span class="number">255</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个颜色是：<font color=#66CCFF>天依蓝（#66CCFF）</font></p>
<p>这部分笔记恐怕是所有 Java 笔记里唯一有五颜六色的地方了，真难得</p>
</blockquote>
<h3 id="15-5-2-字体"><a href="#15-5-2-字体" class="headerlink" title="15.5.2 字体"></a><font face="幼圆" size="7"><i>15.5.2 字体</i></font></h3><blockquote>
<p>文字有 字体、样式、字号 三个要素</p>
</blockquote>
<p>基本的样式有：</p>
<ul>
<li><p>Font.PLAIN：正常（0）</p>
</li>
<li><p>Font.BOLD：<strong>粗体</strong>（1）</p>
</li>
<li><p>Font.ITALIC：<em>斜体</em>（2）</p>
<p>样式可以组合使用，如 (Font.BOLD + Font.ITALIC) 即 <em><strong>粗斜体</strong></em></p>
</li>
</ul>
<p>常用的字体：Times New roman<font face=Times New roman>（Times New roman）</font>、Symbol<font face=Symbol>（Symbol）</font>、宋体<font face=(宋体)>（宋体）</font>、楷体<font face=楷体>（楷体）</font>等</p>
<p><strong>构造器：</strong></p>
<ul>
<li><code>new Font(String name, int style, int size)</code>：新建字体，指定字体、样式、字号</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>String getName()</code>：返回其字体名称</p>
<p><code>int getSize()</code>：返回其字号大小</p>
<p><code>int getStyle()</code>：返回其样式</p>
</li>
<li><p><code>boolean isBold()</code>：是否是粗体</p>
<p><code>boolean isItalic()</code>、<code>boolean isPlain()</code></p>
</li>
</ul>
<h3 id="15-5-3-Graphics-类"><a href="#15-5-3-Graphics-类" class="headerlink" title="15.5.3 Graphics 类"></a>15.5.3 Graphics 类</h3><blockquote>
<p>java.awt 包下的 Graohics 类是所有图形处理的基础，是所有图形上下文的抽象父类。其允许应用程序在组件及屏幕图像上进行绘制。</p>
</blockquote>
<p>当先后绘制的图形不同时，确定重叠部分颜色的方法称为绘图模式。</p>
<p>绘图模式分为两种：</p>
<ul>
<li><p>正常模式：<code>setPaintMode()</code></p>
<p>后绘制的图形覆盖先绘制的图形。</p>
</li>
<li><p>异或模式：<code>setXORMode(Color c)</code></p>
<p>当前绘制的颜色、先前绘制的颜色 及 选定的颜色 c 之间进行某种处理后，用新的颜色绘制。</p>
<p>这个模式下，如果使用同一颜色绘制 2 次，则相当于擦除之前绘制的图形，即恢复原本状态。</p>
</li>
</ul>
<p>若要在某个组件中绘图，应重写该组件的 paint(Graphics g) 方法，并在重写的方法内进行绘图。</p>
<ul>
<li><p><code>paint(Graphics g)</code>：组件被显示出来时，调用该方法</p>
<p>以下情况该方法会被调用</p>
<ul>
<li>组件第一次在屏幕显示时</li>
<li>窗口最小化&#x2F;最大化</li>
<li>窗口大小发生变化</li>
<li><code>repaint</code> 函数被调用</li>
</ul>
</li>
<li><p><code>repaint()</code>：重绘组件</p>
<p>该方法默认情况下会调用以下方法</p>
<ul>
<li><p><code>paintCompnent(Graphics g)</code>：绘制组件</p>
<p>一般情况下，要在 JComponent 子类的组件中绘图，重写该方法即可</p>
</li>
<li><p><code>paintBorder(Graphics g)</code>：绘制组件边框</p>
</li>
<li><p><code>paintChildren(Graphics g)</code>：绘制组件的子组件</p>
</li>
</ul>
</li>
</ul>
<p><strong>设置画笔：</strong></p>
<ul>
<li><p><code>setColor(Color c)</code>：设置画笔前景色</p>
<p><code>setBackgroud(Color c)</code>：设置背景色</p>
<p>每个图形环境都有一种画图时正在使用的前景色。画图所在的每个表面都有背景色</p>
</li>
<li><p><code>setFont(Font f)</code>：设置画笔字体</p>
</li>
</ul>
<p><strong>绘制几何图案：</strong></p>
<ul>
<li><p><code>drawArc(int x, int y, int width, int height, int startAngle, int arcAngle)</code>：绘制弧线</p>
<p>该弧线是 沿着起始点为 (x, y)、宽 width、高 height 的矩形所限定的椭圆 绘制一条弧线。</p>
<p>该弧线起始角度为 startAngle，弧度角度为 arcAngle</p>
<p><code>fillArc(int x, int y, int width, int height, int startAngle, int arcAngle)</code>：填充扇形</p>
</li>
<li><p><code>drawLine(int x1, int y1, int x2, int y2)</code>：绘制线段</p>
<p>该线段的两个端点是 (x1, y1) 和 (x2, y2)</p>
</li>
<li><p><code>drawOval(int x, int y, int width, int height)</code>：绘制椭圆</p>
<p>一个起始点为 (x, y)、宽 width、高 height 的矩形所限定的椭圆</p>
<p><code>fillOval(int x, int y, int width, int height)</code>：填充椭圆</p>
</li>
<li><p><code>drawPolygon(int[] xPoints, int[] tPoints, int nPoints)</code>：绘制多边形</p>
<p><code>drawPolygon(Polygon p)</code>：也能通过传入一个 Polygon 对象来绘制多边形</p>
<p>该图形的端点由传入参数确定。如果最后一个端点和第一个端点不相等，那么图形可能不闭合</p>
<p><code>fillPolygon(int[] xPoints, int[] tPoints, int nPoints)</code>：填充多边形</p>
<p><code>fillPolygon(Polygon p)</code>：通过传入一个 Polygon 对象来填充多边形</p>
<p>低情商：这咋填充？高情商：留给读者们思考吧</p>
</li>
<li><p><code>drawRect(int x, int y, int width, int height)</code>：绘制矩形</p>
<p>一个起始点为 (x, y)、宽 width、高 height 的矩形</p>
<p><code>fillRect(int x, int y, int width, int height)</code>：填充矩形</p>
</li>
<li><p><code>drawRoundRect(int x, int y, int width, int height, int arcWidth, int arcHeight)</code>：圆角矩形</p>
<p>一个起始点为 (x, y)、宽 width、高 height 的矩形，其圆角形状由 arcWidth、arcHeight 确定</p>
<p>其实就是矩形（线段）和椭圆（圆弧）的某种拼接</p>
<p><code>fillRoundRect(int x, int y, int width, int height, int arcWidth, int arcHeight)</code>：填充圆角矩形</p>
</li>
<li><p><code>drawString(String str, int x, int y)</code>：输出字符串</p>
<p>在 (x, y) 处输出字符串 str，向右扩展</p>
<p><code>drawChars(char[] chars, int offSet, int length, int x, int y)</code>：输出字符串</p>
<p>从字符数组的 offSet 下标处起，在 (x, y) 处输出 length 个字符，向右扩展</p>
<p><code>drawBytes(byte[] data, int offSet, int length, int x, int y)</code>：还不是一样？</p>
</li>
<li><p><code>draw3DRect(int x, int y, int width, int height, boolean raised)</code>：绘制 3D 矩形</p>
<p><code>fill3DRect(int x, int y, int width, int height, boolean raised)</code>：填充 3D 矩形</p>
<p>我感觉是和 PS 里的浮雕效果类似，生成了亮部和暗部。rasied 决定是凸起还是凹陷。</p>
</li>
</ul>
<h4 id="15-5-3-1-Polygon-类"><a href="#15-5-3-1-Polygon-类" class="headerlink" title="15.5.3.1 Polygon 类"></a>15.5.3.1 Polygon 类</h4><blockquote>
<p>Polygon 对象封装了多边形的坐标。</p>
</blockquote>
<p>构造方法：</p>
<ul>
<li><p><code>new Polygon()</code>：构造一个空的多边形。</p>
<p>无为太虚，无生一，一生二，二生三，三生万物。所以，空的多边形也是多边形。</p>
</li>
<li><p><code>new Polygon(int[] xs, int[] ys, int n)</code>：构造一个 n 点连接成的多边形</p>
</li>
</ul>
<p>常用方法：</p>
<ul>
<li><p><code>addPoint(int x, int y)</code>：将该点加入多边形中</p>
</li>
<li><p><code>boolean contains(int x, int y)</code>：如果多边形包含该点，则返回真</p>
<p><code>boolean contains(Point p)</code></p>
</li>
<li><p><code>get Bounds()</code>：得到多边形的外接矩形</p>
</li>
<li><p><code>translate(int dx, int dy)</code>：偏移</p>
<p>将多边形各点沿 x 轴偏移 dx，再沿 y 轴偏移 dy</p>
</li>
</ul>
<h3 id="15-5-4-Graphics2D-类"><a href="#15-5-4-Graphics2D-类" class="headerlink" title="15.5.4 Graphics2D 类"></a>15.5.4 Graphics2D 类</h3><blockquote>
<p>为了解决图形对象的局限性，Java 1.1 后 引入了 Java 2D，其包含一个继承自 Graphics 的 Graphics2D 类，增加了很多状态属性，扩展了 Java 的绘图功能</p>
<p>Graphics2D 拥有强大的二维图形处理能力，提供对几何形状、坐标转换、颜色管理、文字布局等更复杂的控制</p>
</blockquote>
<h4 id="15-5-4-1-图形状态属性"><a href="#15-5-4-1-图形状态属性" class="headerlink" title="15.5.4.1 图形状态属性"></a>15.5.4.1 图形状态属性</h4><blockquote>
<p>通过设定和修改属性，可以指定画笔宽度和画笔连接方式、设定平移、旋转、缩放或裁剪变换图形，还能设置填充图形的颜色和图案等。</p>
</blockquote>
<p><strong>状态属性：</strong></p>
<ul>
<li><p><strong>stroke 属性：</strong></p>
<p>该属性控制线宽、笔形样式、线段连接方式、短划线图案。</p>
<p>使用 <code>setStroke(Stroke s)</code> 方法设置 stroke 属性。</p>
<p>构造方法：</p>
<ul>
<li><p><code>new BasicStroke(float w)</code>：指定线宽的 stroke</p>
</li>
<li><p><code>new BasicStroke(float w, int cap, int join)</code>：指定线宽、端点样式 cap、线段交汇方式 join 的 stroke</p>
<p>其中，端点样式 cap 的值可以是：</p>
<ul>
<li>BasicStroke.CAP_BUTT：无修饰（0）</li>
<li>BasicStroke.CAP_ROUND：半圆形末端（1）</li>
<li>BasicStroke.CAP_SQUARE：方形末端（2，默认值）</li>
</ul>
<p>线段交汇方式 join 的值可以是：</p>
<ul>
<li>BasicStroke.JOIN_BEVEL：无修饰（2）</li>
<li>BasicStroke.JOIN_MITER：尖型末端（0，默认值）</li>
<li>BasicStroke.JOIN_ROUND：圆形末端（1）</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>paint 属性：</strong></p>
<p>该属性控制填充效果。</p>
<p>使用 <code>setPaint(Paint p)</code> 方法设置 paint 属性</p>
<p>构造方法：</p>
<ul>
<li><p><code>new GradientPaint(float x1, float y1, Color c1, float x2, float y2, Color c2)</code>：构造一个简单的非周期性的 paint 对象。</p>
<p>从点 (x1, y1) 至点 (x2, y2) 处，颜色由 c1 渐变至 c2</p>
</li>
<li><p><code>new GradientPaint(float x1, float y1, Color c1, float x2, float y2, Color c2, boolean cyclic)</code>：构造一个周期或非周期性的 paint 对象。</p>
<p>如果希望渐变至终点又是起点的颜色，将 cyclic 设定为 true</p>
</li>
</ul>
</li>
<li><p><strong>transform 属性：</strong></p>
<p>该属性用来实现常用的图形平移、缩放、斜切等</p>
<p>使用 <code>setTransform(Transform t)</code> 方法设置 transform 属性</p>
<p>构造方法：</p>
<ul>
<li><p><code>new AffineTransform()</code>：构造一个表示仿射变换的新的 tansform</p>
<p><em>仿射变换：用我的话来讲，就是保持坐标点不变的情况下变换坐标系，能形成的变换</em></p>
</li>
</ul>
<p>常用方法：</p>
<ul>
<li><p><code>setToRotation(double theta)</code>：旋转 theta 角度</p>
<p><code>setToRotation(double theta, double x, double y)</code>：以 (x, y) 为旋转中心旋转</p>
<p><code>rotate(double theta, double x, double y)</code></p>
</li>
<li><p><code>setToScale(double sx, double sy)</code>：拉伸变换</p>
<p>x、y 方向按照 sx、yx 比例变换</p>
<p><code>scale(double sx, double sy)</code></p>
</li>
<li><p><code>setToTranslation(double tx, double ty)</code>：平移变换</p>
<p><code>translate(double tx, double ty)</code></p>
</li>
<li><p><code>setToShear(double shx, double shy)</code>：斜切变换</p>
<p>shx、shy 分别指定 x、y 方向的斜拉度</p>
</li>
</ul>
<p>看得出来，出版社的人写到这里应该是到了下班的点了。内容不明不白的不说，还写错了好几处。</p>
<p>我笔记上是改过来的。放心。</p>
<p>就这还 ”指定教材“ 呢。垃圾，还没我笔记写得好。</p>
</li>
<li><p><strong>clip 属性：</strong></p>
<p>该属性用于实现剪裁效果。</p>
<p>使用 <code>setClip(Shape clip)</code>  方法，确定裁剪区域的 Shape。可以连续使用该方法以得到其交集区域</p>
</li>
<li><p><strong>composit 属性：</strong></p>
<p>该属性设置图形重叠区域的效果</p>
<p>通过 <code>Alpha.Composite.getInstance(int rule, float alpha)</code> 得到一个实例。其中 alpha（透明度）的范围是 [0.0f, 1.0f]</p>
<p>至于 rule 是什么……我也不知道。或许不重要吧</p>
<p>通过 <code>setComposite(Composite comp)</code> 设置混合效果</p>
</li>
</ul>
<h4 id="15-5-4-2-Graphics2D-的绘图方法"><a href="#15-5-4-2-Graphics2D-的绘图方法" class="headerlink" title="15.5.4.2 Graphics2D 的绘图方法"></a>15.5.4.2 Graphics2D 的绘图方法</h4><blockquote>
<p>Graphics2D 保留了 Graphics 的绘图方法，又增加了很多新方法</p>
<p>另外，在 java.awt.geom 中声明了一系列类，能用于创建各种几何图形对象，包括：Line2D 线段类、Rectangle2D 矩形类、RoundRectangle2D 圆角矩形类、Ellipse2D 椭圆类、Arc2D 圆弧类、QuadCurve2D 二次曲线类、CubicCurve2D 三次曲线类</p>
<p>这些类都是抽象类，但这些类包中有实现了其方法的 Double 类。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="meta">@OverRide</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paintComponents</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">    <span class="type">Graphics2D</span> <span class="variable">g2d</span> <span class="operator">=</span> (Graphics2D)g;						<span class="comment">//[1]</span></span><br><span class="line">    <span class="type">Line2D</span> <span class="variable">line</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Line2D</span>.Double(<span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>);		<span class="comment">//[2]</span></span><br><span class="line">    g2d.draw(line);										<span class="comment">//[3]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><p>将 Graphics 对象强制转型为 Graphics2D 对象</p>
</li>
<li><p>创建几何图形对象</p>
<p>这里的 Line2D.Double 表示 Line2D 包下的 Double 类。此处调用了 Double 类的构造器</p>
</li>
<li><p>绘制线段</p>
</li>
</ol>
</blockquote>
<h4 id="15-5-4-3-Graphics2D-中的几何图形类"><a href="#15-5-4-3-Graphics2D-中的几何图形类" class="headerlink" title="15.5.4.3 Graphics2D 中的几何图形类"></a>15.5.4.3 Graphics2D 中的几何图形类</h4><ul>
<li><p><code>new Line2D.Double(int x1, int y1, int x2, int y2)</code>：线段</p>
<p>从 (x1, y1) 到 (x2, y2) 的线段</p>
</li>
<li><p>……（略了略了。相信椭圆、矩形之类的也不用再详细说明了吧）</p>
</li>
<li><p><code>new Arc2D.Double(double x, double y, double w, double h, double start, double extent, int type)</code>：弧</p>
<p>但是特别地，type 的值是以下几种：</p>
<ul>
<li>Arc2D.OPEN：开弧</li>
<li>Arc2D.CHORD：弓弧</li>
<li>Arc2D.PIE：饼弧</li>
</ul>
</li>
<li><p><code>new QuadCurver2D.Double(double x1, double y1, double ctrlx, double ctrly, double x2, double y2)</code>：绘制二次曲线</p>
<p>绘制二次曲线需要 3 个点，分别是起始点 (x1, y1)、终点 (x2, y2)、控制点 (ctrlx, ctrly)</p>
</li>
<li><p><code>new CubicCurve2D.Double(double x1, double y1, double ctrlx1, double ctrly1, double ctrlx2, double ctrly2, double x2, double y2)</code>：绘制三次曲线</p>
<p>绘制三次曲线需要 4 个点，分别是起始点、终点、两个控制点</p>
</li>
</ul>
<h2 id="15-6-组合框与列表"><a href="#15-6-组合框与列表" class="headerlink" title="15.6 组合框与列表"></a>15.6 组合框与列表</h2><h3 id="15-6-1-JComboBox-组合框"><a href="#15-6-1-JComboBox-组合框" class="headerlink" title="15.6.1 JComboBox 组合框"></a>15.6.1 JComboBox 组合框</h3><blockquote>
<p>JComboBox 是一个下拉式菜单。它有两种模式：可编辑的、不可编辑的。</p>
<p>对于不可编辑的 JComboBox，用户只能在现有列表中进行选择</p>
<p>对于可编辑的 JComboBox，用户既能在现有选项中选择，也能输入新的内容</p>
</blockquote>
<p><strong>构造方法：</strong></p>
<ul>
<li><p><code>new JComboBox&lt;E&gt;()</code>：创建一个 E 类型（泛型）的没有任何可选项的默认组合框</p>
</li>
<li><p><code>new JComboBox&lt;E&gt;(E[] items)</code>：根据 items 数组创建组合框</p>
<p>items 数组元素即为组合框的可选项</p>
</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>void setEditable(boolean aFlag)</code>：设置可编辑性</p>
<p>不设置的场合，默认处于不可编辑状态</p>
</li>
<li><p><code>void addItem(E item)</code>：在末尾添加可选项</p>
<p><code>void insertItemAt(E item, int index)</code>：在指定下标处添加可选项</p>
</li>
<li><p><code>void removeAllItems()</code>：删除所有可选项</p>
<p><code>void removeItem(E iten)</code>：删除 item 指定的可选项</p>
<p><code>void removeItemAt(int index)</code>：删除指定下标处的可选项</p>
</li>
<li><p><code>E getItemAt(int index)</code>：获取指定下标的可选项</p>
</li>
<li><p><code>int getItemCount()</code>：获取列表项数</p>
</li>
<li><p><code>int getSelectedIndex()</code>：获取选中项匹配的第一个选项的索引下标</p>
<p><code>E getSelectedItem()</code>：获取选中项</p>
</li>
</ul>
<h3 id="15-6-2-JList-列表"><a href="#15-6-2-JList-列表" class="headerlink" title="15.6.2 JList 列表"></a>15.6.2 JList 列表</h3><blockquote>
<p>JList 是可供用户选择的一系列可选项</p>
</blockquote>
<p><strong>构造方法：</strong></p>
<ul>
<li><code>new JList&lt;E&gt;()</code>：构造一个空列表</li>
<li><code>new JList&lt;E&gt;(E[] listData)</code>：构造一个列表，可选元素由 listData 指定</li>
<li><code>new JList&lt;E&gt;(Vector&lt;E&gt; listData)</code>：构造一个列表，使其显示指定 Vector 中的元素</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>addListSelectionListener(ListSelectionListener l)</code>：添加监视器</p>
<p>当用户在列表上选择时，会触发 ListSelectionEvent 事件。</p>
<p>在 ListSelectionListener 接口中，仅有一个方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">valueChanged</span><span class="params">(ListSelectionEvent e)</span>;</span><br></pre></td></tr></table></figure>

<p>当列表的当前选项改变时，会调用该方法。</p>
</li>
<li><p><code>int getSelectedIndex()</code>：返回选中项第一次出现的下标索引</p>
<p>没有选中项的场合，返回 -1</p>
<p><code>E getSelectedValue()</code>：返回所选的第一个值</p>
<p>没有选中项的场合，返回 null</p>
</li>
<li><p><code>void setVisableRowCount(int count)</code>：设置不使用滚动条可以在列表中显示的选项行数</p>
</li>
<li><p><code>void setSelectionMode(int mode)</code>：设置列表的选择模式</p>
<p>其中，mode 的值可以是以下几种：</p>
<ul>
<li>ListSelectionModel.SINGLE_SELECTION：仅支持单项选择（0）</li>
<li>ListSelectionModel.SINGLE_INTERVAL_SELECTION：可多选，但多个选项必须是连续的（1）</li>
<li>ListSelectionModel.MULTIPLE_INTERVAL_SELECTION：可多选（2，默认值）</li>
</ul>
</li>
</ul>
<h2 id="15-7-文本组件"><a href="#15-7-文本组件" class="headerlink" title="15.7 文本组件"></a>15.7 文本组件</h2><blockquote>
<p>文本组件可以提示信息和提供用户输入功能。Swing 中提供了 JTextField（文本域）、JPasswordField（口令输入域）、JTextArea（文本区）等多个文本组件。</p>
</blockquote>
<p>文本组件的共同的父类是 JTextComponent，其中定义了文本组件的共有方法：</p>
<ul>
<li><p><code>String getSelectedText()</code>：从文本组件中提取被选中的文本内容</p>
</li>
<li><p><code>String getText()</code>：从文本组件中提取全部文本内容</p>
<p><code>String getText(int offs, int len)</code>：从文本组件中提取指定范围的文本内容</p>
</li>
<li><p><code>void select(inr start, int end)</code>：在文本组件中选中指定范围内容</p>
<p><code>void selectAll()</code>：在文本组件中选中全部内容</p>
</li>
<li><p><code>void setEditable(boolean b)</code>：设置可编辑状态</p>
</li>
<li><p><code>void setText(String t)</code>：设置文本组件的文本内容</p>
</li>
<li><p><code>void setDocument(Document doc)</code>：设置文本组件的文档</p>
</li>
<li><p><code>void copy()</code>：复制选中文本至剪贴板</p>
<p><code>void cut()</code>：剪切选中文本至剪贴板</p>
<p><code>void paste()</code>：粘贴剪贴板内容至当前位置</p>
</li>
</ul>
<p>另外，JComponrnt 类中有如下方法：</p>
<ul>
<li><code>boolean requestFocusInWindow()</code>：请求当前组件获得输入焦点</li>
</ul>
<h3 id="15-7-1-JTextField-文本域"><a href="#15-7-1-JTextField-文本域" class="headerlink" title="15.7.1 JTextField 文本域"></a>15.7.1 JTextField 文本域</h3><blockquote>
<p>文本域是一个单行的文本输入框，可以用于输入少量文本</p>
</blockquote>
<p><strong>构造方法：</strong></p>
<ul>
<li><p><code>new JTextField()</code>：构造一个空文本域</p>
</li>
<li><p><code>new JTextField(int columns)</code>：构造一个指定列数的空文本域</p>
<p>由于组件大小通常由布局管理器确定，因此指定的列数可能被忽略</p>
</li>
<li><p><code>new JTextField(String text)</code>：构造一个显示指定初始字符的文本域</p>
</li>
<li><p><code>new JTextField(String text, int columns)</code>：构造一个指定列数及初始字符的文本域</p>
</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>void addActionListener(ActionListener l)</code>：添加指定侦听器</p>
<p><code>void removeActionListener(ActionListener l)</code>：移除指定侦听器</p>
</li>
<li><p><code>void setFont()</code>：设置当前字体</p>
</li>
<li><p><code>void setHorizontalAlignment(int alignment)</code>：设置水平对齐方式</p>
<p>有效值包括：</p>
<ul>
<li><p>JTextField.LEFT：左对齐（2）</p>
</li>
<li><p>JTextField.RIGHT：右对齐（4）</p>
</li>
<li><p>JTextField.CENTER：居中对齐（0）</p>
</li>
<li><p>JTextField.LEADING：领先对齐（10）</p>
<p>（似乎是）识别文字前端的对齐方式……好吧，我也不太明白</p>
</li>
<li><p>JTextField.TRAILING：落后对齐（11）</p>
</li>
</ul>
</li>
<li><p><code>int getColumns()</code>：返回文本域列数</p>
</li>
</ul>
<h3 id="15-7-2-JTextArea-文本区"><a href="#15-7-2-JTextArea-文本区" class="headerlink" title="15.7.2 JTextArea 文本区"></a>15.7.2 JTextArea 文本区</h3><blockquote>
<p>JTextArea 是一个多行多列的文本输入框</p>
</blockquote>
<p><strong>构造方法：</strong></p>
<ul>
<li><code>new JTextArea()</code>：构造一个空文本区</li>
<li><code>new JTextArea(int rows, int columns)</code>：构造一个指定行数、列数数的空文本区</li>
<li><code>new JTextArea(String text)</code>：构造一个显示指定初始字符的文本区</li>
<li><code>new JTextArea(String text, int rows, int columns)</code>：构造一个指定行列数及初始字符的文本区</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>void append(String str)</code>：追加文本到文本区</p>
</li>
<li><p><code>void insert(String str, int pos)</code>：将指定文本插入到特定位置 pos 处</p>
</li>
<li><p><code>void replaceRange(String str, int start, int end)</code>：用指定文本 str 替换指定范围的文本</p>
</li>
<li><p><code>void addAncestorListener(AncestorListener listener)</code>：添加指定侦听器</p>
<p>特别地，用户输入文本时，按下 Enter 键的场合只是向缓冲区输入一个字符，而不能表示输入的结束。因此，需要识别用户输入完成时，通常要在文本区旁放置一个确定按钮</p>
</li>
</ul>
<h2 id="15-8-菜单组件"><a href="#15-8-菜单组件" class="headerlink" title="15.8 菜单组件"></a>15.8 菜单组件</h2><blockquote>
<p>菜单是最常用的 GUI 组件之一。Swing 包中提供了多种菜单组件。</p>
<p>菜单有下拉式菜单和弹出式菜单两种</p>
</blockquote>
<h3 id="15-8-1-菜单栏及菜单"><a href="#15-8-1-菜单栏及菜单" class="headerlink" title="15.8.1 菜单栏及菜单"></a>15.8.1 菜单栏及菜单</h3><blockquote>
<p>JMenuBar 菜单栏是窗口主菜单，用来包容一组菜单</p>
<p>通过容器的 <code>setJMenuBar(JMenuBar m)</code> 方法将菜单栏放到窗口上</p>
</blockquote>
<p><strong>菜单栏 JMenuBar 构造方法：</strong></p>
<ul>
<li><code>new JMenuBar()</code>：构建一个新的菜单栏</li>
</ul>
<p>菜单栏也能注册一些事件侦听程序，但通常情况下对于这些事件我们都不进行处理</p>
<p><strong>菜单构造方法：</strong></p>
<ul>
<li><code>new JMenu()</code>：构造没有文本的新菜单</li>
<li><code>new JMenu(String str)</code>：构造有指定标签的菜单</li>
<li><code>new JMenu(String str, boolean b)</code>：构造有指定标签的菜单，并指示其是否可以被分离</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>add(JMenu m)</code>：菜单可以被加入菜单栏或另一个菜单中</p>
</li>
<li><p><code>addSeparator()</code>：为菜单各项间加入间隔线</p>
<p><code>insertSeparator(int index)</code>：在指定位置插入间隔线</p>
<p>也能通过这种方式插入间隔线：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">menu.add(<span class="keyword">new</span> <span class="title class_">JSeparator</span>());				<span class="comment">//JSeparator 类即分割线类</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="15-8-2-JMenuItem-菜单项"><a href="#15-8-2-JMenuItem-菜单项" class="headerlink" title="15.8.2 JMenuItem 菜单项"></a>15.8.2 JMenuItem 菜单项</h3><blockquote>
<p>JMenuItem 菜单项是菜单系统的最下一级</p>
</blockquote>
<p><strong>构造方法：</strong></p>
<ul>
<li><p><code>new JMenuItem()</code>：创建不带有设置文本或图标的菜单项</p>
</li>
<li><p><code>new JMenuItem(Icon i)</code>：创建只有图标的菜单项</p>
</li>
<li><p><code>new JMenuItem(String str)</code>：创建只有文本的菜单项</p>
</li>
<li><p><code>new JMenuItem(String str, Icon i)</code>：创建有图标和文本的菜单项</p>
</li>
<li><p><code>new JMenuItem(String str, int mnemonic)</code>：创建有文本和快捷键的菜单项</p>
<p>那个快捷键的有效值是 KeyEvent 包下的各种常量</p>
</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>setMnemonic(int m)</code>：设置快捷键</p>
</li>
<li><p><code>setAccelerator(KeyStroke keyStroke)</code>：设置加速键</p>
</li>
<li><p><code>addActionListener(ActionListener l)</code>：加入侦听器</p>
<p>菜单项被选中时，会触发 ActionEvent 事件</p>
</li>
</ul>
<h3 id="15-8-3-复选菜单项和单选菜单项"><a href="#15-8-3-复选菜单项和单选菜单项" class="headerlink" title="15.8.3 复选菜单项和单选菜单项"></a>15.8.3 复选菜单项和单选菜单项</h3><blockquote>
<p>JCheckBoxMenuItem（复选菜单项）和 JRadioButtonMenuItem（单选菜单项）是两种特殊的菜单项。</p>
<p>JCheckBoxMenuItem 前有个小方框，以供提示复选</p>
<p>JRadioButtonMenuItem 前有个小圆圈，以供提示单选</p>
</blockquote>
<p><strong>复选菜单项构造器：</strong></p>
<ul>
<li><code>new JCheckBoxMenuItem()</code>：一个无文本图标，初始未选中的菜单项</li>
<li><code>new JCheckBoxMenuItem(Icon i)</code>：就是有图标咯</li>
<li><code>new JCheckBoxMenuItem(String str)</code>：就是有文本咯</li>
<li><code>new JCheckBoxMenuItem(String str, boolean b)</code>：就是有文本，又指定初始状态咯</li>
<li><code>new JCheckBoxMenuItem(String str, Icon i)</code>：就是有文本，又有图标咯</li>
<li><code>new JCheckBoxMenuItem(String str, Icon i, boolean b)</code>：你猜呗</li>
</ul>
<p><strong>单选菜单项构造器：</strong></p>
<p>单选菜单项是 JRadioButtonMenuItem，剩下的都和上面的一样</p>
<h2 id="15-9-对话框"><a href="#15-9-对话框" class="headerlink" title="15.9 对话框"></a>15.9 对话框</h2><blockquote>
<p>对话框是一个临时的可移动窗口，其依赖于其他窗口。当期依赖的窗口消失或最小化时，对话框消失。窗口还原时对话框恢复。</p>
<p>对话框分为强制型和非强制型。强制型对话框在关闭前，其他窗口不能接收任何形式的输入。也就是说，该对话过程不能中断。强制型对话框也被称为模式窗口。</p>
</blockquote>
<h3 id="15-9-1-JDialog-自定义对话框"><a href="#15-9-1-JDialog-自定义对话框" class="headerlink" title="15.9.1 JDialog 自定义对话框"></a>15.9.1 JDialog 自定义对话框</h3><p><strong>构造方法：</strong></p>
<ul>
<li><p><code>new JDialog(Dialog owner)</code>：无标题无模式对话框。指定对话框为其所有者</p>
<p><code>new JDialog(Frame owner)</code>：指定框架为其所有者</p>
</li>
<li><p><code>new JDialog(Dialog owner, boolean model)</code>：无标题对话框，指定所有者并指示是否为有模式</p>
</li>
<li><p><code>new JDialog(Dialog owner, String title)</code></p>
<p><code>new JDialog(Frame owner, String title)</code></p>
<p><code>new JDialog(Dialog owner, String title, boolean model)</code></p>
<p><code>new JDialog(Frame owner, String title, boolean model)</code>：这些你都懂的吧</p>
</li>
</ul>
<h3 id="15-9-2-JOptionalPane-标准对话框"><a href="#15-9-2-JOptionalPane-标准对话框" class="headerlink" title="15.9.2 JOptionalPane 标准对话框"></a>15.9.2 JOptionalPane 标准对话框</h3><blockquote>
<p>JDialog 通常用于创建自定义对话框。此外，还有用于显示标准对话框的 JOptionalPane 类</p>
</blockquote>
<p>JOptionalPane 定义了多个<strong>静态方法</strong>，分为以下 4 个类型：</p>
<ul>
<li><p><strong>showConfirmDialog</strong>：确认对话框。显示问题，要求用户进行确认（yes &#x2F; no &#x2F; cancel）</p>
<p>其同名方法有以下 3 种</p>
<ul>
<li><p>int showConfirmDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>)</p>
</li>
<li><p>int showConfirmDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#EAA0FF>String title</font>, <font color=#00AAFF>int optionType</font>)</p>
</li>
<li><p>int showConfirmDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#EAA0FF>String title</font>, <font color=#00AAFF>int optionType</font>, <font color=#E0AA00>int messageType</font>)</p>
</li>
</ul>
</li>
<li><p><strong>showInputDialog</strong>：输入对话框。提示用户进行输入</p>
<p>同名方法有以下 6 种：</p>
<ul>
<li><p>showInputDialog(<font color=#00E040>Object message</font>)</p>
</li>
<li><p>showInputDialog(<font color=#00E040>Object message</font>, <font color=#0000AE>Object initialValue</font>)</p>
</li>
<li><p>showInputDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>)</p>
</li>
<li><p>showInputDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#0000AE>Object initialValue</font>)</p>
</li>
<li><p>showInputDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#EAA0FF>String title</font>, <font color=#E0AA00>int messageType</font>)</p>
</li>
<li><p>showInputDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#EAA0FF>String title</font>, <font color=#E0AA00>int messageType</font>, Icon icon, <font color=#0FF0AE>Object[] options</font>, <font color=#0000AE>Object initialValue</font>)</p>
</li>
</ul>
</li>
<li><p><strong>showMessageDialog</strong>：信息对话框。显示信息</p>
<p>同名方法有以下 3 种：</p>
<ul>
<li><p>showMessageDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>)</p>
</li>
<li><p>showMessageDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#EAA0FF>String title</font>, <font color=#E0AA00>int messageType</font>)</p>
</li>
<li><p>showMessageDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#EAA0FF>String title</font>, <font color=#E0AA00>int messageType</font>, Icon icon)</p>
</li>
</ul>
</li>
<li><p><strong>showOptionDialog</strong>：选项对话框，显示选项，要求用户进行选择</p>
<p>其只有 1 种同名方法</p>
<ul>
<li>showOptionDialog(<font color=#FF4040>Component parentComponent</font>, <font color=#00E040>Object message</font>, <font color=#EAA0FF>String title</font>, <font color=#00AAFF>int optionType</font>, <font color=#E0AA00>int messageType</font>, Icon icon, <font color=#0FF0AE>Object[] options</font>, <font color=#0000AE>Object initialValue</font>)</li>
</ul>
</li>
</ul>
<p>以上各个方法的参数分别是：</p>
<ul>
<li><p><font color=#FF4040>Component parentComponent</font>：对话框的父窗口对象。其父窗口位置决定了对话框位置</p>
<p>该值可以是 null，表示用默认的 Frame 作为父窗口。这个场合，对话框位置在屏幕正中</p>
</li>
<li><p><font color=#00E040>Object message</font>：显示在对话框的描述信息。</p>
<p>该参数通常是 String 对象，但也能是一个图标、组件或对象数组</p>
</li>
<li><p><font color=#EAA0FF>String title</font>：对话框标题</p>
</li>
<li><p><font color=#00AAFF>int optionType</font>：对话框上的按钮类型。可以是以下常量：</p>
<ul>
<li>JOptionalPane.DEFAULT_OPTION：默认（-1）</li>
<li>JOptionalPane.YES_NO_OPTION：一组 yes &#x2F; no（0）</li>
<li>JOptionalPane.YES_NO_CANCEL_OPTION：一组 yes &#x2F; no &#x2F; cancel（1）</li>
<li>JOptionalPane.OK_CANCEL_OPTION：一组 ok &#x2F; cancel（2）</li>
</ul>
<p>此外，也能通过 <font color=#0FF0AE>Object[] options</font> 参数指定其他形式</p>
</li>
<li><p><font color=#0FF0AE>Object[] options</font>：对话框上的选项。</p>
<p>在输入对话框中，通常以组合框架形式显示。在选项对话框中，则是指按钮类型。</p>
<p>该参数通常是一个 String[] 数组，但也能是图标数组或组件数组</p>
</li>
<li><p><font color=#E0AA00>int messageType</font>：对话框传递的信息类型。可以是以下常量：</p>
<ul>
<li>JOptionalPane.ERROR_MESSAGE：错误信息（0）</li>
<li>JOptionalPane.INFORMATION_MESSAGE：普通信息（1）</li>
<li>JOptionalPane.WARNING_MESSAGE：警告信息（2）</li>
<li>JOptionalPane.QUESTION_MESSAGE：提问信息（3）</li>
<li>JOptionalPane.PLAIN_MESSAGE：无格式信息（-1）</li>
</ul>
<p>除 PLAIN_MESSAGE 外，每种类型对应于一个默认的图标</p>
</li>
<li><p><font color=#0000AE>Object initialValue</font>：初始选项或输入值</p>
</li>
</ul>
<h3 id="15-9-3-JFileChooser-文件对话框"><a href="#15-9-3-JFileChooser-文件对话框" class="headerlink" title="15.9.3 JFileChooser 文件对话框"></a>15.9.3 JFileChooser 文件对话框</h3><blockquote>
<p>JFileChooser 文件对话框是专门用于对文件或目录进行浏览和选择的对话框</p>
</blockquote>
<p><strong>构造方法：</strong></p>
<ul>
<li><code>new JFileChooser()</code>：构造一个指向客户默认目录的文件对话框</li>
<li><code>new JFileChooser(File currentDirectory)</code>：指向指定目录的文件对话框</li>
<li><code>new JFileChooser(String path)</code>：指向指定目录的文件对话框</li>
</ul>
<p><strong>常用方法：</strong></p>
<ul>
<li><p><code>showOpenDialog(Component parent)</code>：弹出一个 “打开” 文件对话框</p>
<p>parent 是对话框的父窗口对象。其父窗口位置决定了对话框位置</p>
<p>该值可以是 null，表示用默认的 Frame 作为父窗口。这个场合，对话框位置在屏幕正中</p>
<p><code>showSaveDialog(Component parent)</code>：弹出一个 “保存” 文件对话框</p>
</li>
<li><p><code>getSelectedFile()</code>：获得用户选择的文件</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/" data-id="claq4namp000fp4tf2k5u5prm" data-title="&lt;Java&gt;15 图形界面设计" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-27 Java 8 新特性" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/" class="article-date">
  <time class="dt-published" datetime="2022-03-08T16:00:00.000Z" itemprop="datePublished">2022-03-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/">&lt;Java&gt;27 Java 8 新特性</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="27-Java-8-新特性"><a href="#27-Java-8-新特性" class="headerlink" title="27 Java 8 新特性"></a>27 Java 8 新特性</h1><blockquote>
<p>Java 8 是 Java 语言开发的一个主要版本，其为 Java 带来了大量新特性</p>
</blockquote>
<h2 id="27-1-Lambda-表达式"><a href="#27-1-Lambda-表达式" class="headerlink" title="27.1 Lambda 表达式"></a>27.1 Lambda 表达式</h2><blockquote>
<p>Lambda 是一个匿名函数，可以理解为一段可传递的代码。使用它可以写出更简洁、更灵活的代码。作为一种更紧凑的代码风格，使 Java 语言的表达能力得到了提升。</p>
<p>（Java 中）Lambda 的本质：作为函数式接口的实例</p>
</blockquote>
<p>原代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Integer&gt; comp = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Integer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Integer o1, Integer o2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(o1, o2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">System.out.println(comp.compare(<span class="number">11</span>, <span class="number">10</span>));</span><br></pre></td></tr></table></figure>

<p>使用 Lambda 表达式重写的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Integer&gt; comp = (o1, o2) -&gt; Integer.compare(o1, o2);</span><br><span class="line">System.out.println(comp.compare(<span class="number">11</span>, <span class="number">10</span>));</span><br></pre></td></tr></table></figure>

<p>通过 方法引用 进一步改写代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Integer&gt; comp = Integer::compare;</span><br><span class="line">System.out.println(comp.compare(<span class="number">11</span>, <span class="number">10</span>));</span><br></pre></td></tr></table></figure>

<h3 id="27-1-1-Lambda-表达式的使用"><a href="#27-1-1-Lambda-表达式的使用" class="headerlink" title="27.1.1 Lambda 表达式的使用"></a>27.1.1 Lambda 表达式的使用</h3><blockquote>
<p>Lambda 表达式：在 Java 8 语言中引入的一种新的语法元素和操作符。这个操作符 <code>-&gt;</code> 被称为 Lambda 操作符（箭头操作符）。它将 Lambda 分为两部分：</p>
<p>左侧：Lambda 形参列表。可以进行类型推断的场合，能省略参数类型；参数唯一的场合，能省略小括号。</p>
<p>右侧：Lambda 体。只有一条语句的场合，能省略大括号和 <code>return</code>。</p>
</blockquote>
<ol>
<li><p>无参，无返回值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Runnable</span> <span class="variable">r1</span> <span class="operator">=</span> () -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;格式一&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>有参，无返回值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;String&gt; con = (String str) -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;格式二&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>有参，无返回值。但参数的数据类型可由编译器推断得出，即 “类型推断”：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;String&gt; con = (str) -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;格式三&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>有参，无返回值。但只需要一个参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;String&gt; con = str -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;格式四&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>多个参数，多条执行语句，可以有返回值：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Integer&gt; comp = (o1, o2) -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;格式五&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> Integer.compare(o1, o2);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>只有一条执行语句时，<code>&#123; &#125;</code> 和  <code>return</code> 都能省略：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Integer&gt; comp = (o1, o2) -&gt; Integer.compare(o1, o2);</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="27-2-函数式接口"><a href="#27-2-函数式接口" class="headerlink" title="27.2 函数式接口"></a>27.2 函数式接口</h2><blockquote>
<p>一个接口中只声明了一个抽象方法，这种接口就被称为函数式接口</p>
<p>可以在一个接口上使用 <code>@FunctionalInterface</code> 注解，以检查其是否是一个函数式接口。</p>
</blockquote>
<h3 id="27-2-1-Java-内置的函数式接口"><a href="#27-2-1-Java-内置的函数式接口" class="headerlink" title="27.2.1 Java 内置的函数式接口"></a>27.2.1 Java 内置的函数式接口</h3><p><strong>常用的四个函数式接口：</strong></p>
<table>
<thead>
<tr>
<th>函数式接口</th>
<th>参数类型</th>
<th>返回类型</th>
<th>用途</th>
<th>抽象方法</th>
</tr>
</thead>
<tbody><tr>
<td><code>Consumer&lt;T&gt;</code>：消费型接口</td>
<td>T</td>
<td>void</td>
<td>对类型 T 的对象进行操作</td>
<td><code>void accept(T t)</code></td>
</tr>
<tr>
<td><code>Supplier&lt;T&gt;</code>：供给型接口</td>
<td>无</td>
<td>T</td>
<td>返回类型 T 的对象</td>
<td><code>T get()</code></td>
</tr>
<tr>
<td><code>Function&lt;T, R&gt;</code>：函数型接口</td>
<td>T</td>
<td>R</td>
<td>对类型 T 的对象进行操作，返回类型 R 的对象</td>
<td><code>R apply(T t)</code></td>
</tr>
<tr>
<td><code>Predicate&lt;T&gt;</code>：断定型接口</td>
<td>T</td>
<td>boolean</td>
<td>确定类型 T 的对象是否满足约束</td>
<td><code>boolean test(T t)</code></td>
</tr>
</tbody></table>
<p><strong>其他的函数式接口：</strong></p>
<table>
<thead>
<tr>
<th>函数式接口</th>
<th>参数类型</th>
<th>返回类型</th>
<th>用途</th>
<th>抽象方法</th>
</tr>
</thead>
<tbody><tr>
<td><code>BiFunction&lt;T, U, R&gt;</code></td>
<td>T、U</td>
<td>R</td>
<td>对类型 T、U 的对象进行操作，返回类型 R 的对象</td>
<td><code>R apply(T t, U u)</code></td>
</tr>
<tr>
<td><code>UnaryOperator&lt;T&gt;</code>（<code>Function</code> 子接口）</td>
<td>T</td>
<td>T</td>
<td>对类型 T 的对象进行一元运算，返回类型 T 的对象</td>
<td><code>T apply(T t)</code></td>
</tr>
<tr>
<td><code>BinaryOperator&lt;T&gt;</code>（<code>BiFunction</code> 子接口）</td>
<td>T、T</td>
<td>T</td>
<td>对类型 T 的对象进行二元运算，返回类型 T 的对象</td>
<td><code>T apply(T t1, T t2)</code></td>
</tr>
<tr>
<td><code>BiConsumer&lt;T, U&gt;</code></td>
<td>T、U</td>
<td>void</td>
<td>对类型 T、U 的对象进行操作</td>
<td><code>void accept(T t, U u)</code></td>
</tr>
<tr>
<td><code>BiPredicate&lt;T, U&gt;</code></td>
<td>T、U</td>
<td>boolean</td>
<td>确定类型 T、U 的对象是否满足约束</td>
<td><code>boolean test(T t, U u)</code></td>
</tr>
<tr>
<td><code>ToIntFunction&lt;T&gt;</code>、<code>ToLongFunction&lt;T&gt;</code>、<code>ToDoubleFunction&lt;T&gt;</code></td>
<td>T</td>
<td>int &#x2F; long &#x2F; double</td>
<td>计算 int &#x2F; long &#x2F;double 值的函数</td>
<td><code>int apply(T t)</code></td>
</tr>
<tr>
<td><code>IntFunction&lt;T&gt;</code>、<code>LongFunction&lt;T&gt;</code>、<code>DoubleFunction&lt;T&gt;</code></td>
<td>int &#x2F; long &#x2F; double</td>
<td>T</td>
<td>参数是 int &#x2F; long &#x2F;double 的函数</td>
<td><code>T applt(int n)</code></td>
</tr>
</tbody></table>
<h2 id="27-3-方法引用和构造器引用"><a href="#27-3-方法引用和构造器引用" class="headerlink" title="27.3 方法引用和构造器引用"></a>27.3 方法引用和构造器引用</h2><blockquote>
<p>当要传递给 Lambda 体的操作已经有实现方法了，可以使用方法引用。</p>
<p>方法引用可以看作是 Lambda 表达式深层次的表达。换句话说，方法引用就是 Lambda 表达式，即函数式接口的一个实例。通过方法名指向一个方法。</p>
</blockquote>
<h3 id="27-3-1-方法引用"><a href="#27-3-1-方法引用" class="headerlink" title="27.3.1 方法引用"></a>27.3.1 方法引用</h3><blockquote>
<p>实现接口的抽象方法的参数列表和返回值，与引用方法的参数列表和返回值一致</p>
</blockquote>
<ol>
<li><p><code>对象::非静态方法</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">PrintStream</span> <span class="variable">out</span> <span class="operator">=</span> System.out;</span><br><span class="line">Consumer&lt;String&gt; con = out::println;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>类::静态方法</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Long&gt; sl = System::currentTimeMillis;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>类::非静态方法</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;String&gt; bp = String::compareTo;</span><br></pre></td></tr></table></figure>

<p>上面的代码等同于以下写法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;String&gt; bp = (str1, str2) -&gt; str1.compareTo(str2);</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="27-3-2-构造器引用"><a href="#27-3-2-构造器引用" class="headerlink" title="27.3.2 构造器引用"></a>27.3.2 构造器引用</h3><blockquote>
<p>实现接口的抽象方法的参数列表与构造器参数列表一致，返回类型与构造器所在类一致</p>
</blockquote>
<ol>
<li><p>无参构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;String&gt; s = String::<span class="keyword">new</span>;</span><br></pre></td></tr></table></figure>

<p>等同于以下写法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;String&gt; s = <span class="keyword">new</span> <span class="title class_">Supplier</span>&lt;String&gt;()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>有参构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;String, String&gt; function = String::<span class="keyword">new</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="27-3-3-数组引用"><a href="#27-3-3-数组引用" class="headerlink" title="27.3.3 数组引用"></a>27.3.3 数组引用</h3><blockquote>
<p>把数组看成一个类，则其用法与构造器引用相同</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;Integer, <span class="type">char</span>[]&gt; f = n -&gt; <span class="keyword">new</span> <span class="title class_">char</span>[n];</span><br><span class="line">Function&lt;Integer, <span class="type">char</span>[]&gt; f2 = <span class="type">char</span>[]::<span class="keyword">new</span>;</span><br></pre></td></tr></table></figure>



<h2 id="27-4-Stream-API"><a href="#27-4-Stream-API" class="headerlink" title="27.4 Stream API"></a>27.4 Stream API</h2><blockquote>
<p>Stream API（<code>java.util.stream</code>）把真正的函数式编程风格引入到 Java 中。这是目前为止对 Java 类库最好的补充。因为 Stream API 可以极大提高 Java 程序员的生产力，让程序员写出高效率、干净、简洁的代码。</p>
<p>Stream 是 Java8 中处理集合的关键抽象概念，它可以指定你希望对集合进行的操作，可以执行非常复杂的查找、过滤和映射数据等操作。使用 Stream API 对集合进行数据操作，就类似于使用 SQL 执行的数据库查询。也可以使用 Stream API 来并行执行操作。简言之，Stream API 提供了一种高效且易于使用的处理数据的方式。</p>
</blockquote>
<p>Stream API 和 Collection 的区别：Collection 是一种静态的内存数据结构，而 Stream 是有关计算的。前者主要面向内存，储存于内存。后者主要面向 CPU，通过 CPU 实现计算。</p>
<h3 id="27-4-1-什么是-Stream"><a href="#27-4-1-什么是-Stream" class="headerlink" title="27.4.1 什么是 Stream"></a>27.4.1 什么是 Stream</h3><blockquote>
<p>Stream 是数据渠道，用于操作数据源所生成的元素序列</p>
</blockquote>
<ul>
<li>Stream 自己不会储存元素</li>
<li>Stream 不会改变源对象。他们会返回一个持有结果的新 Stream</li>
<li>Stream 操作是延迟执行的。这意味着他们会等到需要结果时才执行</li>
</ul>
<h3 id="27-4-2-Stream-操作步骤"><a href="#27-4-2-Stream-操作步骤" class="headerlink" title="27.4.2 Stream 操作步骤"></a>27.4.2 Stream 操作步骤</h3><ol>
<li><p>创建 Stream：</p>
<p>根据一个数据源，获取一个流</p>
</li>
<li><p>中间操作：</p>
<p>一个中间操作链，对数据源的数据进行处理</p>
</li>
<li><p>终止操作：</p>
<p>一旦执行终止操作，就执行中间操作链，并产生结果。之后，不会再被使用</p>
</li>
</ol>
<h4 id="27-4-2-1-创建-Stream"><a href="#27-4-2-1-创建-Stream" class="headerlink" title="27.4.2.1 创建 Stream"></a>27.4.2.1 创建 Stream</h4><ol>
<li><p>通过集合：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();				<span class="comment">//某个集合</span></span><br><span class="line"><span class="type">Stream</span> <span class="variable">stream</span> <span class="operator">=</span> list.stream();				<span class="comment">//返回一个顺序流</span></span><br><span class="line"><span class="type">Stream</span> <span class="variable">stream</span> <span class="operator">=</span> list.parallelStream();		<span class="comment">//返回一个并行流</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过数组：</p>
<p>Arrays 类提供了这个静态方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] ints = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">2</span>];					<span class="comment">//基本数据类型只有这三种</span></span><br><span class="line"><span class="type">IntStream</span> <span class="variable">IS</span> <span class="operator">=</span> Arrays.stream(ints);</span><br><span class="line"><span class="type">long</span>[] longs = <span class="keyword">new</span> <span class="title class_">long</span>[<span class="number">2</span>];</span><br><span class="line"><span class="type">LongStream</span> <span class="variable">LS</span> <span class="operator">=</span> Arrays.stream(longs);</span><br><span class="line"><span class="type">double</span>[] doubles = <span class="keyword">new</span> <span class="title class_">double</span>[<span class="number">2</span>];</span><br><span class="line"><span class="type">DoubleStream</span> <span class="variable">LS</span> <span class="operator">=</span> Arrays.stream(doubles);</span><br><span class="line">Object[] objs = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">4</span>];				<span class="comment">//此处表示一个任意类</span></span><br><span class="line">Stream&lt;Object&gt; stream = Arrays.stream(objs);</span><br></pre></td></tr></table></figure>

<p>这个方法的重载形式，能够处理对应基本类型的数组</p>
<ul>
<li><code>public static IntStream stream(int[] arr)</code></li>
<li><code>public static LongStream stream(long[] arr)</code></li>
<li><code>public static DoubleStream stream(double[] arr)</code></li>
</ul>
</li>
<li><p>通过 <code>Stream.of()</code> 方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Char[] chars = <span class="keyword">new</span> <span class="title class_">Char</span>[<span class="number">4</span>];</span><br><span class="line">Stream&lt;Char&gt; CS = Stream.of(chars);</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建无限流：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; iterate = Stream.iterate(<span class="number">1</span>, o -&gt; ++o);</span><br><span class="line">Stream&lt;Long&gt; generate = Stream.generate(System::currentTimeMillis);</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>public static&lt;T&gt; Stream&lt;T&gt; iterate(final T seed, final UnaryOperator&lt;T&gt; f)</code></p>
</li>
<li><p><code>public static&lt;T&gt; Stream&lt;T&gt; generate(Supplier&lt;T&gt; s)</code></p>
<p><em><strong>——看不懂？请看 <a href="2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/#27-2-1-Java-%E5%86%85%E7%BD%AE%E7%9A%84%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3">[ 27.2.1 Java 内置的函数式接口 ]</a></strong></em></p>
</li>
</ul>
</li>
</ol>
<h4 id="27-4-2-2-中间操作"><a href="#27-4-2-2-中间操作" class="headerlink" title="27.4.2.2 中间操作"></a>27.4.2.2 中间操作</h4><blockquote>
<p>多个中间操作连接起一个流水线。该流水线在触发终止操作前不执行任何处理，终止操作触发时一次性进行全部处理。这个流程也称为 “惰性求值”。</p>
</blockquote>
<ol>
<li><p>筛选与切片</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>filter(Predicate P)</code></td>
<td>接收一个 Lambda，从流中排除某些元素</td>
</tr>
<tr>
<td><code>distinct()</code></td>
<td>筛选，通过流生成元素的 <code>hashCode()</code> 和 <code>equals()</code> 进行去重</td>
</tr>
<tr>
<td><code>linmit(long maxSize)</code></td>
<td>截断流，使其元素不超过给定数量</td>
</tr>
<tr>
<td><code>skip(long n)</code></td>
<td>跳过元素，返回一个扔掉了前 n 给元素的流。不足 n 的场合返回空流</td>
</tr>
</tbody></table>
</li>
<li><p>映射</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>map(Function f)</code></td>
<td>接收一个函数，将元素转化成其他形式提取信息</td>
</tr>
<tr>
<td><code>flatMap(Function f)</code></td>
<td>接收一个函数，将每个元素都转换成另一个流</td>
</tr>
</tbody></table>
</li>
<li><p>排序</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>sorted()</code></td>
<td>产生一个新流，该流按自然顺序排序</td>
</tr>
<tr>
<td><code>sorted(Comparator c)</code></td>
<td>产生一个新流，该流按比较器顺序排序</td>
</tr>
</tbody></table>
</li>
</ol>
<h4 id="27-4-2-3-终止操作"><a href="#27-4-2-3-终止操作" class="headerlink" title="27.4.2.3 终止操作"></a>27.4.2.3 终止操作</h4><ol>
<li><p>匹配和查找</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>allMatch(Predicate p)</code></td>
<td>检查是否匹配全部元素</td>
</tr>
<tr>
<td><code>anyMatch(Predicate p)</code></td>
<td>检查是否有任意元素匹配</td>
</tr>
<tr>
<td><code>noneMatch(Predicate p)</code></td>
<td>检查是否任意元素都不匹配</td>
</tr>
<tr>
<td><code>findFirst()</code></td>
<td>返回第一个元素</td>
</tr>
<tr>
<td><code>findAny()</code></td>
<td>返回当前流的任意元素</td>
</tr>
<tr>
<td><code>count()</code></td>
<td>返回当前流的元素个数</td>
</tr>
<tr>
<td><code>max(Comparator c)</code></td>
<td>返回流中的（比较器顺序下的）最大值</td>
</tr>
<tr>
<td><code>min(Comparator c)</code></td>
<td>返回流中的（比较器顺序下的）最小值</td>
</tr>
<tr>
<td><code>forEach(Consumer c)</code></td>
<td>内部迭代</td>
</tr>
</tbody></table>
<ul>
<li>关于内部迭代：使用 <code>Collection</code> 接口需要用户去做迭代，称为外部迭代。Stream API 使用内部迭代，不需要用户做迭代。</li>
</ul>
</li>
<li><p>归约</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>reduce(T identity, BinaryOperator b)</code></td>
<td>可以把流中元素反复结合起来，得到一个值。返回 <code>T</code></td>
</tr>
<tr>
<td><code>reduce(BinaryOperator b)</code></td>
<td>可以把流中元素反复结合起来，得到一个值。返回 <code>Optinal&lt;T&gt;</code></td>
</tr>
</tbody></table>
</li>
<li><p>收集</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>collect(Collector c)</code></td>
<td>将流转换为其他形式。接收一个 Collector 接口的实现，用于给 Stream 中元素做汇总的方法</td>
</tr>
</tbody></table>
<ul>
<li><p><code>Collector</code> 接口中方法的实现决定了如何对流执行收集的操作</p>
<p>另外，<code>Collectors</code> 实用类提供了很多静态方法，可以方便地创建常见收集器实例。</p>
</li>
</ul>
</li>
</ol>
<h2 id="27-5-Optional-类"><a href="#27-5-Optional-类" class="headerlink" title="27.5 Optional 类"></a>27.5 <code>Optional</code> 类</h2><blockquote>
<p><code>Optional</code> 类（<code>java.util.Optional</code>）是一个容器类，它可以保存类型 T 的值，代表这个值存在。也可以仅仅保存 null，表示这个值不存在。原来用 null 表示一个值不存在，现在 Optional 可以更好地表达这个概念，而且可以避免空指针异常。</p>
</blockquote>
<h3 id="27-5-1-方法"><a href="#27-5-1-方法" class="headerlink" title="27.5.1 方法"></a>27.5.1 方法</h3><p><strong>创建方法：</strong></p>
<ul>
<li><code>Optional.of(T t)</code>：创建一个 <code>Optional</code> 实例。**<code>t</code> 必须非空**</li>
<li><code>Optional.empty()</code>：创建一个空的 <code>Optional</code> 实例</li>
<li><code>Optional.ofNullable(T t)</code>：创建一个 <code>Optional</code> 实例。**<code>t</code> 可以为 null**</li>
</ul>
<p><strong>判断 <code>Optional</code> 实例是否包含对象：</strong></p>
<ul>
<li><code>isPresent()</code>：判断是否包含对象，返回 boolean</li>
<li><code>ifPresent(Consumer c)</code>：如果有值，则传入该值并执行 <code>Consumer</code> 接口的实现代码。</li>
</ul>
<p><strong>获取 <code>Optional</code> 实例的对象：</strong></p>
<ul>
<li><code>get()</code>：如果有值，返回该值。否则抛出异常。</li>
<li><code>orElse(T other)</code>：如果有值，返回该值。否则返回指定的 other 对象。</li>
<li><code>orElseGet(Supplier other)</code>：如果有值，返回该值。否则返回 <code>Supplier</code> 接口实现提供的对象。</li>
<li><code>orElseThrow(Supplier excption)</code>：如果有值，返回该值。否则抛出 <code>Supplier</code> 接口实现提供的异常。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/09/27%20Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/" data-id="claq4nan2001op4tf0p40bx1x" data-title="&lt;Java&gt;27 Java 8 新特性" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-25 正则表达式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2022-03-01T16:00:00.000Z" itemprop="datePublished">2022-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">&lt;Java&gt;25 正则表达式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="25-正则表达式"><a href="#25-正则表达式" class="headerlink" title="25 正则表达式"></a>25 正则表达式</h1><blockquote>
<p>正则表达式：对字符串执行模式匹配的技术。一个正则表达式，就是用某种模式去匹配字符串的一个公式。除 Java 外，还有许多语言支持正则表达式。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="string">&quot;HeruinKCoin&quot;</span>;				<span class="comment">//对象文本</span></span><br><span class="line"><span class="type">String</span> <span class="variable">regular</span> <span class="operator">=</span> <span class="string">&quot;[A-Z]&quot;</span>;					<span class="comment">//[1] 创建规则</span></span><br><span class="line"><span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(regular);	<span class="comment">//[2] 创建模式对象</span></span><br><span class="line"><span class="type">Matcher</span> <span class="variable">matcher</span> <span class="operator">=</span> pattern.matcher(content);	<span class="comment">//[3] 创建匹配器</span></span><br><span class="line"><span class="keyword">while</span> (matcher.find())&#123;						<span class="comment">//[4] find() 是否找到下一个</span></span><br><span class="line">    System.out.println(matcher.group(<span class="number">0</span>));	<span class="comment">//[5] group(0) 输出找到的当前对象</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>Matcher</code> 底层维护了一个 <code>group[]</code> 数组。如果 <strong>[4]</strong> 在文本里匹配到对象，会在 <code>group[0]</code> 记载该起始位置 n1，在 <code>group[1]</code> 记录该结束位置的下一位 n2。即 [n1,n2) 为匹配的字符串，n2 位置是下次匹配的起始位置。</p>
<p>当 <strong>[1]</strong> 创建的规则包含分组（如 <code>String regular = &quot;(\\d\\d)(\\d\\d)&quot;;</code>），则第一组的起止位置记录在 <code>group[2]</code>、<code>group[3]</code>，第二组在 <code>group[4]</code>、<code>group[5]</code>。以此类推。这时，**[5]** 的 <code>group(0)</code> 代表输出全部，<code>group[1]</code> 代表输出第一组，以此类推。</p>
</blockquote>
<h2 id="25-1-语法"><a href="#25-1-语法" class="headerlink" title="25.1 语法"></a>25.1 语法</h2><p><strong>元字符</strong></p>
<ul>
<li>限定符</li>
<li>选择匹配符</li>
<li>分组组合和反向引用符</li>
<li>特殊字符</li>
<li>字符匹配符</li>
<li>定位符</li>
</ul>
<h3 id="25-1-1-转义符号"><a href="#25-1-1-转义符号" class="headerlink" title="25.1.1 转义符号 \"></a>25.1.1 转义符号 <code>\</code></h3><p>使用正则表达式去检索某些特殊字符时，需要加上转义符号（如：<code>(</code> 需要写成 <code>\(</code>）</p>
<p>在 Java 的正则表达式中，<code>\\</code> 代表一个 <code>\</code>。<em><strong>——见 <a href="2021/11/21/1%20%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#1-8-Java-%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6">[1.8 Java 转义字符 ]</a></strong></em></p>
<p>需要用到转义符号的字符有：<code>.</code>、<code>+</code>、<code>(</code>、<code>)</code>、<code>$</code>、<code>/</code>、<code>\</code>、<code>?</code>、<code>[</code>、<code>]</code>、<code>^</code>、<code>&#123;</code>、<code>&#125;</code></p>
<h3 id="25-1-2-字符匹配符"><a href="#25-1-2-字符匹配符" class="headerlink" title="25.1.2 字符匹配符"></a>25.1.2 字符匹配符</h3><table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>示例</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><code>[ ]</code></td>
<td>可接收的字符列表</td>
<td><code>[abcd]</code></td>
<td>abcd 中的任一字符</td>
</tr>
<tr>
<td><code>[^]</code></td>
<td>不接收的字符列表</td>
<td><code>[^abcd]</code></td>
<td>非 abcd 的任意字符</td>
</tr>
<tr>
<td><code>-</code></td>
<td>连字符</td>
<td><code>[a-z]</code></td>
<td>a - z 中的任意字符</td>
</tr>
<tr>
<td><code>.</code></td>
<td>匹配除 <code>\n</code> 外的任意字符</td>
<td><code>a..b</code></td>
<td>a 开头，b结尾，中间含 2 字符</td>
</tr>
<tr>
<td><code>\d</code></td>
<td>匹配单个数字字符</td>
<td><code>\d&#123;3&#125;</code></td>
<td>包含 3 个数字</td>
</tr>
<tr>
<td><code>\D</code></td>
<td>匹配单个非数字字符</td>
<td><code>\D(\d)*</code></td>
<td>单个非数字字符开头，后接任意个数字字符</td>
</tr>
<tr>
<td><code>\w</code></td>
<td>匹配单个数字、大小写字母字符</td>
<td><code>\w&#123;2&#125;\d&#123;3&#125;</code></td>
<td>2 个数字字母字符开头，后接 3 个数字字符</td>
</tr>
<tr>
<td><code>\W</code></td>
<td>匹配单个非数字、非大小写字母字符</td>
<td><code>\W+\d&#123;2&#125;</code></td>
<td>以至少 1 个非数字字母字符开头，后接 2 个数字字符</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>匹配空白字符（空格、制表位等）</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>\S</code></td>
<td>匹配非空白字符</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ul>
<li><p>关于 <code>.</code>：特别地，出现 <code>[.]</code> 的场合，那个小圆点依然表示小圆点。<code>[?]</code> 同理，表示问号</p>
</li>
<li><p>正则表达式默认区分大小写。要不区分大小写，就加上 <code>(?i)</code></p>
<ul>
<li><p><code>(?i)abc</code>：即 abc 都不区分大小写</p>
</li>
<li><p><code>a(?i)bc</code>：即仅 bc 不区分大小写</p>
</li>
<li><p><code>a((?i)b)c</code>：即仅 b 不区分大小写</p>
</li>
<li><p>创建模式对象时，若如此做：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(regular, Pattern.CASE_INSENSITIVE);</span><br></pre></td></tr></table></figure>

<p>这个场合，也能不区分大小写。</p>
</li>
</ul>
</li>
</ul>
<h3 id="25-1-3-选择匹配符"><a href="#25-1-3-选择匹配符" class="headerlink" title="25.1.3 选择匹配符 |"></a>25.1.3 选择匹配符 <code>|</code></h3><p>……我的感想是，和 Java 的逻辑或 <code>|</code> 一样！</p>
<h3 id="25-1-4-限定符"><a href="#25-1-4-限定符" class="headerlink" title="25.1.4 限定符"></a>25.1.4 限定符</h3><table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>示例</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><code>*</code></td>
<td>指定字符重复任意次（可以为 0 次）</td>
<td><code>(abc)*</code></td>
<td>仅包含任意个 abc 字符串的字符串</td>
</tr>
<tr>
<td><code>+</code></td>
<td>指定字符重复至少一次</td>
<td><code>m+(abc)*</code></td>
<td>以任意个 m 开头，后面可以有 abc 字符串的字符串</td>
</tr>
<tr>
<td><code>?</code></td>
<td>指定字符重复最多一次（可以为 0 次）</td>
<td><code>m+abc?</code></td>
<td>以任意个 m 开头，后面可以有最多一个 abc 字符串的字符串</td>
</tr>
<tr>
<td><code>&#123;n&#125;</code></td>
<td>n 个匹配</td>
<td><code>[abc]&#123;3&#125;</code></td>
<td>长度为 3 的 abc 中的任意字符的组合</td>
</tr>
<tr>
<td><code>&#123;n,&#125;</code></td>
<td>至少 n 个匹配</td>
<td><code>[abc]&#123;3,&#125;</code></td>
<td>长度不小于 3 的 abc 中的任意字符的组合</td>
</tr>
<tr>
<td><code>&#123;n,m&#125;</code></td>
<td>n 到 m 个匹配</td>
<td><code>[abc]&#123;3,5&#125;</code></td>
<td>长度介于 3 到 5 之间的 abc 中的任意字符的组合</td>
</tr>
</tbody></table>
<ul>
<li><p>Java 的匹配模式默认是贪婪匹配。即：<code>aaaaa</code> 匹配 <code>a&#123;3,5&#125;</code> 的场合，会匹配到 <code>aaaaa</code></p>
<p>希望实现非贪婪匹配，可以添加额外的 <code>?</code>。如：<code>*?</code>、<code>+?</code>、<code>??</code> 代表各自规则的非贪婪匹配</p>
</li>
</ul>
<h3 id="25-1-5-定位符"><a href="#25-1-5-定位符" class="headerlink" title="25.1.5 定位符"></a>25.1.5 定位符</h3><table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>示例</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><code>^</code></td>
<td>指定起始字符</td>
<td><code>^[0-9]+[a-z]*</code></td>
<td>至少一个数字开头，后接任意小写字母字符串</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>指定结束字符</td>
<td><code>^[0-9][a]$</code></td>
<td>一个数字开头，一个 a 结尾</td>
</tr>
<tr>
<td><code>\b</code></td>
<td>匹配目标字符串的边界</td>
<td><code>K\.C\b</code></td>
<td>匹配边界的 K.C</td>
</tr>
<tr>
<td><code>\B</code></td>
<td>匹配目标字符串的非边界</td>
<td><code>K\.C\B</code></td>
<td>匹配非边界的 K.C</td>
</tr>
</tbody></table>
<ul>
<li>边界即字符串的末尾，或字符串中空格间隔的子串的末尾。</li>
</ul>
<h3 id="25-1-6-分组"><a href="#25-1-6-分组" class="headerlink" title="25.1.6 分组"></a>25.1.6 分组</h3><table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>(pattern)</code></td>
<td>非命名捕获。捕获匹配的字符串。</td>
</tr>
<tr>
<td><code>(?&lt;name&gt;pattern)</code>、<code>(?&#39;name&#39;pattern)</code></td>
<td>命名捕获。用于 name 的字符串不能包含标点符号，也不能以数字开头</td>
</tr>
</tbody></table>
<ul>
<li>编号为 0 的第一个捕获是由整个正则表达式匹配的文本。其他捕获结果根据左括号的顺序从 1 开始自动编号。</li>
</ul>
<h3 id="25-1-7-非捕获分组"><a href="#25-1-7-非捕获分组" class="headerlink" title="25.1.7 非捕获分组"></a>25.1.7 非捕获分组</h3><table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>示例</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><code>(?:pattern)</code></td>
<td>匹配 pattern 但不捕获该匹配的子表达式。</td>
<td>&#96;industr(?:y</td>
<td>ies)&#96;</td>
</tr>
<tr>
<td><code>(?=pattern)</code></td>
<td>匹配处于 pattern 前的搜索字符串。非捕获分组。</td>
<td>&#96;Windows(?&#x3D;7</td>
<td>10</td>
</tr>
<tr>
<td><code>(?!pattern)</code></td>
<td>匹配不处于 pattern 前的搜索字符串。非捕获分组。</td>
<td>&#96;Windows(?!7</td>
<td>10</td>
</tr>
</tbody></table>
<h2 id="25-2-常用类"><a href="#25-2-常用类" class="headerlink" title="25.2 常用类"></a>25.2 常用类</h2><ul>
<li><p><code>Pattern</code> 类：</p>
<p><code>Pattern</code> 对象是一个正则表达式对象，该类没有公共构造方法。</p>
<p>用 <code>Pattern.compile(reg)</code> 获取一个 <code>Pattern</code> 对象。</p>
</li>
<li><p><code>Matcher</code> 类：</p>
<p><code>Matcher</code> 对象是输入字符串进行解释和匹配的引擎，也没有公共构造方法。</p>
<p>用 <code>Pattern</code> 对象的 <code>matcher(content)</code> 方法获得一个 <code>Matcher</code> 对象。</p>
</li>
<li><p><code>PatternSyntaxExcption</code> 类：</p>
<p><code>PatternSyntaxExcption</code> 是一个非强制异常类，表示一个正则表达式中的语法错误。</p>
</li>
</ul>
<h3 id="25-2-1-Pattern-类常用方法"><a href="#25-2-1-Pattern-类常用方法" class="headerlink" title="25.2.1 Pattern 类常用方法"></a>25.2.1 <code>Pattern</code> 类常用方法</h3><ul>
<li><p><code>Pattern.matches(reg, content)</code>：整体匹配，输入的字符串是否符合表达式。返回布尔值。</p>
<p><code>matcher.matches()</code>：整体匹配，字符串是否符合表达式。返回布尔值。前面的方法实际上就是这个方法。</p>
</li>
<li><p><code>Pattern.compile(reg)</code>：返回一个指定表达式的 <code>Pattern</code> 对象 </p>
</li>
<li><p><code>pattern.matcher(content)</code>：返回一个字串的 <code>Matcher</code> 对象</p>
</li>
<li><p><code>matcher.pattern()</code>：返回该 <code>Matcher</code> 对象的表达式</p>
<p><code>pattern.pattern()</code>：返回该 <code>Pattern</code> 对象的表达式</p>
</li>
<li><p><code>matcher.find()</code>：尝试查找下一个匹配的序列，返回布尔值</p>
<p><code>matcher.find(int)</code>：重置该匹配器，从指定索引位置开始重新查找</p>
</li>
<li><p><code>matcher.start()</code>：返回本次匹配的字符起始位置的索引</p>
<p><code>matcher.end()</code>：返回本次匹配的字符结束位置 + 1 的索引</p>
<p>这个场合，<code>content.substring(matcher.start(), matcher.end())</code> 就是匹配的字符串</p>
</li>
<li><p><code>matcher.start(int)</code>：返回本次匹配的字符的该组内容的起始位置的索引</p>
<p><code>matcher.end(int)</code>：返回本次匹配的字符的该组内容的结束位置 + 1 的索引</p>
</li>
<li><p><code>matcher.replaceAll(str)</code>：替换匹配到的全部内容</p>
<p><code>matcher.replaceFirst(str)</code>：替换第一次匹配到的内容</p>
<p>这些场合，返回的字符串才是替换后的字符串。原字符串不变。</p>
</li>
</ul>
<h2 id="25-3-分组、捕获、反向引用"><a href="#25-3-分组、捕获、反向引用" class="headerlink" title="25.3 分组、捕获、反向引用"></a>25.3 分组、捕获、反向引用</h2><ul>
<li><p>分组（子表达式）</p>
</li>
<li><p>捕获：把正则表达式中，子表达式（分组）的内容保存到内存中以数字编号或显式命名的组里，方便后面引用。以分组的左括号为标志，第一组组号为 1，第二组为 2，以 0 代表整个正则表达式。</p>
</li>
<li><p>反向引用：分组的内容被捕获后，可以在这个括号后使用。这种引用既可以是在正则表达式内部，也可以在外部。内部反向引用 <code>\分组号</code>、外部反向引用 <code>$分组号</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">regular</span> <span class="operator">=</span> <span class="string">&quot;(\\w)\\1+&quot;</span>;			<span class="comment">//即，重复的字母或数字</span></span><br><span class="line"><span class="type">Matcher</span> <span class="variable">matcher</span> <span class="operator">=</span> Pattern.compile(regular).mathcer(content);</span><br><span class="line">content = matcher.replaceAll(<span class="string">&quot;$1&quot;</span>);		<span class="comment">//这样，就完成了去重</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="25-4-在-String-中使用正则表达式"><a href="#25-4-在-String-中使用正则表达式" class="headerlink" title="25.4 在 String 中使用正则表达式"></a>25.4 在 <code>String</code> 中使用正则表达式</h2><ul>
<li><code>str.matches(reg)</code>：整体匹配</li>
<li><code>str.replaceAll(reg, reg)</code>：替换匹配到的全部内容</li>
<li><code>str.split(reg)</code>：分割内容</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/03/02/25%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" data-id="claq4nan0001ep4tfdstka0n5" data-title="&lt;Java&gt;25 正则表达式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-24 项目：满汉楼" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/02/26/24%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E6%BB%A1%E6%B1%89%E6%A5%BC/" class="article-date">
  <time class="dt-published" datetime="2022-02-25T16:00:00.000Z" itemprop="datePublished">2022-02-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/02/26/24%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E6%BB%A1%E6%B1%89%E6%A5%BC/">&lt;Java&gt;24 项目（满汉楼）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="24-项目：满汉楼"><a href="#24-项目：满汉楼" class="headerlink" title="24 项目：满汉楼"></a>24 项目：满汉楼</h1><ul>
<li>登录界面<ul>
<li>登录（账号、密码）</li>
<li>退出</li>
</ul>
</li>
<li>菜单界面<ul>
<li>餐桌状态（显示编号、状态）</li>
<li>预定餐桌（编号[核对、二次确认]、预定人名字、电话）</li>
<li>菜单（名称、价格、类别、编号）<ul>
<li>全部、分类</li>
</ul>
</li>
<li>点餐（桌号[核对]、菜品[核对]、数量）</li>
<li>账单（按照桌号分组。菜品、数量、金额、桌号、日期、状态）</li>
<li>结账（桌号、方式、二次确认）</li>
<li>退出系统</li>
</ul>
</li>
<li>数据库<ul>
<li>登录用户：login（id、name、password[md5]）</li>
<li>餐桌状态：table（id、order、seat、customer）</li>
<li>顾客：customer（id、name、card_id、call）</li>
<li>菜单：dishes（id、name、price、species、available）</li>
<li>账单：bill（id、date、customer、num、table、clear、dishes）</li>
</ul>
</li>
</ul>
<h2 id="代码：万民堂"><a href="#代码：万民堂" class="headerlink" title="代码：万民堂"></a>代码：万民堂</h2><p><del>说是满汉楼，其实是万民堂</del></p>
<p><strong>没有优化过，所以健壮性不强。懒得做优化了，反正之前的项目做过了</strong></p>
<h3 id="1-数据库"><a href="#1-数据库" class="headerlink" title="1. 数据库"></a>1. 数据库</h3><blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql://localhost:3306/wan_min</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="表"><a href="#表" class="headerlink" title="表"></a>表</h4><blockquote>
<p>以下大部分是润色后的 <code>show create table xxx</code> 的返回语句</p>
</blockquote>
<h5 id="table（餐桌）"><a href="#table（餐桌）" class="headerlink" title="table（餐桌）"></a>table（餐桌）</h5><blockquote>
<p>餐桌号 id（主键）、餐桌状态 order、座数 seat、订餐人 customer</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `table` (</span><br><span class="line">      `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT ,</span><br><span class="line">      `order` enum(&#x27;已预定&#x27;,&#x27;用餐&#x27;,&#x27;空&#x27;,&#x27;不可用&#x27;) COLLATE utf8_bin NOT NULL DEFAULT &#x27;空&#x27;,</span><br><span class="line">      `seat` smallint(5) unsigned NOT NULL DEFAULT &#x27;2&#x27;,</span><br><span class="line">      `customer` smallint(5) unsigned DEFAULT NULL,</span><br><span class="line">      PRIMARY KEY (`id`),</span><br><span class="line">      KEY `customer` (`customer`),</span><br><span class="line">      CONSTRAINT `table_ibfk_1` FOREIGN KEY (`customer`) REFERENCES `customer` (`id`)</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<h5 id="dishes（菜单）"><a href="#dishes（菜单）" class="headerlink" title="dishes（菜单）"></a>dishes（菜单）</h5><blockquote>
<p>餐品号 id（主键）、餐品名 name（唯一）、价格 price、分类 species、是否可用 available</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `dishes` (</span><br><span class="line">      `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">      `name` char(8) COLLATE utf8_bin NOT NULL,</span><br><span class="line">      `price` smallint(5) unsigned NOT NULL DEFAULT &#x27;0&#x27;,</span><br><span class="line">      `species` enum(&#x27;主食&#x27;,&#x27;主菜&#x27;,&#x27;汤品&#x27;,&#x27;凉菜&#x27;,&#x27;甜点&#x27;,&#x27;饮料&#x27;,&#x27;&#x27;) COLLATE utf8_bin NOT NULL DEFAULT &#x27;&#x27;,</span><br><span class="line">      `available` enum(&#x27;y&#x27;,&#x27;n&#x27;) COLLATE utf8_bin NOT NULL DEFAULT &#x27;y&#x27;,</span><br><span class="line">      PRIMARY KEY (`id`),</span><br><span class="line">      UNIQUE KEY `name` (`name`)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h5 id="customer（客人信息）"><a href="#customer（客人信息）" class="headerlink" title="customer（客人信息）"></a>customer（客人信息）</h5><blockquote>
<p>顾客ID id（主键）、顾客名字 name、顾客证件号 card_id（可为空）、顾客电话 call</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `customer` (</span><br><span class="line">      `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">      `name` varchar(12) COLLATE utf8_bin NOT NULL,</span><br><span class="line">      `card_id` char(18) COLLATE utf8_bin DEFAULT NULL,</span><br><span class="line">      `call` char(11) COLLATE utf8_bin NOT NULL,</span><br><span class="line">      PRIMARY KEY (`id`)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h5 id="login（登录验证）"><a href="#login（登录验证）" class="headerlink" title="login（登录验证）"></a>login（登录验证）</h5><blockquote>
<p>系统登录ID id（主键）、系统登录名 name（唯一）、密码 password（md5 加密）</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `login` (</span><br><span class="line">      `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">      `name` varchar(10) COLLATE utf8_bin NOT NULL,</span><br><span class="line">      `password` char(32) COLLATE utf8_bin NOT NULL,</span><br><span class="line">      PRIMARY KEY (`id`),</span><br><span class="line">      UNIQUE KEY `name` (`name`)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h5 id="bill（订单）"><a href="#bill（订单）" class="headerlink" title="bill（订单）"></a>bill（订单）</h5><blockquote>
<p>订单ID id（主键）、日期 date、顾客 customer（外键）、菜品ID id（外键）、菜品数量 num、桌号 table（外键）、结算状态 clear（枚举，y现金、alipay支付宝、wcpay微信、n未付）</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `bill` (</span><br><span class="line">      `id` int(10) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">      `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,</span><br><span class="line">      `customer` smallint(5) unsigned NOT NULL,</span><br><span class="line">      `num` smallint(5) unsigned NOT NULL DEFAULT &#x27;1&#x27;,</span><br><span class="line">      `table` smallint(5) unsigned NOT NULL,</span><br><span class="line">      `clear` enum(&#x27;y&#x27;,&#x27;n&#x27;,&#x27;alipay&#x27;,&#x27;wc_pay&#x27;) COLLATE utf8_bin NOT NULL DEFAULT &#x27;n&#x27;,</span><br><span class="line">      `dishes` smallint(5) unsigned NOT NULL,</span><br><span class="line">      PRIMARY KEY (`id`),</span><br><span class="line">      KEY `customer` (`customer`),</span><br><span class="line">      KEY `table` (`table`),</span><br><span class="line">      KEY `dishes` (`dishes`),</span><br><span class="line">      CONSTRAINT `bill_ibfk_1` FOREIGN KEY (`customer`) REFERENCES `customer` (`id`),</span><br><span class="line">      CONSTRAINT `bill_ibfk_2` FOREIGN KEY (`table`) REFERENCES `table` (`id`),</span><br><span class="line">      CONSTRAINT `bill_ibfk_3` FOREIGN KEY (`dishes`) REFERENCES `dishes` (`id`)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h5 id="detail-bill（view，查询订单信息）"><a href="#detail-bill（view，查询订单信息）" class="headerlink" title="detail_bill（view，查询订单信息）"></a>detail_bill（view，查询订单信息）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW `detail_bill` AS </span><br><span class="line">	select `customer`.`name` AS `name`,</span><br><span class="line">       `customer`.`call` AS `call`,</span><br><span class="line">       `bill`.`table` AS `table`,</span><br><span class="line">       `dishes`.`name` AS `dishes`,</span><br><span class="line">       `bill`.`num` AS `num`,</span><br><span class="line">       `bill`.`date` AS `date`,</span><br><span class="line">       `bill`.`clear` AS `clear` </span><br><span class="line">	from `bill` , `customer`, `dishes` </span><br><span class="line">	where (`bill`.`customer` = `customer`.`id`) </span><br><span class="line">		and (`bill`.`dishes` = `dishes`.`id`)</span><br></pre></td></tr></table></figure>



<h3 id="Java-代码"><a href="#Java-代码" class="headerlink" title="Java 代码"></a>Java 代码</h3><h4 id="通用部分"><a href="#通用部分" class="headerlink" title="通用部分"></a>通用部分</h4><blockquote>
<p>以下各包，客户端和服务端各自持有一份，存放在相同目录下。</p>
</blockquote>
<h5 id="com-melody-wmt-common"><a href="#com-melody-wmt-common" class="headerlink" title="com.melody.wmt.common"></a>com.melody.wmt.common</h5><h6 id="Message-java"><a href="#Message-java" class="headerlink" title="Message.java"></a>Message.java</h6><blockquote>
<p><em>com.melody.wmt.common.Message.java</em></p>
<p>信息包。客户端、服务端的通讯依靠发送该包进行</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Message</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String sender;		<span class="comment">//发送者IP</span></span><br><span class="line">    <span class="keyword">private</span> String receiver;	<span class="comment">//接收者IP</span></span><br><span class="line">    <span class="keyword">private</span> String word;		<span class="comment">//信息标识</span></span><br><span class="line">    <span class="keyword">private</span> Object object;		<span class="comment">//信息数据</span></span><br><span class="line">    <span class="keyword">private</span> Instant timeStamp;	<span class="comment">//信息时间戳</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Message</span><span class="params">(String sender, String receiver, String word, Object object)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sender = sender;</span><br><span class="line">        <span class="built_in">this</span>.receiver = receiver;</span><br><span class="line">        <span class="built_in">this</span>.word = word;</span><br><span class="line">        <span class="built_in">this</span>.object = object;</span><br><span class="line">        timeStamp = Instant.now();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSender</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSender</span><span class="params">(String sender)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sender = sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getReceiver</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> receiver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setReceiver</span><span class="params">(String receiver)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.receiver = receiver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getWord</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> word;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setWord</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.word = word;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getObject</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setObject</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.object = object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Instant <span class="title function_">getTimeStamp</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> timeStamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTimeStamp</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.timeStamp = Instant.now();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="MessageType-java"><a href="#MessageType-java" class="headerlink" title="MessageType.java"></a>MessageType.java</h6><blockquote>
<p><em>com.melody.wmt.common.MessageType.java</em></p>
<p>信息标识包。通过该包来分析信息包的种类。该包没有方法。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.common;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MessageType</span> &#123;</span><br><span class="line">    <span class="comment">/*以下是服务端发送*/</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">REJECT</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span>;					<span class="comment">//拒绝请求</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ACCEPT</span> <span class="operator">=</span> <span class="string">&quot;A&quot;</span>;					<span class="comment">//通过请求</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">LOGIN_USER_NOT_EXIST</span> <span class="operator">=</span> <span class="string">&quot;LUNE&quot;</span>;	<span class="comment">//登录失败：用户不存在</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">LOGIN_WRONG_PW</span> <span class="operator">=</span> <span class="string">&quot;LWP&quot;</span>;			<span class="comment">//登陆失败：密码错误</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">WRONG_REQUEST</span> <span class="operator">=</span> <span class="string">&quot;WR&quot;</span>;			<span class="comment">//请求无效</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">TABLE_NOT_EXIST</span> <span class="operator">=</span> <span class="string">&quot;TNE&quot;</span>;			<span class="comment">//餐桌不存在</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">TABLE_OCCUPIED</span> <span class="operator">=</span> <span class="string">&quot;TOP&quot;</span>;			<span class="comment">//餐桌被占用（未点餐）</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">TABLE_DINNING</span> <span class="operator">=</span> <span class="string">&quot;TOD&quot;</span>;			<span class="comment">//餐桌被占用（已点餐）</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">TABLE_NOT_AVAILABLE</span> <span class="operator">=</span> <span class="string">&quot;TNA&quot;</span>;		<span class="comment">//餐桌不可用</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">TABLE_AVAILABLE</span> <span class="operator">=</span> <span class="string">&quot;TIA&quot;</span>;			<span class="comment">//餐桌为空</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">NOT_FOUND</span> <span class="operator">=</span> <span class="string">&quot;NF&quot;</span>;				<span class="comment">//没有找到目标</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*以下是客户端发送*/</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">LOGIN</span> <span class="operator">=</span> <span class="string">&quot;LGI&quot;</span>;					<span class="comment">//请求登录</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">SHOW_TABLES</span> <span class="operator">=</span> <span class="string">&quot;RST&quot;</span>;				<span class="comment">//请求返回餐桌列表</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">CHECK_TABLE</span> <span class="operator">=</span> <span class="string">&quot;RCT&quot;</span>;				<span class="comment">//请求查询餐桌状态</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ORDER_TABLE</span> <span class="operator">=</span> <span class="string">&quot;ROT&quot;</span>;				<span class="comment">//请求预定餐桌</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">SHOW_DISHES</span> <span class="operator">=</span> <span class="string">&quot;RSD&quot;</span>;				<span class="comment">//请求返回菜单列表</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">CHECK_DISHES</span> <span class="operator">=</span> <span class="string">&quot;RCD&quot;</span>;			<span class="comment">//请求查询菜单状态</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ORDER_DISHES</span> <span class="operator">=</span> <span class="string">&quot;ROD&quot;</span>;			<span class="comment">//请求订餐</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">SHOW_ALL_BILLS</span> <span class="operator">=</span> <span class="string">&quot;RAB&quot;</span>;			<span class="comment">//请求返回账单列表</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">CHECK_BILLS</span> <span class="operator">=</span> <span class="string">&quot;RCB&quot;</span>;				<span class="comment">//请求查询账单状态</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">FINISH_BILLS</span> <span class="operator">=</span> <span class="string">&quot;RFB&quot;</span>;			<span class="comment">//请求完成账单</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">LOGOUT</span> <span class="operator">=</span> <span class="string">&quot;LGO&quot;</span>;					<span class="comment">//请求登出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="com-melody-wmt-sql"><a href="#com-melody-wmt-sql" class="headerlink" title="com.melody.wmt.sql"></a>com.melody.wmt.sql</h5><h6 id="LoginData-java"><a href="#LoginData-java" class="headerlink" title="LoginData.java"></a>LoginData.java</h6><blockquote>
<p><em>com.melody.wmt.sql.LoginData.java</em></p>
<p>登录信息包。该包对应表 <code>login</code> 的记录。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginData</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LoginData</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LoginData</span><span class="params">(<span class="type">int</span> id, String name, String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TableData-java"><a href="#TableData-java" class="headerlink" title="TableData.java"></a>TableData.java</h6><blockquote>
<p><em>com.melody.wmt.sql.TableData.java</em></p>
<p>餐桌信息包。该包对应表 <code>table</code> 的记录。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TableData</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String order;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> customer;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> seat;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TableData</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TableData</span><span class="params">(<span class="type">int</span> id, String order, <span class="type">int</span> customer, <span class="type">int</span> seat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.order = order;</span><br><span class="line">        <span class="built_in">this</span>.customer = customer;</span><br><span class="line">        <span class="built_in">this</span>.seat = seat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getOrder</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOrder</span><span class="params">(String order)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCustomer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> customer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCustomer</span><span class="params">(<span class="type">int</span> customer)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.customer = customer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSeat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> seat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSeat</span><span class="params">(<span class="type">int</span> seat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.seat = seat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id + <span class="string">&quot;\t&quot;</span> + seat + <span class="string">&quot;\t&quot;</span> + order + <span class="string">&quot;\t&quot;</span> + (customer == <span class="number">0</span> ? <span class="string">&quot;-&quot;</span> : customer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="服务端部分"><a href="#服务端部分" class="headerlink" title="服务端部分"></a>服务端部分</h4><h5 id="com-melody-wmt-library"><a href="#com-melody-wmt-library" class="headerlink" title="com.melody.wmt.library"></a>com.melody.wmt.library</h5><blockquote>
<p>在目录 <em>com.melody.wmt.library</em> 下，配置以下 jar 包：</p>
<ul>
<li><p><code>druid-1.2.8.jar</code>：德鲁伊连接池</p>
</li>
<li><p><code>mysql-connector-java-8.0.27.jar</code>：MySQL 数据库</p>
</li>
<li><p><code>commons-dbutils-1.7.jar</code>：Apache-DBUtils</p>
</li>
</ul>
</blockquote>
<h5 id="com-melody-wmt-server"><a href="#com-melody-wmt-server" class="headerlink" title="com.melody.wmt.server"></a>com.melody.wmt.server</h5><h6 id="Server-java"><a href="#Server-java" class="headerlink" title="Server.java"></a>Server.java</h6><blockquote>
<p>服务端入口</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.ServerSocket;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String serverIP;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 多此一举地初始化服务端 IP 地址。其实直接写正确地址也行的 */</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tempIP</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            tempIP = InetAddress.getLocalHost().getHostAddress();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            tempIP = <span class="string">&quot;192.168.3.16&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            serverIP = tempIP;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 主方法</span></span><br><span class="line"><span class="comment">    持续监听端口，每当有接入时就丢给新的 RunningServer 线程 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">serverSocket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9000</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">accept</span> <span class="operator">=</span> serverSocket.accept();</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">RunningServer</span>(accept)).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="RunningServer-java"><a href="#RunningServer-java" class="headerlink" title="RunningServer.java"></a>RunningServer.java</h6><blockquote>
<p>服务端进程主体。由 <em>Server.java</em> 创建。</p>
<p>该进程能实现：用户登录验证、识别客户端请求</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.common.Message;</span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.common.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.sql.LoginData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RunningServer</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> ObjectInputStream ois;		<span class="comment">//通信的输入流</span></span><br><span class="line">    <span class="keyword">private</span> ObjectOutputStream oos;		<span class="comment">//通信的输出流</span></span><br><span class="line">    <span class="keyword">private</span> String targetIP;			<span class="comment">//通信对象的 IP</span></span><br><span class="line">    <span class="keyword">private</span> LoginData loginData;		<span class="comment">//通信对象声明的登录对象的信息。</span></span><br><span class="line">    							<span class="comment">//这个信息来自数据库，不一定和通信对象声明的信息匹配</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">running</span> <span class="operator">=</span> <span class="literal">true</span>;		<span class="comment">//线程运行中。false 的场合线程停止</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 完成一些初始化 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RunningServer</span><span class="params">(Socket socket)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.socket = socket;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ois = <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());</span><br><span class="line">            oos = <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            closeAll();</span><br><span class="line">        &#125;</span><br><span class="line">        targetIP = socket.getLocalAddress().getHostAddress();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 接收通信对象的登录请求 */</span></span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> ServerUtils.receiveMessage(ois);</span><br><span class="line">            <span class="comment">/* 获得通信对象声明的登录对象信息。</span></span><br><span class="line"><span class="comment">            这里返回 null 的场合，登录失败 */</span></span><br><span class="line">            loginData = ServerUtils.checkLogin(message);</span><br><span class="line">            System.out.println(targetIP + <span class="string">&quot; 请求登录 &lt;&quot;</span> + message.getObject()+<span class="string">&quot;&gt;&quot;</span>);</span><br><span class="line">            <span class="comment">/* 登录失败的场合，发送拒绝信息，并关闭所有流 */</span></span><br><span class="line">            <span class="keyword">if</span> (loginData == <span class="literal">null</span>) &#123;</span><br><span class="line">                ServerUtils.sendRejection(targetIP, oos);</span><br><span class="line">                closeAll();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* 登录成功，发送登录对象信息 */</span></span><br><span class="line">                ServerUtils.sendMessage(<span class="keyword">new</span> <span class="title class_">Message</span>(Server.serverIP, targetIP, MessageType.ACCEPT, loginData), oos);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(targetIP + <span class="string">&quot; 登录成功 &quot;</span> + loginData.getName() + LocalDateTime.now());</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/* 直到这里，登录成功，正式开始监听客户端请求 */</span></span><br><span class="line">            <span class="keyword">while</span> (running) &#123;</span><br><span class="line">                listeningRequest();</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">/* 如果发生任何连接异常，我们中断连接，并关闭所有流 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(targetIP + <span class="string">&quot; 连接中断 &quot;</span> + loginData.getName() + LocalDateTime.now());</span><br><span class="line">            closeAll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 这个方法是关闭所有流的方法。在关闭连接时会被调用 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">closeAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ois != <span class="literal">null</span>) &#123;</span><br><span class="line">                ois.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (oos != <span class="literal">null</span>) &#123;</span><br><span class="line">                oos.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (socket != <span class="literal">null</span>) &#123;</span><br><span class="line">                socket.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 这个方法是监听客户端请求的方法。根据不同请求，做出不同反应 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">listeningRequest</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/* 监听请求 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> ServerUtils.receiveMessage(ois);</span><br><span class="line">        <span class="comment">/* 检查收到的数据包的信息标识 */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">request</span> <span class="operator">=</span> message.getWord();</span><br><span class="line">        <span class="comment">/* 创建将要发送的数据包。此时，该包还是空的 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">toSend</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Server.serverIP, targetIP, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        <span class="comment">/* 检查一下接收的数据包的用户信息。有任何问题的话我们就发送请求错误包 */</span></span><br><span class="line">        <span class="comment">/* ……在这里解释一下：客户发送的数据包里，主要包含以下信息：</span></span><br><span class="line"><span class="comment">        1. getWord() 返回数据包标识。客户端的任何请求会对应不同的标识</span></span><br><span class="line"><span class="comment">        2. getObject() 一定包含一条 String 语句。该语句被转义字符 \t 分为几个部分。</span></span><br><span class="line"><span class="comment">        	第一部分一定是用户名、第二部分一定是用户密码。</span></span><br><span class="line"><span class="comment">        	根据请求需要，也会有更多其他部分 */</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!ServerUtils.checkUser((String) message.getObject(), loginData)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            toSend.setWord(MessageType.WRONG_REQUEST);</span><br><span class="line">            ServerUtils.sendMessage(toSend, oos);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 下面，根据不同信息包标识，我们做出不同反应 */</span></span><br><span class="line">        <span class="comment">/* 接收到返回餐桌列表的请求 */</span></span><br><span class="line">        <span class="keyword">if</span> (request.equals(MessageType.SHOW_TABLES)) &#123;</span><br><span class="line">            ServerUtils.showTables(toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到检查餐桌的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.CHECK_TABLE)) &#123;</span><br><span class="line">            ServerUtils.checkTable(message, toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到预定餐桌的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.ORDER_TABLE)) &#123;</span><br><span class="line">            ServerUtils.orderTable(message, toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到返回菜单列表的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.SHOW_DISHES)) &#123;</span><br><span class="line">            ServerUtils.showDishes(toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到检查菜单的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.CHECK_DISHES)) &#123;</span><br><span class="line">            ServerUtils.checkDishes(message, toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到点餐的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.ORDER_DISHES)) &#123;</span><br><span class="line">            ServerUtils.orderDishes(message, toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到返回账单列表的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.SHOW_ALL_BILLS)) &#123;</span><br><span class="line">            ServerUtils.showBills(toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到检查账单的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.CHECK_BILLS)) &#123;</span><br><span class="line">            ServerUtils.checkBills(message, toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到结账的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.FINISH_BILLS)) &#123;</span><br><span class="line">            ServerUtils.finishBills(message, toSend, oos);</span><br><span class="line">        <span class="comment">/* 接收到登出的请求 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (request.equals(MessageType.LOGOUT)) &#123;</span><br><span class="line">            System.out.println(targetIP + <span class="string">&quot; 登出 &quot;</span> + loginData.getName() + LocalDateTime.now());</span><br><span class="line">            running = <span class="literal">false</span>;</span><br><span class="line">            closeAll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="ServerUtils-java"><a href="#ServerUtils-java" class="headerlink" title="ServerUtils.java"></a>ServerUtils.java</h6><blockquote>
<p>服务端进程方法包。由 <em>RunningServer.java</em> 调用</p>
<p>该包实现：监听客户端数据包、发送数据包、处理（各种）客户端请求</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.common.Message;</span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.common.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerUtils</span> &#123;</span><br><span class="line">    <span class="comment">/* 监听客户端发送的数据包 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Message <span class="title function_">receiveMessage</span><span class="params">(ObjectInputStream ois)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject();</span><br><span class="line">            <span class="keyword">return</span> message;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 发送登录失败回执。这个方法其实可以优化掉 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">sendRejection</span><span class="params">(String target, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Server.serverIP, target, MessageType.REJECT, <span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            oos.writeObject(message);</span><br><span class="line">            oos.flush();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 检查用户信息。实际上就是检查用户名 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkUser</span><span class="params">(String user, LoginData loginData)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String[] toCheck = user.split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (toCheck[<span class="number">0</span>].equals(loginData.getName())) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LoginDAO</span>().checkLogin(toCheck[<span class="number">0</span>], toCheck[<span class="number">1</span>]) != <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 检查登录信息。登录成功则返回从数据库得到的登录信息包，否则返回 null */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LoginData <span class="title function_">checkLogin</span><span class="params">(Message message)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (message == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">word</span> <span class="operator">=</span> message.getWord();</span><br><span class="line">        <span class="keyword">if</span> (word == <span class="literal">null</span> || !word.equals(MessageType.LOGIN)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            word = (String) message.getObject();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String[] data = word.split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (data.length != <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LoginDAO</span>().checkLogin(data[<span class="number">0</span>], data[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 发送数据包给客户端。很多方法会调用这个方法。这个方法也会刷新数据包时间戳 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.currentThread().sleep(<span class="number">300</span>);	<span class="comment">//人为加入 0.3 秒发送延迟</span></span><br><span class="line">            toSend.setTimeStamp();				<span class="comment">//刷新数据包时间戳</span></span><br><span class="line">            oos.writeObject(toSend);</span><br><span class="line">            oos.flush();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回餐桌列表 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showTables</span><span class="params">(Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="comment">/* 调用方法得到餐桌列表 */</span></span><br><span class="line">        List&lt;TableData&gt; tableData = <span class="keyword">new</span> <span class="title class_">TableDAO</span>().queryAll();</span><br><span class="line">        <span class="comment">/* 将餐桌列表转化成字符串。发送时只发送这个字符串 */</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (TableData data : tableData) &#123;</span><br><span class="line">            sb.append(data);</span><br><span class="line">            sb.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        toSend.setObject(sb.toString());</span><br><span class="line">        <span class="comment">/* 设置数据包标识为请求通过 */</span></span><br><span class="line">        toSend.setWord(MessageType.ACCEPT);</span><br><span class="line">        <span class="comment">/* 发送数据包 */</span></span><br><span class="line">        sendMessage(toSend, oos);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 检查餐桌</span></span><br><span class="line"><span class="comment">    ……这是因为：用户点餐、预定餐桌等场合，需要验证输入的餐桌信息 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">checkTable</span><span class="params">(Message receive, Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        	<span class="comment">/* 检查用户请求的餐桌号 */</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">table</span> <span class="operator">=</span> Integer.parseInt(((String) receive.getObject()).split(<span class="string">&quot;\t&quot;</span>)[<span class="number">2</span>]);</span><br><span class="line">            <span class="type">TableData</span> <span class="variable">tableData</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TableDAO</span>().queryTable(table);</span><br><span class="line">            <span class="comment">/* 下面是根据返回结果，为数据包添加标识语句，并装入查到的餐桌数据 */</span></span><br><span class="line">            <span class="keyword">if</span> (tableData == <span class="literal">null</span>) &#123;</span><br><span class="line">                toSend.setWord(MessageType.TABLE_NOT_EXIST);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tableData.getOrder().equals(<span class="string">&quot;不可用&quot;</span>)) &#123;</span><br><span class="line">                toSend.setObject(tableData);</span><br><span class="line">                toSend.setWord(MessageType.TABLE_NOT_AVAILABLE);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tableData.getOrder().equals(<span class="string">&quot;已预定&quot;</span>)) &#123;</span><br><span class="line">                toSend.setObject(tableData);</span><br><span class="line">                toSend.setWord(MessageType.TABLE_OCCUPIED);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tableData.getOrder().equals(<span class="string">&quot;用餐&quot;</span>)) &#123;</span><br><span class="line">                toSend.setObject(tableData);</span><br><span class="line">                toSend.setWord(MessageType.TABLE_DINNING);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tableData.getOrder().equals(<span class="string">&quot;空&quot;</span>)) &#123;</span><br><span class="line">                toSend.setObject(tableData);</span><br><span class="line">                toSend.setWord(MessageType.TABLE_AVAILABLE);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                toSend.setWord(MessageType.REJECT);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">/* 发生任何异常的场合，设置拒绝请求的标识语句 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 预定餐桌 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">orderTable</span><span class="params">(Message receive, Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 前面说过。接收数据包含有一条被 \t 分隔为不同部分的语句。</span></span><br><span class="line"><span class="comment">            这里：第三部分代表餐桌号，第四部分代表顾客名，第五部分代表顾客电话*/</span></span><br><span class="line">            String[] mess = ((String) receive.getObject()).split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">table</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">2</span>]);</span><br><span class="line">            <span class="type">String</span> <span class="variable">customerName</span> <span class="operator">=</span> mess[<span class="number">3</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">call</span> <span class="operator">=</span> mess[<span class="number">4</span>];</span><br><span class="line">            <span class="type">CustomerDAO</span> <span class="variable">customerDAO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CustomerDAO</span>();</span><br><span class="line">            <span class="comment">/* 根据接收的顾客信息（姓名、电话）对数据库进行查询，看看有没有这个人</span></span><br><span class="line"><span class="comment">            这里，customer &gt; 0 的场合代表有这个人 */</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">customer</span> <span class="operator">=</span> customerDAO.searchCustomer(customerName, call);</span><br><span class="line">            <span class="comment">/* 没有这个信息的场合，创建这个顾客信息 */</span></span><br><span class="line">            <span class="keyword">if</span> (customer &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                customerDAO.createCustomer(customerName, call);</span><br><span class="line">                customer = customerDAO.searchCustomer(customerName, call);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* 通常到这里不会出现查无此人的情况。如果出现，说明创建信息失败 */</span></span><br><span class="line">            <span class="keyword">if</span> (customer &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* 到这里，我们进行预定餐桌操作。返回 true 表示成功 */</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">TableDAO</span>().orderTable(table, customer)) &#123;</span><br><span class="line">                toSend.setWord(MessageType.ACCEPT);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                toSend.setWord(MessageType.REJECT);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">/* 出现任何问题，我们设置请求拒绝标识符 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回菜单列表 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showDishes</span><span class="params">(Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 首先获取菜单列表 */</span></span><br><span class="line">            List&lt;DishesData&gt; dishes = <span class="keyword">new</span> <span class="title class_">DishesDAO</span>().getDishes();</span><br><span class="line">            <span class="comment">/* 接下来，把菜单列表转化为字符串 */</span></span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">staple</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">mainDishes</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">coldDishes</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">beverage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">soup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sweetmeats</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="keyword">for</span> (DishesData d : dishes) &#123;</span><br><span class="line">                <span class="keyword">if</span> (d.getAvailable().equals(<span class="string">&quot;n&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">String</span> <span class="variable">spec</span> <span class="operator">=</span> d.getSpecies();</span><br><span class="line">                <span class="keyword">if</span> (spec.equals(<span class="string">&quot;主食&quot;</span>)) &#123;</span><br><span class="line">                    staple.append(d);</span><br><span class="line">                    staple.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (spec.equals(<span class="string">&quot;甜点&quot;</span>)) &#123;</span><br><span class="line">                    sweetmeats.append(d);</span><br><span class="line">                    sweetmeats.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (spec.equals(<span class="string">&quot;汤品&quot;</span>)) &#123;</span><br><span class="line">                    soup.append(d);</span><br><span class="line">                    soup.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (spec.equals(<span class="string">&quot;凉菜&quot;</span>)) &#123;</span><br><span class="line">                    coldDishes.append(d);</span><br><span class="line">                    coldDishes.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (spec.equals(<span class="string">&quot;饮料&quot;</span>)) &#123;</span><br><span class="line">                    beverage.append(d);</span><br><span class="line">                    beverage.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (spec.equals(<span class="string">&quot;主菜&quot;</span>)) &#123;</span><br><span class="line">                    mainDishes.append(d);</span><br><span class="line">                    mainDishes.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* 合并字符串，以 ### 间隔不同种类 */</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">allDishes</span> <span class="operator">=</span> String.join(<span class="string">&quot;###&quot;</span>, staple, mainDishes, coldDishes, soup, sweetmeats, beverage);</span><br><span class="line">            <span class="comment">/* 装填数据包 */</span></span><br><span class="line">            toSend.setWord(MessageType.ACCEPT);</span><br><span class="line">            toSend.setObject(allDishes);</span><br><span class="line">        <span class="comment">/* 出了问题就设置拒绝请求标识符 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 检查菜单。和检查餐桌是一个道理 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">checkDishes</span><span class="params">(Message receive, Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 前面说过。接收数据包含有一条被 \t 分隔为不同部分的语句。</span></span><br><span class="line"><span class="comment">            这里：第三部分代表查询菜品的 ID */</span></span><br><span class="line">            String[] mess = ((String) receive.getObject()).split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">2</span>]);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DishesDAO</span>().checkDishes(id);</span><br><span class="line">            <span class="keyword">if</span> (o == <span class="literal">null</span>) &#123;</span><br><span class="line">                toSend.setWord(MessageType.NOT_FOUND);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> DishesData)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                toSend.setWord(MessageType.ACCEPT);</span><br><span class="line">                toSend.setObject(o.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">/* 出现任何问题就设置请求拒绝标识符 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 点餐 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">orderDishes</span><span class="params">(Message receive, Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 前面说过……反正前面说过这个 String 的事！</span></span><br><span class="line"><span class="comment">            这里：第三部分是菜品 ID，第四部分是数量，</span></span><br><span class="line"><span class="comment">            	第五部分是桌号，第六部分是顾客号 */</span></span><br><span class="line">            String[] mess = ((String) receive.getObject()).split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">dishes</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">2</span>]);</span><br><span class="line">            <span class="comment">/* 检查一下菜品是不是正确 */</span></span><br><span class="line">            <span class="comment">/* 这里有一处疏忽。应该一并检查是否菜品可用（available） */</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DishesDAO</span>().checkDishes(dishes);</span><br><span class="line">            <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> DishesData)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">3</span>]);</span><br><span class="line">            <span class="type">int</span> <span class="variable">table</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">4</span>]);</span><br><span class="line">            <span class="type">int</span> <span class="variable">customer</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">5</span>]);</span><br><span class="line">            <span class="comment">/* 尝试点餐 */</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">BillDAO</span>().order(dishes, num, table, customer)) &#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">TableDAO</span>().updateTable(table, <span class="number">2</span>);</span><br><span class="line">                toSend.setWord(MessageType.ACCEPT);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                toSend.setWord(MessageType.REJECT);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">/* 出现任何问题就设置请求拒绝标识符 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回账单列表 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showBills</span><span class="params">(Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 和之前的方法一样。这里我们发送的是拼接起来的字符串 */</span></span><br><span class="line">            List&lt;DetailBillData&gt; billData = <span class="keyword">new</span> <span class="title class_">BillDAO</span>().queryBills();</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">finished</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">unfinished</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="keyword">for</span> (DetailBillData d : billData) &#123;</span><br><span class="line">                <span class="keyword">if</span> (d.getClear().equals(<span class="string">&quot;n&quot;</span>)) &#123;</span><br><span class="line">                    unfinished.append(d);</span><br><span class="line">                    unfinished.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    finished.append(d);</span><br><span class="line">                    finished.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            toSend.setWord(MessageType.ACCEPT);</span><br><span class="line">            toSend.setObject(String.join(<span class="string">&quot;###&quot;</span>, finished, unfinished));</span><br><span class="line">        <span class="comment">/* 出现任何问题就设置请求拒绝标识符 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 检查订单 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">checkBills</span><span class="params">(Message receive, Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* ……这里：第三部分是一个标识符。T 表示按桌号查找</span></span><br><span class="line"><span class="comment">            		第四部分是序号。按桌号查找的话，就代表桌号</span></span><br><span class="line"><span class="comment">            		第五部分是一个布尔值句子。true 表示查询已付订单，</span></span><br><span class="line"><span class="comment">            			false 是未付订单。为空表示查询所有订单 */</span></span><br><span class="line">            String[] mess = ((String) receive.getObject()).split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            List&lt;DetailBillData&gt; billData = <span class="literal">null</span>;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="keyword">if</span> (mess[<span class="number">2</span>].equals(<span class="string">&quot;t&quot;</span>) || mess[<span class="number">2</span>].equals(<span class="string">&quot;T&quot;</span>)) &#123;</span><br><span class="line">                Boolean clear;</span><br><span class="line">                <span class="keyword">if</span> (mess.length &lt; <span class="number">5</span>) &#123;</span><br><span class="line">                    clear = <span class="literal">null</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mess[<span class="number">4</span>].equals(<span class="string">&quot;true&quot;</span>)) &#123;</span><br><span class="line">                    clear = <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mess[<span class="number">4</span>].equals(<span class="string">&quot;false&quot;</span>)) &#123;</span><br><span class="line">                    clear = <span class="literal">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    clear = <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                billData = <span class="keyword">new</span> <span class="title class_">BillDAO</span>().queryBillsByTable(Integer.parseInt(mess[<span class="number">3</span>]), clear);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* 同样的，还是返回字符串 */</span></span><br><span class="line">            <span class="keyword">for</span> (DetailBillData data : billData) &#123;</span><br><span class="line">                sb.append(billData);</span><br><span class="line">                sb.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            toSend.setObject(sb.toString());</span><br><span class="line">            toSend.setWord(MessageType.ACCEPT);</span><br><span class="line">        <span class="comment">/* 出现任何问题就设置请求拒绝标识符 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 结算订单 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">finishBills</span><span class="params">(Message receive, Message toSend, ObjectOutputStream oos)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 第三位是桌号，第四位是结算方法 */</span> </span><br><span class="line">            String[] mess = ((String) receive.getObject()).split(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">table</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">2</span>]);</span><br><span class="line">            <span class="type">int</span> <span class="variable">way</span> <span class="operator">=</span> Integer.parseInt(mess[<span class="number">3</span>]);</span><br><span class="line">            <span class="comment">/* 不光更新订单信息，也要把指定餐桌重置为空 */</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">finish</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BillDAO</span>().finishBill(table, way) &gt; <span class="number">0</span> &amp;&amp; <span class="keyword">new</span> <span class="title class_">TableDAO</span>().clearTable(table);</span><br><span class="line">            toSend.setWord(finish ? MessageType.ACCEPT : MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 出现任何问题就设置请求拒绝标识符 */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            toSend.setWord(MessageType.REJECT);</span><br><span class="line">        <span class="comment">/* 最终一定发送数据包 */</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            sendMessage(toSend, oos);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="com-melody-wmt-sql-1"><a href="#com-melody-wmt-sql-1" class="headerlink" title="com.melody.wmt.sql"></a>com.melody.wmt.sql</h5><h6 id="WanMinSQL-properties"><a href="#WanMinSQL-properties" class="headerlink" title="WanMinSQL.properties"></a>WanMinSQL.properties</h6><blockquote>
<p>数据库配置文件</p>
<p>里面的密码填自己的。另外，其实上一篇笔记里故意漏的密码是假的。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">driverClassName=com.mysql.cj.jdbc.Driver</span><br><span class="line">url=jdbc:mysql:<span class="comment">//localhost:3306/wan_min</span></span><br><span class="line">username=root</span><br><span class="line">password=******</span><br><span class="line">initialSize=<span class="number">10</span></span><br><span class="line">minIdle=<span class="number">5</span></span><br><span class="line">maxActive=<span class="number">50</span></span><br><span class="line">maxWait=<span class="number">5000</span></span><br></pre></td></tr></table></figure>

<h6 id="BasicDAO-java"><a href="#BasicDAO-java" class="headerlink" title="BasicDAO.java"></a>BasicDAO.java</h6><blockquote>
<p><em><strong>——详见 [<a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-9-BasicDAO">23.9 BasicDAO</a>]</strong></em></p>
<p>代码和上面说的是一样的……大概？</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.QueryRunner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.BeanListHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbutils.handlers.ScalarHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BasicDAO</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">QueryRunner</span> <span class="variable">queryRunner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(String sql, Object... parameters)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtil.connect();</span><br><span class="line">            <span class="keyword">return</span> queryRunner.update(connection, sql, parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;T&gt; <span class="title function_">queryMulti</span><span class="params">(Class&lt;T&gt; tClass, String sql, Object... parameters)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtil.connect();</span><br><span class="line">            <span class="keyword">return</span> queryRunner.query(connection, sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;&gt;(tClass), parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">querySingle</span><span class="params">(Class&lt;T&gt; tClass, String sql, Object... parameters)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtil.connect();</span><br><span class="line">            <span class="keyword">return</span> queryRunner.query(connection, sql, <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;&gt;(tClass), parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">queryScalar</span><span class="params">(String sql, Object... parameters)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtil.connect();</span><br><span class="line">            <span class="keyword">return</span> queryRunner.query(connection, sql, <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>&lt;&gt;(), parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="JDBCUtil-java"><a href="#JDBCUtil-java" class="headerlink" title="JDBCUtil.java"></a>JDBCUtil.java</h6><blockquote>
<p><em><strong>——见 [<a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/#23-7-2-Druid%EF%BC%88%E5%BE%B7%E9%B2%81%E4%BC%8A%EF%BC%89%E8%BF%9E%E6%8E%A5%E6%B1%A0">23.7.2 Druid（德鲁伊）连接池</a> ]</strong></em></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCUtil</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            properties.load(<span class="keyword">new</span> <span class="title class_">FileReader</span>(<span class="string">&quot;src\\com\\melody\\wmt\\sql\\WanMinSQL.properties&quot;</span>));</span><br><span class="line">            dataSource = DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">connect</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> dataSource.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(Connection c, Statement s, ResultSet r)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (c != <span class="literal">null</span>) &#123;</span><br><span class="line">                c.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (r != <span class="literal">null</span>) &#123;</span><br><span class="line">                r.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (s != <span class="literal">null</span>) &#123;</span><br><span class="line">                s.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="TableDAO-java、TableData-java"><a href="#TableDAO-java、TableData-java" class="headerlink" title="TableDAO.java、TableData.java"></a>TableDAO.java、TableData.java</h6><blockquote>
<p>对应数据库的 <em>table</em> 表</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TableDAO</span> <span class="keyword">extends</span> <span class="title class_">BasicDAO</span>&#123;</span><br><span class="line">    <span class="comment">/* 返回全部的餐桌对象 */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;TableData&gt; <span class="title function_">queryAll</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from `table`&quot;</span>;</span><br><span class="line">        List&lt;TableData&gt; list = queryMulti(TableData.class, sql);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回 ID 指定的餐桌对象。没找到的场合返回 null */</span></span><br><span class="line">    <span class="keyword">public</span> TableData <span class="title function_">queryTable</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from `table` where `id` = ?&quot;</span>;</span><br><span class="line">        <span class="type">TableData</span> <span class="variable">tableData</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            tableData = (TableData) querySingle(TableData.class, sql, id);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tableData;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 设置指定 ID 的餐桌对象的 order 和 customer */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">orderTable</span><span class="params">(<span class="type">int</span> id, <span class="type">int</span> customer)</span> &#123;</span><br><span class="line">        <span class="type">TableData</span> <span class="variable">tableData</span> <span class="operator">=</span> queryTable(id);</span><br><span class="line">        <span class="keyword">if</span> (!tableData.getOrder().equals(<span class="string">&quot;空&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update `table` set `order` = &#x27;已预定&#x27;, `customer` = ? where `id` = ?&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">update</span> <span class="operator">=</span> update(sql, customer, id);</span><br><span class="line">        <span class="keyword">return</span> update &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 更新指定 ID 餐桌对象的 order 状态。一般是把 已预定 状态改为 用餐 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateTable</span><span class="params">(<span class="type">int</span> id, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update `table` set `order` = ? where `id` = ?&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">order</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (n)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                order = <span class="string">&quot;已预定&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                order = <span class="string">&quot;用餐&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                order = <span class="string">&quot;空&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                order = <span class="string">&quot;不可用&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> update(sql, order, id) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 清理指定 ID 的餐桌。通常是结账后调用这个方法 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">clearTable</span><span class="params">(<span class="type">int</span> table)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update `table` set `order` = &#x27;空&#x27;, `customer` = null where `id` = ?&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> update(sql, table) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TableData</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String order;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> customer;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> seat;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TableData</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TableData</span><span class="params">(<span class="type">int</span> id, String order, <span class="type">int</span> customer, <span class="type">int</span> seat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.order = order;</span><br><span class="line">        <span class="built_in">this</span>.customer = customer;</span><br><span class="line">        <span class="built_in">this</span>.seat = seat;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 省略了 getter 和 setter。实际代码里是有的 */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id + <span class="string">&quot;\t&quot;</span> + seat + <span class="string">&quot;\t&quot;</span> + order + <span class="string">&quot;\t&quot;</span> + (customer == <span class="number">0</span> ? <span class="string">&quot;-&quot;</span> : customer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="LoginDAO-java、LoginData-java"><a href="#LoginDAO-java、LoginData-java" class="headerlink" title="LoginDAO.java、LoginData.java"></a>LoginDAO.java、LoginData.java</h6><blockquote>
<p>对应数据库的 <em>Login</em> 表</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginDAO</span> <span class="keyword">extends</span> <span class="title class_">BasicDAO</span>&#123;</span><br><span class="line">    <span class="comment">/* 返回指定 name 和 password 的对象。没有匹配项则返回 null */</span></span><br><span class="line">    <span class="keyword">public</span> LoginData <span class="title function_">checkLogin</span><span class="params">(String name, String password)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 这里体现出，密码是由 md5 方法加密的 */</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from login where name = ? and password = md5(?)&quot;</span>;</span><br><span class="line">            <span class="type">LoginData</span> <span class="variable">loginData</span> <span class="operator">=</span> (LoginData) querySingle(LoginData.class, sql, name, password);</span><br><span class="line">            <span class="keyword">return</span> loginData;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginData</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LoginData</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LoginData</span><span class="params">(<span class="type">int</span> id, String name, String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 省略了 getter 和 setter。实际代码里是有的 */</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="DishesDAO-java、DishesData-java"><a href="#DishesDAO-java、DishesData-java" class="headerlink" title="DishesDAO.java、DishesData.java"></a>DishesDAO.java、DishesData.java</h6><blockquote>
<p>对应数据库的 <em>Dishes</em> 表</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishesDAO</span> <span class="keyword">extends</span> <span class="title class_">BasicDAO</span>&#123;</span><br><span class="line">    <span class="comment">/* 返回所有菜单 */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;DishesData&gt; <span class="title function_">getDishes</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from `dishes`&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> queryMulti(DishesData.class, sql);</span><br><span class="line">    &#125;	</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回 ID 指定的菜单。没有则返回 null */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">checkDishes</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from `dishes` where `id` = ?&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> querySingle(DishesData.class, sql, id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishesData</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> price;</span><br><span class="line">    <span class="keyword">private</span> String species;</span><br><span class="line">    <span class="keyword">private</span> String available;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DishesData</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DishesData</span><span class="params">(<span class="type">int</span> id, String name, <span class="type">int</span> price, String species, String available)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.price = price;</span><br><span class="line">        <span class="built_in">this</span>.species = species;</span><br><span class="line">        <span class="built_in">this</span>.available = available;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 省略了 getter 和 setter。实际代码里是有的 */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id + <span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;\t&quot;</span> + price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="CustomerDAO-java、CustomerData-java"><a href="#CustomerDAO-java、CustomerData-java" class="headerlink" title="CustomerDAO.java、CustomerData.java"></a>CustomerDAO.java、CustomerData.java</h6><blockquote>
<p>对应数据库的 <em>Customer</em> 表</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomerDAO</span> <span class="keyword">extends</span> <span class="title class_">BasicDAO</span> &#123;</span><br><span class="line">    <span class="comment">/* 返回 name 和 call 指定的顾客信息。没有则返回 null */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">searchCustomer</span><span class="params">(String name, String call)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from customer where `name` = ? and `call` = ?&quot;</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> querySingle(CustomerData.class, sql, name, call);</span><br><span class="line">        <span class="keyword">return</span> o == <span class="literal">null</span> ? -<span class="number">1</span> : ((CustomerData) o).getId();</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 创建顾客信息，信息包含 name 和 call */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">createCustomer</span><span class="params">(String name, String call)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into customer (`name`, `call`) values(?, ?)&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">update</span> <span class="operator">=</span> update(sql, name, call);</span><br><span class="line">        <span class="keyword">return</span> update &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomerData</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String card_id;</span><br><span class="line">    <span class="keyword">private</span> String call;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CustomerData</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CustomerData</span><span class="params">(<span class="type">int</span> id, String name, String card_id, String call)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.card_id = card_id;</span><br><span class="line">        <span class="built_in">this</span>.call = call;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 省略了 getter 和 setter。实际代码里是有的 */</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="BillDAO-java、BillData-java、DetailBillData-java"><a href="#BillDAO-java、BillData-java、DetailBillData-java" class="headerlink" title="BillDAO.java、BillData.java、DetailBillData.java"></a>BillDAO.java、BillData.java、DetailBillData.java</h6><blockquote>
<p>对应数据库的 <em>Bill</em> 表，<em>Detail_Bill</em> 视图</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.sql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BillDAO</span> <span class="keyword">extends</span> <span class="title class_">BasicDAO</span> &#123;</span><br><span class="line">    <span class="comment">/* 订餐。形参是 餐品号、数量、桌号、顾客号。成功的场合返回 true */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">order</span><span class="params">(<span class="type">int</span> dishes, <span class="type">int</span> num, <span class="type">int</span> table, <span class="type">int</span> customer)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into `bill` (`dishes`, `num`, `table`, `customer`) values(?, ?, ?, ?)&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">update</span> <span class="operator">=</span> update(sql, dishes, num, table, customer);</span><br><span class="line">        <span class="keyword">return</span> update &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回账单列表 */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;DetailBillData&gt; <span class="title function_">queryBills</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from detail_bill&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (List&lt;DetailBillData&gt;) queryMulti(DetailBillData.class, sql);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 返回特定桌号的帐单列表</span></span><br><span class="line"><span class="comment">    Boolean 为 true 则返回未付账单；false 返回已结账单；null 返回全部 */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;DetailBillData&gt; <span class="title function_">queryBillsByTable</span><span class="params">(<span class="type">int</span> table, Boolean clear)</span> &#123;</span><br><span class="line">        String sql;</span><br><span class="line">        <span class="keyword">if</span> (clear == <span class="literal">null</span>) &#123;</span><br><span class="line">            sql = <span class="string">&quot;select * from detail_bill where `table` = ?&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            sql = <span class="string">&quot;select * from detail_bill where `table` = ? and &quot;</span> + (clear ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;not&quot;</span>) + <span class="string">&quot; `clear` = &#x27;n&#x27;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (List&lt;DetailBillData&gt;) queryMulti(DetailBillData.class, sql, table);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 将指定桌号的所有未付账单结算，其结算方式为 way 指定的方式 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">finishBill</span><span class="params">(<span class="type">int</span> table, <span class="type">int</span> way)</span> &#123;</span><br><span class="line">        String clear;</span><br><span class="line">        <span class="keyword">if</span> (way == <span class="number">1</span>) &#123;</span><br><span class="line">            clear = <span class="string">&quot;y&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (way == <span class="number">2</span>) &#123;</span><br><span class="line">            clear = <span class="string">&quot;alipay&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (way == <span class="number">3</span>) &#123;</span><br><span class="line">            clear = <span class="string">&quot;wc_pay&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update bill set `clear` = ? where `table` = ? and `clear` = &#x27;n&#x27;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> update(sql, clear, table);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BillData</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> customer;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> table;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> num;</span><br><span class="line">    <span class="keyword">private</span> String clear;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> dishes;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BillData</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BillData</span><span class="params">(<span class="type">int</span> id, Date date, <span class="type">int</span> customer, <span class="type">int</span> table, <span class="type">int</span> num, String clear, <span class="type">int</span> dishes)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.date = date;</span><br><span class="line">        <span class="built_in">this</span>.customer = customer;</span><br><span class="line">        <span class="built_in">this</span>.table = table;</span><br><span class="line">        <span class="built_in">this</span>.num = num;</span><br><span class="line">        <span class="built_in">this</span>.clear = clear;</span><br><span class="line">        <span class="built_in">this</span>.dishes = dishes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 省略了 getter 和 setter。实际代码里是有的 */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id + <span class="string">&quot;\t&quot;</span> + customer + <span class="string">&quot;\t&quot;</span> + table + <span class="string">&quot;\t&quot;</span> + num + <span class="string">&quot;\t&quot;</span> + clear + <span class="string">&quot;\t&quot;</span> + dishes + <span class="string">&quot;\t&quot;</span> + date;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DetailBillData</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String call;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> table;</span><br><span class="line">    <span class="keyword">private</span> String dishes;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> num;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="keyword">private</span> String clear;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DetailBillData</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DetailBillData</span><span class="params">(String name, String call, <span class="type">int</span> table, String dishes, <span class="type">int</span> num, Date date, String clear)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.call = call;</span><br><span class="line">        <span class="built_in">this</span>.table = table;</span><br><span class="line">        <span class="built_in">this</span>.dishes = dishes;</span><br><span class="line">        <span class="built_in">this</span>.num = num;</span><br><span class="line">        <span class="built_in">this</span>.date = date;</span><br><span class="line">        <span class="built_in">this</span>.clear = clear;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 省略了 getter 和 setter。实际代码里是有的 */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name + <span class="string">&quot;\t&quot;</span> + call + <span class="string">&quot;\t&quot;</span> + table + <span class="string">&quot;\t&quot;</span> + dishes + <span class="string">&quot;\t&quot;</span> + num + <span class="string">&quot;\t&quot;</span> + date + <span class="string">&quot;\t&quot;</span> + clear;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="客户端（管理）部分"><a href="#客户端（管理）部分" class="headerlink" title="客户端（管理）部分"></a>客户端（管理）部分</h4><h5 id="com-melody-wmt-client"><a href="#com-melody-wmt-client" class="headerlink" title="com.melody.wmt.client;"></a>com.melody.wmt.client;</h5><h6 id="Clinet-java"><a href="#Clinet-java" class="headerlink" title="Clinet.java"></a>Clinet.java</h6><blockquote>
<p>客户端程序主体</p>
<p>该包实现：登录界面、菜单界面、选择菜单</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.sql.LoginData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String IP;						<span class="comment">//自己的 IP</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">ServerIP</span> <span class="operator">=</span> <span class="string">&quot;192.168.3.16&quot;</span>;	<span class="comment">//服务端 IP</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="keyword">private</span> Socket socket;</span><br><span class="line">    <span class="keyword">private</span> ObjectInputStream ois;					<span class="comment">//输入流</span></span><br><span class="line">    <span class="keyword">private</span> ObjectOutputStream oos;					<span class="comment">//输出流</span></span><br><span class="line">    							<span class="comment">//以上三个属性会在 connect() 方法中被赋值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">MenuUtility</span> <span class="variable">menuUtility</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MenuUtility</span>(<span class="built_in">this</span>);</span><br><span class="line">    							<span class="comment">//方法类对象，传入形参 this，形成了互相持有的结构</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">Listening</span> <span class="variable">listening</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Listening</span>(<span class="built_in">this</span>);</span><br><span class="line">    							<span class="comment">//监听类对象，传入形参 this，形成了互相持有的结构</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">LoginData</span> <span class="variable">loginData</span> <span class="operator">=</span> <span class="literal">null</span>;				</span><br><span class="line">    							<span class="comment">//用户数据。登陆后服务端会发送一个该类对象过来</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">skipMenu</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    							<span class="comment">//跳过菜单显示。该属性没有投入使用</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 多此一举地初始化自己的 IP 地址。其实可以直接写。 */</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            IP = InetAddress.getLocalHost().getHostAddress();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            IP = <span class="string">&quot;192.168.3.16&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* 展示主菜单 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mainMenu</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">char</span> read;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;====================================&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t1. 登 录 系 统&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t9. 退 出 系 统&quot;</span>);</span><br><span class="line">            System.out.print(<span class="string">&quot;请选择：&quot;</span>);</span><br><span class="line">            read = scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">            System.out.println();</span><br><span class="line">            System.out.println(<span class="string">&quot;------------------------------------&quot;</span>);</span><br><span class="line">            <span class="keyword">switch</span> (read) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    <span class="comment">/* 这里会先建立连接 connect()，然后调用登录方法 login() */</span></span><br><span class="line">                    <span class="keyword">if</span> (connect() &amp;&amp; menuUtility.login()) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            menu_1();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            System.out.println(e);</span><br><span class="line">                            <span class="comment">/* 有任何问题会执行 closeAll()，即关闭一切流 */</span></span><br><span class="line">                            closeAll();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    closeAll();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">                    <span class="keyword">if</span> (menuUtility.out()) &#123;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;输入错误。&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 建立连接 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">connect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket = <span class="keyword">new</span> <span class="title class_">Socket</span>(ServerIP, <span class="number">9000</span>);</span><br><span class="line">            oos = <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(socket.getOutputStream());</span><br><span class="line">            ois = <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(socket.getInputStream());</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(listening).start();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            closeAll();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 关闭所有流。通常是登出、断线或报错后执行这个方法 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">closeAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ois != <span class="literal">null</span>) &#123;</span><br><span class="line">                ois.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (oos != <span class="literal">null</span>) &#123;</span><br><span class="line">                oos.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (socket != <span class="literal">null</span>) &#123;</span><br><span class="line">                socket.close();</span><br><span class="line">            &#125;</span><br><span class="line">            listening.listening = <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 显示（登录）菜单。这个类只是在屏幕上输出字符 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showMenu_1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/* 设置了跳过菜单显示的场合，仅一次菜单不显示 */</span></span><br><span class="line">        <span class="keyword">if</span> (skipMenu)&#123;</span><br><span class="line">            skipMenu = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;================&quot;</span> + loginData.getName() + <span class="string">&quot;================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\t\t1. 餐 桌 状 态&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\t\t2. 预 定 餐 桌&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\t\t3. 菜 单&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\t\t4. 点 餐&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\t\t5. 账 单&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\t\t6. 结 账&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;\t\t9. 登 出 系 统&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 根据菜单选择执行的功能 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">menu_1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">char</span> read;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="comment">/* 显示菜单。设置跳过的场合仅一次菜单不显示 */</span></span><br><span class="line">            showMenu_1();</span><br><span class="line">            System.out.print(<span class="string">&quot;请选择：&quot;</span>);</span><br><span class="line">            read = scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;------------------------------------&quot;</span>);</span><br><span class="line">            <span class="keyword">switch</span> (read) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    menuUtility.showTables();	<span class="comment">//展示餐桌列表</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                    menuUtility.orderTable();	<span class="comment">//预定餐桌</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">                    menuUtility.showList();		<span class="comment">//展示菜单列表</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">                    menuUtility.orderDishes();	<span class="comment">//订餐</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">                    menuUtility.showBill();		<span class="comment">//展示账单列表</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>:</span><br><span class="line">                    menuUtility.payBill();		<span class="comment">//结账</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">                    <span class="keyword">if</span> (menuUtility.logout()) &#123;	<span class="comment">//登出</span></span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;输入错误。&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Socket <span class="title function_">getSocket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> socket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ObjectInputStream <span class="title function_">getOis</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ois;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ObjectOutputStream <span class="title function_">getOos</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> oos;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 抛出一个异常。这个方法用于抛出异常（听君一席话……） */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">throwException</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="Listening-java"><a href="#Listening-java" class="headerlink" title="Listening.java"></a>Listening.java</h6><blockquote>
<p>监听服务端发送数据包的线程</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.common.Message;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Listening</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Client client;				<span class="comment">//和主程序相互持有，便于调用</span></span><br><span class="line">    <span class="keyword">public</span> Message message;				<span class="comment">//接收的数据包</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">listening</span> <span class="operator">=</span> <span class="literal">true</span>;	<span class="comment">//监听中。false 会停止线程</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="variable">received</span> <span class="operator">=</span> <span class="literal">false</span>;	<span class="comment">//收到文件。</span></span><br><span class="line">    						<span class="comment">//这是实现某个方法的过渡办法，似乎已经可以弃用</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Listening</span><span class="params">(Client client)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.client = client;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        listening = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (listening)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> client.getOis().readObject();</span><br><span class="line">                <span class="keyword">if</span> (o == <span class="literal">null</span>)&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                message = (Message) o;</span><br><span class="line">                received = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                client.throwException(<span class="string">&quot;监听异常&quot;</span> + e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;监听停止&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="MenuUtility-java"><a href="#MenuUtility-java" class="headerlink" title="MenuUtility.java"></a>MenuUtility.java</h6><blockquote>
<p>客户端程序的方法包</p>
<p>该包实现：……大部分功能</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody.wmt.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.common.Message;</span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.common.MessageType;</span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.sql.LoginData;</span><br><span class="line"><span class="keyword">import</span> com.melody.wmt.sql.TableData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenuUtility</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="keyword">private</span> Client client;				<span class="comment">//和主程序互相持有，方便调用</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">userData</span> <span class="operator">=</span> <span class="literal">null</span>;		<span class="comment">//内容是：&quot;用户名\t密码&quot;。</span></span><br><span class="line">    						<span class="comment">//每个发送的数据包的 Object 开头都是这个</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MenuUtility</span><span class="params">(Client client)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.client = client;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 发送数据包，并返回接收的数据包 */</span></span><br><span class="line">    <span class="comment">/* 通常会返回接收到的数据包。也可能返回 null 代表失败 */</span></span><br><span class="line">    <span class="keyword">public</span> Message <span class="title function_">sendAndReceive</span><span class="params">(Message message)</span> &#123;</span><br><span class="line">        <span class="comment">/* 发送包不能为 null。基本上不会出现这种情况 */</span></span><br><span class="line">        <span class="keyword">if</span> (message == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：传递空包&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 刷新数据包时间戳 */</span></span><br><span class="line">        message.setTimeStamp();</span><br><span class="line">        <span class="comment">/* 清空监听进程里已有的数据 */</span></span><br><span class="line">        client.listening.received = <span class="literal">false</span>;</span><br><span class="line">        client.listening.message = <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">/* 接收数据包对象 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 发送数据包 */</span></span><br><span class="line">            client.getOos().writeObject(message);</span><br><span class="line">            <span class="comment">/* 标记此时的时间 */</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">time</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">            <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="comment">/* 在指定时间内持续试图接收服务端数据包 */</span></span><br><span class="line">            <span class="comment">/* 经测试，在 while(true) 中如果只有单一的 if 语句，</span></span><br><span class="line"><span class="comment">            	那么该 if 语句条件（或主体）只会执行一次。</span></span><br><span class="line"><span class="comment">            	这会造成客户端接收不到服务端数据包。</span></span><br><span class="line"><span class="comment">            	因此，加入了无关紧要的小动画，确保 if 语句总会重复执行。*/</span></span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                n++;</span><br><span class="line">                System.out.print(<span class="string">&quot;\r&quot;</span>);</span><br><span class="line">                <span class="comment">/* if 语句中的才是主体</span></span><br><span class="line"><span class="comment">                	接收到数据包或者等待 5 秒以上后，拿取数据包并跳出该循环 */</span></span><br><span class="line">                <span class="keyword">if</span> (System.currentTimeMillis() - time &gt;= <span class="number">5000</span> | client.listening.received) &#123;</span><br><span class="line">                    receive = client.listening.message;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/* 下面是一个旋转线条的小动画。</span></span><br><span class="line"><span class="comment">                	由于上面的 \r 存在，该动画在程序继续后会被其他字符覆盖 */</span></span><br><span class="line">                <span class="keyword">switch</span> (n % <span class="number">4</span>) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                        System.out.print(<span class="string">&quot;|&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                        System.out.print(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                        System.out.print(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        System.out.print(<span class="string">&quot;\\&quot;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> receive;</span><br><span class="line">        <span class="comment">/* 有任何异常则返回 null */</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 实现登录验证 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">login</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入用户名：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入密码：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">pw</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="comment">/* 这句字符串会被重复使用 */</span></span><br><span class="line">        userData = (user + <span class="string">&quot;\t&quot;</span> + pw);</span><br><span class="line">        <span class="comment">/* 发送数据包。这里写得比较挤，后面我都分开写了 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(<span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.LOGIN, userData));</span><br><span class="line">        <span class="comment">/* 根据返回包做出相应提示 */</span></span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">reply</span> <span class="operator">=</span> receive.getWord();</span><br><span class="line">        <span class="keyword">if</span> (reply.equals(MessageType.LOGIN_USER_NOT_EXIST)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：用户名不存在&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (reply.equals(MessageType.LOGIN_WRONG_PW)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：密码错误&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (reply.equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                client.loginData = (LoginData) receive.getObject();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;未知错误&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;登录成功&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 返回值。true 表示登陆成功 */</span></span><br><span class="line">        <span class="keyword">return</span> receive.getWord().equals(MessageType.ACCEPT);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 退出确认。这是未登录时（即，登陆界面）的退出方法 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">out</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;确定退出吗？（Y/N）&quot;</span>);</span><br><span class="line">        <span class="type">char</span> <span class="variable">answer</span> <span class="operator">=</span> scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> answer == <span class="string">&#x27;Y&#x27;</span> || answer == <span class="string">&#x27;y&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 展示餐桌列表 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">showTables</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/* 发送请求，接收服务端返回的数据包 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.SHOW_TABLES, userData);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="comment">/* 根据返回包的不同作出反应 */</span></span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">r</span> <span class="operator">=</span> receive.getWord();</span><br><span class="line">        <span class="keyword">if</span> (r.equals(MessageType.REJECT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器拒绝了请求&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (r.equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ID\t座数\t状态\t顾客&quot;</span>);</span><br><span class="line">            System.out.println(receive.getObject());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：未知的回执&quot;</span> + r);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 检查餐桌状态 */</span></span><br><span class="line">    <span class="comment">/* need：1不可用；2不存在；3占用未点餐；4占用已点餐；5未占用；6占用</span></span><br><span class="line"><span class="comment">    	根据需要的餐桌状态 need 的不同，有不同的返回方法*/</span></span><br><span class="line">    <span class="keyword">public</span> TableData <span class="title function_">checkTable</span><span class="params">(<span class="type">int</span> tableID, <span class="type">int</span> need)</span> &#123;</span><br><span class="line">        <span class="comment">/* 发送验证餐桌请求，接收返回包 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(client.IP, client.ServerIP, MessageType.CHECK_TABLE, userData + <span class="string">&quot;\t&quot;</span> + tableID);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="comment">/* 根据返回包做出不同反应 */</span></span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 如果 need 和返回结果匹配，give 值会为 true */</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">give</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (receive.getWord().equals(MessageType.REJECT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：请求被拒绝&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.TABLE_NOT_AVAILABLE)) &#123;</span><br><span class="line">            give = need == <span class="number">1</span>;</span><br><span class="line">            System.out.print(give ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;餐桌不可用\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.TABLE_NOT_EXIST)) &#123;</span><br><span class="line">            give = need == <span class="number">2</span>;</span><br><span class="line">            System.out.print(give ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;餐桌不存在\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.TABLE_OCCUPIED)) &#123;</span><br><span class="line">            give = need == <span class="number">3</span> || need == <span class="number">6</span>;</span><br><span class="line">            System.out.print(give ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;餐桌被占用（未点餐）\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.TABLE_DINNING)) &#123;</span><br><span class="line">            give = need == <span class="number">4</span> || need == <span class="number">6</span>;</span><br><span class="line">            System.out.print(give ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;餐桌被占用（已点餐）\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.TABLE_AVAILABLE)) &#123;</span><br><span class="line">            give = need == <span class="number">5</span>;</span><br><span class="line">            System.out.print(give ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;餐桌为空\n&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：未知错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* 只有匹配的结果才会返回餐桌数据 */</span></span><br><span class="line">            <span class="keyword">return</span> give ? (TableData) receive.getObject() : <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 预定餐桌 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">orderTable</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/* 首先会调用一次展示餐桌的方法 */</span></span><br><span class="line">        showTables();</span><br><span class="line">        <span class="comment">/* 输入餐桌号 */</span></span><br><span class="line">        System.out.println(<span class="string">&quot;------------------------------------&quot;</span>);</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入预定的餐桌号码（-1取消）：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">tableID</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            tableID = Integer.parseInt(scanner.next());</span><br><span class="line">            <span class="keyword">if</span> (tableID == -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tableID &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入错误。&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 检查一下上面输入的餐桌是否正确。这时的正确指的是餐桌为空 */</span></span><br><span class="line">        <span class="type">TableData</span> <span class="variable">tableData</span> <span class="operator">=</span> checkTable(tableID, <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">if</span> (tableData == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入预定人名字：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入预定人电话：&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">call</span> <span class="operator">=</span> scanner.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;请确认预定信息：&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;桌号：&quot;</span> + tableData.getId() + <span class="string">&quot;\t座数：&quot;</span> + tableData.getSeat() + <span class="string">&quot;\t预定人：&quot;</span> + name + <span class="string">&quot;\t电话：&quot;</span> + call);</span><br><span class="line">        System.out.print(<span class="string">&quot;确定吗？（Y/N）：&quot;</span>);</span><br><span class="line">        <span class="type">char</span> <span class="variable">confirm</span> <span class="operator">=</span> scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (confirm != <span class="string">&#x27;Y&#x27;</span> &amp;&amp; confirm != <span class="string">&#x27;y&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 发送请求预定餐桌。前面的顾客对象不存在的话，服务端会自动创建新的对象 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(client.IP, client.ServerIP, MessageType.ORDER_TABLE, userData + <span class="string">&quot;\t&quot;</span> + tableID + <span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;\t&quot;</span> + call);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="keyword">if</span> (receive.getWord().equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;预定成功！&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;预定失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 展示菜单 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showList</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/* 发送展示菜单的请求 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.SHOW_DISHES, userData);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!receive.getWord().equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：请求被拒绝&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 此时拿到了菜单。该菜单的不同类别是由 ### 分割的。我们再将其分开 */</span></span><br><span class="line">        String[] dishes;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dishes = ((String) receive.getObject()).split(<span class="string">&quot;###&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;未知错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">char</span> in;</span><br><span class="line">        <span class="comment">/* 这其实又是一级菜单了。直到选择 9 前，该菜单会一直循环 */</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;---------------------------------------&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t请选择要查看的类别&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t1. 主  食&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t2. 主  菜&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t3. 凉  菜&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t4. 汤  品&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t5. 甜  点&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t6. 饮  料&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t7. 点  餐&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t9. 返  回&quot;</span>);</span><br><span class="line">            System.out.print(<span class="string">&quot;请输入：&quot;</span>);</span><br><span class="line">            in = scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;---------------------------------------&quot;</span>);</span><br><span class="line">            <span class="keyword">switch</span> (in) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;------------主  食------------&quot;</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;ID\t名称  \t价格&quot;</span>);</span><br><span class="line">                    System.out.println(dishes[<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;------------主  菜------------&quot;</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;ID\t名称  \t价格&quot;</span>);</span><br><span class="line">                    System.out.println(dishes[<span class="number">1</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;------------凉  菜------------&quot;</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;ID\t名称  \t价格&quot;</span>);</span><br><span class="line">                    System.out.println(dishes[<span class="number">2</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;------------汤  品------------&quot;</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;ID\t名称  \t价格&quot;</span>);</span><br><span class="line">                    System.out.println(dishes[<span class="number">3</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;------------甜  点------------&quot;</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;ID\t名称  \t价格&quot;</span>);</span><br><span class="line">                    System.out.println(dishes[<span class="number">4</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;------------饮  料------------&quot;</span>);</span><br><span class="line">                    System.out.println(<span class="string">&quot;ID\t名称  \t价格&quot;</span>);</span><br><span class="line">                    System.out.println(dishes[<span class="number">5</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;7&#x27;</span>:</span><br><span class="line">                    <span class="comment">/* 这时调用订餐的方法 */</span></span><br><span class="line">                    orderDishes();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;输入错误&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 订餐 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">orderDishes</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入菜品编号（数字，-1返回）：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> dish;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dish = Integer.parseInt(scanner.next());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dish &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 检查输入的餐品信息。这里把一部分代码封装成了一个新方法</span></span><br><span class="line"><span class="comment">        	……这是因为测试发现，不这样做会导致内存数据不更新，接收到的返回包总是不变 */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">dishDetail</span> <span class="operator">=</span> orderDishesPart1(dish);</span><br><span class="line">        <span class="keyword">if</span> (dishDetail == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入数量（数字，-1返回）：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> num;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            num = Integer.parseInt(scanner.next());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入订餐桌号（数字，-1返回）：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> table;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            table = Integer.parseInt(scanner.next());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (table &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 检查一下餐桌信息。这里，正确的状态是&#x27;已占用&#x27; */</span></span><br><span class="line">        <span class="type">TableData</span> <span class="variable">tableData</span> <span class="operator">=</span> checkTable(table, <span class="number">6</span>);</span><br><span class="line">        <span class="keyword">if</span> (tableData == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 展示一下信息 */</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ID\t名称  \t价格 \t数量\t桌号&quot;</span>);</span><br><span class="line">        System.out.println(dishDetail + <span class="string">&quot;\t&quot;</span> + num + <span class="string">&quot;\t&quot;</span> + tableData.getId());</span><br><span class="line">        System.out.print(<span class="string">&quot;确定吗？（Y/N）：&quot;</span>);</span><br><span class="line">        <span class="type">char</span> <span class="variable">confirm</span> <span class="operator">=</span> scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (confirm != <span class="string">&#x27;Y&#x27;</span> &amp;&amp; confirm != <span class="string">&#x27;y&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 发送订餐请求 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.ORDER_DISHES, <span class="literal">null</span>);</span><br><span class="line">        message.setObject(userData + <span class="string">&quot;\t&quot;</span> + dish + <span class="string">&quot;\t&quot;</span> + num + <span class="string">&quot;\t&quot;</span> + table + <span class="string">&quot;\t&quot;</span> + tableData.getCustomer());</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.REJECT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：请求被拒绝&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;预定成功&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 订餐方法中，小部分代码封装成了这个方法 */</span></span><br><span class="line">    <span class="comment">/* 如此做是因为测试发现，不这样做会导致内存数据不更新，</span></span><br><span class="line"><span class="comment">    	接收到的服务端返回包内容总是和方法中第一次接收的返回包内容一样。</span></span><br><span class="line"><span class="comment">    	测试过很多次，问题就是出在这里。解决方法就是这样。</span></span><br><span class="line"><span class="comment">        这样，这个方法执行完毕后，似乎会刷新内存。可能这就是垃圾处理机制吧 */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">orderDishesPart1</span><span class="params">(<span class="type">int</span> dish)</span> &#123;</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.CHECK_DISHES, userData + <span class="string">&quot;\t&quot;</span> + dish);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive1</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="keyword">if</span> (receive1 == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!receive1.getWord().equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：请求被拒绝&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ID\t名称  \t价格&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">dishDetail</span> <span class="operator">=</span> receive1.getObject().toString();</span><br><span class="line">        System.out.println(dishDetail);</span><br><span class="line">        <span class="keyword">return</span> dishDetail;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* 展示账单列表 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showBill</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/* 发送请求 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.SHOW_ALL_BILLS, userData);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.REJECT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：请求被拒绝&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 同样的，账单列表也是以 ### 分隔的 */</span></span><br><span class="line">        String[] bills;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bills = ((String) receive.getObject()).split(<span class="string">&quot;###&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：未知错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 另一个小菜单。选择 9 前会一直循环 */</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;---------------------------------------&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t请选择要查看的类别&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t1. 已完成账单&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t2. 未完成账单&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;\t\t9. 返  回&quot;</span>);</span><br><span class="line">            System.out.print(<span class="string">&quot;请输入：&quot;</span>);</span><br><span class="line">            <span class="type">char</span> <span class="variable">in</span> <span class="operator">=</span> scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;---------------------------------------&quot;</span>);</span><br><span class="line"><span class="comment">//            System.out.println(&quot;姓名 \t电话  \t桌号\t菜名   \t数量\t日期          \t结算状态&quot;);</span></span><br><span class="line">            <span class="keyword">switch</span> (in) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    System.out.println(bills[<span class="number">0</span>].length() == <span class="number">0</span> ? <span class="string">&quot;---无---&quot;</span> : bills[<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                    System.out.println((bills.length &lt; <span class="number">2</span> || bills[<span class="number">1</span>].length() == <span class="number">0</span>) ? <span class="string">&quot;---无---&quot;</span> : bills[<span class="number">1</span>]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;输入错误&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 按桌号检查账单 */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">checkBillByTable</span><span class="params">(<span class="type">int</span> table)</span> &#123;</span><br><span class="line">        <span class="comment">/* 发送请求</span></span><br><span class="line"><span class="comment">        	特别一提：后面的 &quot;\t&quot; + &#x27;t&#x27; + &quot;\t&quot; + table + &quot;\t&quot; + &quot;true&quot; </span></span><br><span class="line"><span class="comment">        	代表 按桌号查询(t)，号码是 table，展示未结账账单(true) */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.CHECK_BILLS, userData + <span class="string">&quot;\t&quot;</span> + <span class="string">&#x27;t&#x27;</span> + <span class="string">&quot;\t&quot;</span> + table + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;true&quot;</span>);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            <span class="keyword">return</span> receive.getObject().toString();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.REJECT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：请求被拒绝&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：未知错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 结账 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">payBill</span><span class="params">()</span> &#123;</span><br><span class="line">        showTables();</span><br><span class="line">        System.out.print(<span class="string">&quot;请输入结账的桌号（-1返回）：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">table</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            table = Integer.parseInt(scanner.next());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (table &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 检查一下桌号 */</span></span><br><span class="line">        <span class="type">TableData</span> <span class="variable">tableData</span> <span class="operator">=</span> checkTable(table, <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span> (tableData == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 检查并展示那个桌号的未结账单 */</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> checkBillByTable(table);</span><br><span class="line">        <span class="keyword">if</span> (s == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">        System.out.println(<span class="string">&quot;请确认以上信息（Y/N）：&quot;</span>);</span><br><span class="line">        <span class="type">char</span> <span class="variable">confirm</span> <span class="operator">=</span> scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (confirm != <span class="string">&#x27;Y&#x27;</span> &amp;&amp; confirm != <span class="string">&#x27;y&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入结算方式（1现金；2支付宝；3微信；-1返回）：&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">way</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            way = Integer.parseInt(scanner.next());</span><br><span class="line">            <span class="keyword">if</span> (way &lt; -<span class="number">1</span> || way &gt; <span class="number">3</span>)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (way == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 发送结账请求 */</span></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.FINISH_BILLS, userData + <span class="string">&quot;\t&quot;</span> +  table + <span class="string">&quot;\t&quot;</span> + way);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">receive</span> <span class="operator">=</span> sendAndReceive(message);</span><br><span class="line">        <span class="keyword">if</span> (receive == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：服务器无响应&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.REJECT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;错误：请求被拒绝&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (receive.getWord().equals(MessageType.ACCEPT)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;结算成功&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">/* 登出 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">logout</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;确定登出吗？（Y/N）：&quot;</span>);</span><br><span class="line">        <span class="type">char</span> confirm;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            confirm = scanner.next().charAt(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (confirm != <span class="string">&#x27;y&#x27;</span> &amp;&amp; confirm != <span class="string">&#x27;Y&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>(Client.IP, Client.ServerIP, MessageType.LOGOUT, userData);</span><br><span class="line">            client.getOos().writeObject(message);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;传输异常&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/26/24%20%E9%A1%B9%E7%9B%AE%EF%BC%9A%E6%BB%A1%E6%B1%89%E6%A5%BC/" data-id="claq4nan0001hp4tfgizwacbn" data-title="&lt;Java&gt;24 项目（满汉楼）" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%A8%8B%E5%BA%8F/" rel="tag">程序</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-23 JDBC 和数据库连接池" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/" class="article-date">
  <time class="dt-published" datetime="2022-02-19T16:00:00.000Z" itemprop="datePublished">2022-02-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/">&lt;Java&gt;23 JDBC 和数据库连接池</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="23-JDBC-和数据库连接池"><a href="#23-JDBC-和数据库连接池" class="headerlink" title="23 JDBC 和数据库连接池"></a>23 JDBC 和数据库连接池</h1><blockquote>
<p>JDBC：Java 提供的一套用于操作数据库的接口 API。Java 程序员只需要面向该接口即可连接任何提供了 JDBC 驱动程序的数据库，完成对数据库的各种操作。不同的数据库厂商，需要针对这套接口提供不同的实现。</p>
</blockquote>
<p><strong>JDBC 程序编写步骤（示范）：</strong></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/* [0] 前置操作 */</span></span><br><span class="line">	<span class="comment">/* [1] 注册驱动 */</span></span><br><span class="line"><span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.mysql.cj.jdbc.Driver();</span><br><span class="line">	<span class="comment">/* [2] 获取连接 */</span></span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/melody&quot;</span>;</span><br><span class="line"><span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();				</span><br><span class="line">properties.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">properties.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connect</span> <span class="operator">=</span> driver.connect(url, properties);	</span><br><span class="line">	<span class="comment">/* [3] 执行语句 */</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into customer (customer_id,name,card_id) values(0004,&#x27;赫尔&#x27;,&#x27;00000000000000000O&#x27;)&quot;</span>;</span><br><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connect.createStatement();</span><br><span class="line"><span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line">System.out.println(rows);</span><br><span class="line">	<span class="comment">/* [4] 释放资源 */</span></span><br><span class="line">statement.close();</span><br><span class="line">connect.close();</span><br></pre></td></tr></table></figure>

<ol start="0">
<li><p>前置操作：将 <code>mysql-connector-java-8.0.27.jar</code> 该文件拷贝到项目目录下，选中后右键选择 <code>Add as library</code></p>
</li>
<li><p>注册驱动：加载 <code>Driver</code> 类</p>
<p>这里我导入了 <code>com.mysql.cj.jdbc.Driver</code>。根据前面的 <code>jar</code> 包的版本不同，应该导入的路径也会不同。</p>
<p>旧版本的 <code>jar</code> 包可能应该导入 <code>com.mysql.jdbc.Driver</code> 这个包。</p>
</li>
<li><p>获取连接：得到 <code>Connection</code></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/melody&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>这里表示进入 <code>melody</code> 这个数据库。</p>
</blockquote>
</li>
<li><p>执行语句：发送 SQL 命令给 MySQL 执行</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br></pre></td></tr></table></figure>

<p>如果是 dml 语句，这里返回的 rows 是影响的行数。返回 0 表示失败。</p>
</blockquote>
</li>
<li><p>释放资源：关闭相关连接<strong>（切记！）</strong></p>
</li>
</ol>
</blockquote>
<h2 id="23-1-连接数据库的-5-种方式"><a href="#23-1-连接数据库的-5-种方式" class="headerlink" title="23.1 连接数据库的 5 种方式"></a>23.1 连接数据库的 5 种方式</h2><ul>
<li><p>方式 1：直接创建 <code>Driver</code>，调用 <code>driver.connet(url, properties);</code></p>
<p>这个方法就是 [23.0] 示范的方法</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">com</span>.mysql.cj.jdbc.Driver();</span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/melody&quot;</span>;</span><br><span class="line"><span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();				</span><br><span class="line">properties.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">properties.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connect</span> <span class="operator">=</span> driver.connect(url, properties);	</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>方式 2：使用反射加载 <code>Driver</code> 类</p>
<p>这个方式是动态加载，更加灵活。</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"><span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> (Driver) aClass.newInstance();</span><br><span class="line"><span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();				</span><br><span class="line">properties.setProperty(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">properties.setProperty(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;******&quot;</span>);</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connect</span> <span class="operator">=</span> driver.connect(url, properties);	</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>方式 3：使用 <code>DriverManager</code> 替代 <code>Driver</code> 进行统一管理</p>
<p>这个方式扩展性更好，更加清晰</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"><span class="type">Driver</span> <span class="variable">driver</span> <span class="operator">=</span> (Driver) aClass.newInstance();</span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/melody&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;******&quot;</span>;</span><br><span class="line">DriverManager.registerDriver(driver);</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, name, password);</span><br></pre></td></tr></table></figure>

<p>  这里，<code>DriverManager.getConnetion()</code> 有三种方法。分别是：</p>
<ul>
<li><code>getConnetion(url);</code></li>
<li><code>getConnetion(url, properties);</code></li>
<li><code>getConnetion(url, name, password);</code></li>
</ul>
</blockquote>
</li>
<li><p>方式 4：使用 <code>Class.forName()</code> 自动完成注册驱动</p>
<blockquote>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/melody&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;******&quot;</span>;</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, name, password);</span><br></pre></td></tr></table></figure>

<p><code>Class.forName()</code> 在加载 <code>Driver</code> 类时，会自动完成注册。</p>
</blockquote>
<p>原理：</p>
<blockquote>
<p><code>Driver</code> 类的源码中有这样一段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">         DriverManager.registerDriver(<span class="keyword">new</span> <span class="title class_">Driver</span>());</span><br><span class="line">     &#125; <span class="keyword">catch</span> (SQLException var1) &#123;</span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Can&#x27;t register driver!&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个静态代码块在类加载时会被执行。</p>
</blockquote>
<blockquote>
<p>另外，其实不执行 <code>Class.forName(...);</code> 语句的场合，也能正确获取 <code>Connection</code>。</p>
<p>这是因为 JDK 1.5 以后使用了 jdbc4。这个场合，系统会自动调用 jar 包下 <code>META-INF\services\java.sql.Driver</code> 这个文件中的类名称去注册。</p>
<p>……打开上述文件看看，里面赫然写着：<code>com.mysql.cj.jdbc.Driver</code></p>
<p>即使如此，还是建议写上 <code>Class.forName(...)</code> 语句！</p>
</blockquote>
</li>
<li><p>方式 5（推荐）：在方式 4 的基础上，使用配置文件，连接数据库更灵活。</p>
<p>这种方式是实际开发最常用的方式。</p>
<blockquote>
<p>配置文件（创建 src\mysql.properties）：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/melody</span></span><br><span class="line"><span class="attr">user</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">******</span></span><br><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Properties</span> <span class="variable">pro</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">pro.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;src\\mysql.properties&quot;</span>))</span><br><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> pro.getProperties(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> pro.getProperties(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> pro.getProperties(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> pro.getProperties(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">Class&lt;?&gt; aClass = Class.forName(driver);</span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, user, password);</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ul>
<h2 id="23-2-ReaultSet-结果集"><a href="#23-2-ReaultSet-结果集" class="headerlink" title="23.2 ReaultSet 结果集"></a>23.2 <code>ReaultSet</code> 结果集</h2><blockquote>
<p>ResultSet：表示数据库结果集的数据表。通常通过执行查询数据库的语句生成。</p>
<p>ResultSet 对象保持一个光标指向其当前的数据行。该光标的初始位置在第一行之前。调用 next 方法将光标下移，移动到末端的场合会返回 false。</p>
</blockquote>
<p><strong>如何取出数据（示例）：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from customer&quot;</span>;</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">resset</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line"><span class="keyword">while</span> (resset.next()) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> resset.getInt(<span class="number">1</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> resset.getString(<span class="number">2</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">sex</span> <span class="operator">=</span> resset.getString(<span class="number">5</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">card_id</span> <span class="operator">=</span> resset.getString(<span class="number">6</span>);</span><br><span class="line">    System.out.println(id + <span class="string">&quot;\t&quot;</span> + name + <span class="string">&quot;\t&quot;</span> + sex + <span class="string">&quot;\t&quot;</span> + card_id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中 <code>String sex = resset.getString(5);</code> 表示取出该行数据的第 5 列的字符串数据。</p>
<p>ResultSet 的数据是以类似二维数组的形式保存在对象中。这不难理解，毕竟表格是二维的嘛。</p>
<h2 id="23-3-Statement"><a href="#23-3-Statement" class="headerlink" title="23.3 Statement"></a>23.3 <code>Statement</code></h2><blockquote>
<p><code>Statment</code> 对象用于执行静态 SQL 语句，并返回其生成的结果的对象</p>
<p>在连接建立后，需要访问数据库、执行命名或 SQL 语句，有如下方式：</p>
<ul>
<li><code>Statment</code>（存在 SQL 注入问题，在实际开发中基本不使用）</li>
<li><code>PerparedStatement</code>（预处理）</li>
<li><code>CallableStatement</code>（存储过程）</li>
</ul>
<p>SQL 注入：利用某些系统没有对用户输入的数据进行充分的检查，故意注入非法的 SQL 语句段或命令，恶意攻击数据库。</p>
<p>使用 <code>PreparedStatement</code> 可以防范 SQL 注入</p>
</blockquote>
<h3 id="23-3-1-PreparedStatement-预处理"><a href="#23-3-1-PreparedStatement-预处理" class="headerlink" title="23.3.1 PreparedStatement 预处理"></a>23.3.1 <code>PreparedStatement</code> 预处理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/* [1] */</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from customer where customer_id = ? and name = ?&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">	<span class="comment">/* [2] */</span></span><br><span class="line">ps.setInt(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">ps.setString(<span class="number">2</span>, <span class="string">&quot;萝茵&quot;</span>);</span><br><span class="line">	<span class="comment">/* [3] */</span></span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> ps.executeQuery();</span><br></pre></td></tr></table></figure>

<ol>
<li><p><code>PreparedStatement</code> 执行的 SQL 语句的参数用 <code>?</code> 表示。</p>
</li>
<li><p>调用方法设置 SQL 语句中的参数。</p>
<p>这些方法的两个参数中，第一个是设置的参数的索引，第二个是设置值</p>
</li>
<li><p>调用 <code>executeQuery()</code> 返回 <code>ResultSet</code> 对象。或者调用 <code>executeUpdate()</code> 执行增删改</p>
<p>这里，调用的方法不需要再传入参数</p>
</li>
</ol>
<p><strong>预处理的好处</strong></p>
<ol>
<li>不再使用拼接语句，增加代码可读性，减少语法错误</li>
<li>解决了 SQL 注入问题</li>
<li>大大减少了编译次数，效率提高</li>
</ol>
<table>
<thead>
<tr>
<th>类 &#x2F; 接口</th>
<th>方法</th>
</tr>
</thead>
<tbody><tr>
<td>DriverManager 驱动管理类</td>
<td>getConnection(url, user, pwd) 获取连接</td>
</tr>
<tr>
<td>Connection 接口</td>
<td>createStatement() 创建 Statement 对象</td>
</tr>
<tr>
<td></td>
<td>preparedStatement(sql) 生成预处理 PreparedStatement 对象</td>
</tr>
<tr>
<td>Statement 接口</td>
<td>executeUpdate(sql) 执行 dml 语句，返回影响行数</td>
</tr>
<tr>
<td></td>
<td>executeQuery(sql) 执行查询语句，返回 ResultSet</td>
</tr>
<tr>
<td></td>
<td>execute(sql) 执行任意 SQL 语句，返回布尔值</td>
</tr>
<tr>
<td>PreparedStatement 接口</td>
<td>executeUpdate() 执行 dml 语句，返回影响行数</td>
</tr>
<tr>
<td></td>
<td>executeQuery() 执行查询语句，返回 ResultSet</td>
</tr>
<tr>
<td></td>
<td>execute() 执行任意 SQL 语句，返回布尔值</td>
</tr>
<tr>
<td></td>
<td>setXXX(int, xxx) 设置 SQL 语句中占位符的值</td>
</tr>
<tr>
<td></td>
<td>setObject(int, xxx) 设置 SQL 语句中占位符的值</td>
</tr>
<tr>
<td>ResultSet 结果集</td>
<td>next() 向下移动一行。没有下一行的场合返回 false</td>
</tr>
<tr>
<td></td>
<td>previous() 向上移动一行。没有上一行的场合返回 false</td>
</tr>
<tr>
<td></td>
<td>getXXX(int)、getXXX(name) 返回 int 列 &#x2F; name 列的值</td>
</tr>
<tr>
<td></td>
<td>getObject(int)、getObject(name) 返回 int 列 &#x2F; name 列的值</td>
</tr>
</tbody></table>
<h2 id="23-4-JDBCUtils"><a href="#23-4-JDBCUtils" class="headerlink" title="23.4 JDBCUtils"></a>23.4 JDBCUtils</h2><blockquote>
<p>实际操作中，获取连接 和 释放资源 操作经常使用。可以把这些操作封装成工具类 JDBCUtils</p>
</blockquote>
<p><strong>JDCUtils.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.melody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Melody</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCUtils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String pw;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;src/com/melody/mysql.properties&quot;</span>));</span><br><span class="line">            url = properties.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">            user = properties.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            pw = properties.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">            driver = properties.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">            Class&lt;?&gt; aClass = Class.forName(driver);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);					<span class="comment">//[1]</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(url, user, pw);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">close</span><span class="params">(Connection c, Statement s, ResultSet r)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!(c == <span class="literal">null</span>))&#123;</span><br><span class="line">                c.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!(s == <span class="literal">null</span>))&#123;</span><br><span class="line">                s.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!(r == <span class="literal">null</span>))&#123;</span><br><span class="line">                r.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);					<span class="comment">//[1]</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>实际开发中，可以把编译异常转换为运行异常。这样，调用者可以自行选择捕获异常还是默认处理。</li>
</ol>
<h2 id="23-5-事务"><a href="#23-5-事务" class="headerlink" title="23.5 事务"></a>23.5 事务</h2><blockquote>
<p>事务：JDBC 程序中，当一个 <code>Connection</code> 对象创建时，默认情况下会自动提交事务。为了让多个 SQL 语句一体执行，需要使用事务。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    connection = JDBCUtils.getConnection();</span><br><span class="line">    connection.setAutoCommit(<span class="literal">false</span>);					<span class="comment">//[1] 取消自动提交事务</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into actor values(9, &#x27;赫尔萝茵&#x27;)&quot;</span>;</span><br><span class="line">    <span class="type">PreparedStatement</span> <span class="variable">preparedStatement</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.executeUpdate();</span><br><span class="line">    sql = <span class="string">&quot;delete from actor where name = &#x27;萝茵&#x27; and id &gt; (select * from (select min(id) from actor where name = &#x27;萝茵&#x27;) a)&quot;</span>;</span><br><span class="line">    													<span class="comment">//[2]</span></span><br><span class="line">    preparedStatement = connection.prepareStatement(sql);</span><br><span class="line">    preparedStatement.executeUpdate();</span><br><span class="line">    connection.commit();								<span class="comment">//[3] 提交事务</span></span><br><span class="line">    System.out.println(<span class="string">&quot;complete&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;fail&quot;</span>);</span><br><span class="line">    System.out.println(e);</span><br><span class="line">    connection.rollback();								<span class="comment">//[4] 回滚事务</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    connection.close();									<span class="comment">//[5] 关闭连接</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>取消自动提交事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.setAutoCommit(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>这是一个 SQL 语句。表示在 name &#x3D; 萝茵 的数据中只保留 id 最小的一条。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from actor where name = &#x27;萝茵&#x27; and id &gt; (select * from (select min(id) from actor where name = &#x27;萝茵&#x27;) a)</span><br></pre></td></tr></table></figure>

<p>正常写法会提示不能同表查询（在 MySQL 中，不能在同一语句中先 select 出同一表中的某些值，再 update 这个表）。使用一个额外的 select 过渡就解决了这个问题。特此记录。</p>
</li>
<li><p>提交事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.commit();</span><br></pre></td></tr></table></figure>
</li>
<li><p>回滚事务：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.rollback();</span><br></pre></td></tr></table></figure>

<p>写在 catch 里。这样，语句错误抛出异常的场合会执行到这句话。</p>
</li>
<li><p>关闭连接：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.close();	</span><br></pre></td></tr></table></figure>

<p>写在 finally 里。这样，执行完语句总会关闭连接。这很好。</p>
</li>
</ol>
<h2 id="23-6-批处理"><a href="#23-6-批处理" class="headerlink" title="23.6 批处理"></a>23.6 批处理</h2><blockquote>
<p>批处理：把多条语句一次性提交给数据库进行批量处理。这样做比单独提交更有效率。</p>
</blockquote>
<p>要使用批处理功能，需要在 url 中加入 <code>?rewriteBatchedStatements=true</code>，即在配置文件中写成：</p>
<blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>批处理往往和 PerparedStatement 搭配使用，既减少编译次数，又减少运行次数，岂不美哉？</p>
<p><strong>示例：</strong></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">//[0] 事前准备</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> JDBCUtils.getConnection();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into test1 values(?)&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> connection.prepareStatement(sql);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">	ps.setInt(<span class="number">1</span>,i);						</span><br><span class="line">	ps.addBatch();						<span class="comment">//[1]</span></span><br><span class="line">&#125;</span><br><span class="line">ps.executeBatch();						<span class="comment">//[2]</span></span><br><span class="line">JDBCUtils.close(connection, ps, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
<ol start="0">
<li><p>修改配置文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true</span></span><br><span class="line"><span class="attr">...</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加需要批量处理的 SQL 语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preparedStatement.addBatch();</span><br></pre></td></tr></table></figure>

</li>
<li><p>执行批量处理语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preparedStatement.executeBatch();</span><br></pre></td></tr></table></figure>
</li>
<li><p>（前面的例子里没有这句）清空批处理包的语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preparedStatement.clearBatch();</span><br></pre></td></tr></table></figure></li>
</ol>
</blockquote>
<h3 id="23-6-1-说明"><a href="#23-6-1-说明" class="headerlink" title="23.6.1 说明"></a>23.6.1 说明</h3><ol>
<li><p>第一次添加批处理语句时，创建一个 ArrayList。</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.batchedArgs == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.batchedArgs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</blockquote>
<p>……会在其中放置批处理语句（指令的数据）</p>
</li>
<li><p>该数组满后，按照 1.5 倍扩容</p>
</li>
<li><p>达到指定的值后，执行 executeBatch 吧</p>
</li>
<li><p>批处理能减少编译次数，也能减少发送 SQL 语句的网络开销。</p>
</li>
</ol>
<h2 id="23-7-数据库连接池"><a href="#23-7-数据库连接池" class="headerlink" title="23.7 数据库连接池"></a>23.7 数据库连接池</h2><blockquote>
<p><strong>传统获取 Connection 方法的问题：</strong></p>
<ol>
<li>传统的 JDBC 数据库连接使用 DriverManager 获取，每次建立连接都会把 Connection 载入内存，再进行身份验证。每次连接都会重复验证请求，这样会占用过多系统资源，容易造成服务器崩溃。</li>
<li>每次连接，使用完毕后必须断开。如果不断开操作，会致使数据库内存泄漏，最终不得不重启数据库。</li>
<li>传统连接方式不能控制创建的连接数量。连接数量过多的场合，也可能导致内存泄漏，MySQL 崩溃</li>
</ol>
</blockquote>
<p><strong>因此，需要使用连接池技术：</strong></p>
<ol>
<li>预先在缓冲池放入一定数量的连接。需要建立数据库连接时，从缓冲池中取出一个连接。使用完后，把该连接放回缓冲池。</li>
<li>数据库连接池负责分配、管理和释放数据库连接。其允许应用程序重复使用一个现有的数据库连接，而非建立新的连接。</li>
<li>当请求连接的数量超过最大数量，这些连接请求会被加入等待队列。</li>
</ol>
<p><strong>数据库连接池种类：</strong></p>
<p>JDBC 数据库连接池使用 javax.sql.DataSource 表示。DataSource 是一个接口，通常由第三方提供实现（提供 jar 包）</p>
<ul>
<li>C3P0：速度稍慢，稳定性好……但是速度再慢也不是传统 JDBC 能比得上的，不自量力！</li>
<li>DBCP：速度稍快，稳定性差</li>
<li>Proxool：可以监控连接池状态，稳定性稍差</li>
<li>BoneCP：速度快</li>
<li>Druid：阿里提供的数据库连接池，集 DBCP、C3P0、Proxool 优点于一身</li>
</ul>
<h3 id="23-7-1-C3P0"><a href="#23-7-1-C3P0" class="headerlink" title="23.7.1 C3P0"></a>23.7.1 C3P0</h3><p>写在前面：C3P0 连接时跳一堆红字，不一定是报错……他就这样。</p>
<p><strong>使用 C3P0 的前置工作：</strong></p>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://sourceforge.net/projects/c3p0/?source=navbar">C3P0 jar 包下载</a></p>
</li>
<li><p>……和前面一样，把 jar 包装载好。</p>
<p>为了正常运行程序，这里（上面连接下载的） jar 包（似乎）至少是：</p>
<p><code>mchange-commons-java-0.2.19.jar</code></p>
<p><code>c3p0-0.9.5.5.jar</code></p>
</li>
</ol>
<ul>
<li><p>方式一：在程序中指定相关参数</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/* [1] */</span></span><br><span class="line"><span class="type">ComboPooledDataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br><span class="line">	<span class="comment">/* [2] */</span></span><br><span class="line">cpds.setDriverClass(dirver);</span><br><span class="line">cpds.setUser(user);</span><br><span class="line">cpds.setPassword(password);</span><br><span class="line">cpds.serJdbcUrl(url);</span><br><span class="line">	<span class="comment">/* [3] */</span></span><br><span class="line">cpds.setInitialPoolSize(<span class="number">10</span>);</span><br><span class="line">	<span class="comment">/* [4] */</span></span><br><span class="line">cpds.setMaxPoolSize(<span class="number">50</span>);</span><br><span class="line">	<span class="comment">/* [5] */</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> cpds.getConnection();</span><br><span class="line">...</span><br><span class="line">connection.close();</span><br></pre></td></tr></table></figure>

<ol>
<li><p>创建数据源对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ComboPooledDataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cpds.setDriverClass(String dirver);</span><br><span class="line">cpds.setUser(String user);</span><br><span class="line">cpds.setPassword(String password);</span><br><span class="line">cpds.serJdbcUrl(String url);</span><br></pre></td></tr></table></figure>

<p>……上面输入的形参 <code>user</code> 是字符串 <code>&quot;root&quot;</code>。其他同理。</p>
</li>
<li><p>设置初始化连接数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpds.setInitialPoolSize(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<p>初始化连接数，就是指连接池创建时，初始持有的连接数</p>
</li>
<li><p>设置最大连接数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpds.setMaxPoolSize(<span class="number">50</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取一个连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> cpds.getConnection();</span><br></pre></td></tr></table></figure></li>
</ol>
</blockquote>
</li>
<li><p>方式二：使用配置文件模板完成</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/* [0] 前置操作 */</span> </span><br><span class="line">	<span class="comment">/* [1] 获取数据源对象 */</span> </span><br><span class="line"><span class="type">ComboPooledDataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(<span class="string">&quot;Heruin&quot;</span>);</span><br><span class="line">	<span class="comment">/* [2] 获取连接 */</span> </span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> cpds.getConnection();</span><br><span class="line">...</span><br><span class="line">connection.close();</span><br></pre></td></tr></table></figure>

<ol start="0">
<li><p>加入配置文件</p>
<p>  <strong>c3p0-config.xml：</strong>配置文件，文件名固定，放在 <code>src/c3p0-config.xml</code> 这个位置</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 数据源（连接池）名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">named-config</span> <span class="attr">name</span>=<span class="string">&quot;Heruin&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 驱动类 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- url --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/test<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 用户名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 密码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>******<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 初始化连接数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 最大空闲时间 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxIdleTime&quot;</span>&gt;</span>30<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 最大连接数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>100<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 最小连接数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 每次增长的连接数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquireIncrement&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 可连接的最多的命令对象数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatements&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 每个连接可连接的最多的命令对象数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxStatementsPerConnection&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">named-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取数据源对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ComboPooledDataSource</span> <span class="variable">cpds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(String name);</span><br></pre></td></tr></table></figure>

<p>这里的 <code>name</code> 就是配置文件中的 <code>数据源名称</code></p>
</li>
<li><p>获取连接</p>
</li>
</ol>
</blockquote>
</li>
</ul>
<h3 id="23-7-2-Druid（德鲁伊）连接池"><a href="#23-7-2-Druid（德鲁伊）连接池" class="headerlink" title="23.7.2 Druid（德鲁伊）连接池"></a>23.7.2 Druid（德鲁伊）连接池</h3><p><del>有的人因为看见而相信，有的人因为相信而看见！</del></p>
<p><strong>使用 Druid 的前置工作：</strong></p>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://github.com/alibaba/druid">Druid jar 包下载</a></p>
<p>……这个链接打不开的话，试试 <a target="_blank" rel="noopener" href="https://repo1.maven.org/maven2/com/alibaba/druid/">这个</a></p>
</li>
<li><p>配置 jar 包</p>
</li>
<li><p>加入配置文件</p>
<blockquote>
<p><strong>durid.properties：</strong>配置文件，文件名任意，放在 <code>src/druid.properties</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">720mel\im</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">10</span></span><br><span class="line"><span class="attr">minIdle</span>=<span class="string">5</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">20</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">5000</span></span><br></pre></td></tr></table></figure></blockquote>
</li>
</ol>
<ul>
<li><p>使用 Druid：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/* [1] 加载配置文件 */</span></span><br><span class="line"><span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">properties.load(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;src\\Druid.properties&quot;</span>));</span><br><span class="line">	<span class="comment">/* [2] 初始化数据池 */</span></span><br><span class="line"><span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> DruidDataSourceFactory.createDataSource(properties);</span><br><span class="line">	<span class="comment">/* [3] 获取连接 */</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> dataSource.getConnection();</span><br><span class="line">...</span><br><span class="line">connection.close();</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>初始化数据池</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> DruidDataSourceFactory.createDataSource(properties);</span><br></pre></td></tr></table></figure>
</li>
<li><p>……没什么好说的，但要说一下这个：</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.close();</span><br></pre></td></tr></table></figure>

<p> <code>Connection</code> 是一个接口，对于方法 <code>close()</code>，不同供应商有不同实现方法。</p>
<p> 原生的 <code>MySQL</code> 的实现方法是关闭连接，而这些连接池的实现方法是取消引用（放回连接池）。</p>
</li>
</ol>
</li>
</ul>
<h2 id="23-8-Apache-DbUtils"><a href="#23-8-Apache-DbUtils" class="headerlink" title="23.8 Apache - DbUtils"></a>23.8 Apache - DbUtils</h2><blockquote>
<p><code>commons-DbUtils</code>：是 Apache 组织提供的一个开源的 JDBC 工具库。它是对 JDBC 的封装。使用 dbutils 能极大简化 JDBC 编码的工作量</p>
<p><strong>DbUtils 的常用类：</strong></p>
<ul>
<li><code>QueryRunner</code> 类：封装了 SQL 的执行。是线程安全的，可以实现增、删、改、查、批处理操作</li>
<li><code>ResultSetHandler</code> 接口：用于处理 <code>ResultSet</code>，按照需求将数据转化为其他形式</li>
</ul>
</blockquote>
<p>JDBC 传统方法的不足：</p>
<ol>
<li>结果集和连接是关联的。在连接关闭后，就不能使用结果集。</li>
<li>结果集只能使用一次，这样不便于数据管理</li>
<li>使用返回信息不方便</li>
</ol>
<p>解决方案：</p>
<ul>
<li><p>土方法：创建一个类，其属性与表格的列一一对应。将数据遍历并读取到一个个类对象中，再将这些类对象放置到集合中。这样，就得到了一个与表格数据关联的数据集合。</p>
<blockquote>
<p>数据类，根据需要创建：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SQL_Data</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="keyword">private</span> String name;        </span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 一定要有无参构造器。这是因为后面会用到反射 */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SQL_Data</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SQL_Data</span><span class="params">(<span class="type">int</span> id, Date date, String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.date = date;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;   </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* Geter &amp; Seter 笔记里就省略不记了。光占地方又没技术含量 */</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>……然后遍历 ResultSet，存放。就不写了。</p>
</blockquote>
</li>
<li><p>使用 <code>DbUtils</code>：</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">/* [0] 前置操作 */</span></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from account where ? = ?&quot;</span>;</span><br><span class="line">	<span class="comment">/* [1] 创建 QueryRunner */</span></span><br><span class="line"><span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line">	<span class="comment">/* [2] 执行相关方法 */</span></span><br><span class="line">List&lt;SQL_Data&gt; list = </span><br><span class="line">qr.query(connection, sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;&gt;(SQL_Data.class), <span class="string">&quot;id&quot;</span>, <span class="number">1</span>);</span><br><span class="line">...</span><br><span class="line">	<span class="comment">/* [3] 释放资源*/</span></span><br><span class="line">connection.close();</span><br></pre></td></tr></table></figure>

<ol start="0">
<li><p>前置操作：</p>
<p><a target="_blank" rel="noopener" href="https://commons.apache.org/proper/commons-dbutils/download_dbutils.cgi">获取 jar 包</a>，并完成配置</p>
<p>得到连接 <code>Connection connection</code>，创建数据类（这里是 <code>SQL_Data</code>）</p>
</li>
<li><p>执行相关方法，返回结果集</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;SQL_Data&gt; list = </span><br><span class="line">    queryRunner.query(connection, sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;&gt;(SQL_Data.class), ...);</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>queryRunner.query</code> 方法：执行 SQL 语句，把得到的 <code>ResultSet</code> 封装到 List 集合。这个方法会自动关闭获得的 <code>ResultSet</code>，所以不会造成资源泄漏</p>
</li>
<li><p><code>connection</code>：前置操作中得到的连接</p>
</li>
<li><p><code>sql</code>：SQL 语句</p>
</li>
<li><p><code>new BeanListHander&lt;&gt;(SQL_Data.class)</code>：利用反射机制，将数据封装到 <code>SQL_Data</code> 对象中</p>
</li>
<li><p><code>&quot;id&quot;, 1</code>：给 SQL 语句中的 <code>?</code> 赋值。因为是可变参数，可以写多个，如：<code>queryRunner.query(connection, sql, new BeanListHandler&lt;&gt;(SQL_Data.class), &quot;id&quot;, 1, &quot;name&quot;, &quot;识之律者&quot;);</code></p>
<p>……这里，可变参数也包含列名的场合，筛选似乎会失效。还不知道原理。特此记录。</p>
</li>
</ul>
</li>
<li><p>此时只需要关闭 <code>Connection</code></p>
<p><code>query()</code> 方法已经关闭了 <code>ResultSet</code> 和 <code>PreparedStatement</code></p>
</li>
</ol>
</blockquote>
</li>
</ul>
<h3 id="23-8-1-Apache-DbUtils-常用方法"><a href="#23-8-1-Apache-DbUtils-常用方法" class="headerlink" title="23.8.1 Apache-DbUtils 常用方法"></a>23.8.1 Apache-DbUtils 常用方法</h3><ul>
<li><p><code>queryRunner.update(connection, sql, ...)</code>：DML 语句。增删改。</p>
<p>后面传入可变参数，用于给 SQL 语句中的 <code>?</code> 赋值</p>
<p>返回值 int 代表被影响的行数。</p>
</li>
<li><p><code>queryRunner.query(connection, sql, ResultSetHandler, ...)</code>：查询。</p>
<p>后面传入可变参数，用于给 SQL 语句中的 <code>?</code> 赋值</p>
<p>关于 <code>ResultSetHandler</code>：</p>
<ul>
<li>传入 <code>new BeanListHander&lt;&gt;(SQL_Data.class)</code>：返回多行多列。这个场合，用 <code>List</code> 接收返回值。</li>
<li>传入 <code>new BeanHandler&lt;&gt;(SQL_Data.class)</code>：返回单行。这个场合，用 <code>SQL_Data data</code> 接收返回值。</li>
<li>传入 <code>new ScalarHander&lt;&gt;()</code>：返回单行单列。这个场合，用 <code>Object</code> 接收返回值。</li>
</ul>
</li>
</ul>
<h3 id="23-8-2-表和-JavaBean-的对应关系"><a href="#23-8-2-表和-JavaBean-的对应关系" class="headerlink" title="23.8.2 表和 JavaBean 的对应关系"></a>23.8.2 表和 JavaBean 的对应关系</h3><table>
<thead>
<tr>
<th>表类型</th>
<th>JavaBean类型</th>
</tr>
</thead>
<tbody><tr>
<td>int、samllint……</td>
<td>Integer</td>
</tr>
<tr>
<td>char、varchar……</td>
<td>String</td>
</tr>
<tr>
<td>double</td>
<td>Double</td>
</tr>
<tr>
<td>date</td>
<td>java.util.Date</td>
</tr>
</tbody></table>
<h2 id="23-9-BasicDAO"><a href="#23-9-BasicDAO" class="headerlink" title="23.9 BasicDAO"></a>23.9 BasicDAO</h2><blockquote>
<p>Apache - DbUtils + Druid 简化了 JDBC 开发，但还有不足。</p>
<ol>
<li>SQL 语句固定，不能通过传入参数控制，通用性不好。</li>
<li>select 操作的返回类型未知，需要使用泛型。</li>
<li>将来的表很多，业务需求复杂，不可能只靠一个 Java 类完成</li>
</ol>
</blockquote>
<p>DAO：数据访问对象（data access object）</p>
<ol>
<li><p>我们把通用的和数据库交互的操作封装到一个通用类中，称为 BasicDAO。</p>
</li>
<li><p>在 BasicDAO 基础上，每张表对应一个特化的 DAO（继承 BasicDAO），从而更好地完成功能。</p>
<p>比如：Data 表 -&gt; Data.java 类（JavaBean）-&gt; DataDAO.java</p>
</li>
</ol>
<p><strong>BasicDAO.java（示例）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BasicDAO</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">QueryRunner</span> <span class="variable">qr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryRunner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(String sql, Object... parameters)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtils.getConnection();</span><br><span class="line">            <span class="keyword">return</span> qr.update(connection, sql, parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtils.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;T&gt; <span class="title function_">queryMulti</span><span class="params">(String sql, Class&lt;T&gt; tClass, Object... parameters)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtils.getConnection();</span><br><span class="line">            <span class="keyword">return</span> qr.query(connection, sql, <span class="keyword">new</span> <span class="title class_">BeanListHandler</span>&lt;T&gt;(tClass), parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtils.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">querySingle</span><span class="params">(String sql, Class&lt;T&gt; tClass, Object... parameters)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtils.getConnection();</span><br><span class="line">            <span class="keyword">return</span> qr.query(connection, sql, <span class="keyword">new</span> <span class="title class_">BeanHandler</span>&lt;T&gt;(tClass), parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtils.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">queryScalar</span><span class="params">(String sql, Object... parameters)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtils.getConnection();</span><br><span class="line">            <span class="keyword">return</span> qr.query(connection, sql, <span class="keyword">new</span> <span class="title class_">ScalarHandler</span>&lt;&gt;(), parameters);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtils.close(connection, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/20/23%20JDBC%20%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/" data-id="claq4namz001ap4tfc37x5pgk" data-title="&lt;Java&gt;23 JDBC 和数据库连接池" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="page/2/">2</a><a class="page-number" href="page/3/">3</a><a class="extend next" rel="next" href="page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="categories/Java/">Java</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="tags/%E7%9B%AE%E5%BD%95/" rel="tag">目录</a></li><li class="tag-list-item"><a class="tag-list-link" href="tags/%E7%A8%8B%E5%BA%8F/" rel="tag">程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="tags/Java/" style="font-size: 20px;">Java</a> <a href="tags/%E7%9B%AE%E5%BD%95/" style="font-size: 10px;">目录</a> <a href="tags/%E7%A8%8B%E5%BA%8F/" style="font-size: 15px;">程序</a> <a href="tags/%E7%AC%94%E8%AE%B0/" style="font-size: 20px;">笔记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="archives/2021/11/">November 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="2022/10/16/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="2022/06/03/26%20%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/">&lt;Java&gt;26 算法入门</a>
          </li>
        
          <li>
            <a href="2022/06/02/14%20%E6%A0%91/">&lt;Java&gt;14 树</a>
          </li>
        
          <li>
            <a href="2022/05/29/13%20Java%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">&lt;Java&gt;13 Java 数据结构</a>
          </li>
        
          <li>
            <a href="2022/04/22/15%20%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E8%AE%BE%E8%AE%A1/">&lt;Java&gt;15 图形界面设计</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="" class="mobile-nav-link">Home</a>
  
    <a href="archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="js/jquery-3.4.1.min.js"></script>



  
<script src="fancybox/jquery.fancybox.min.js"></script>




<script src="js/script.js"></script>





  </div>
</body>
</html>